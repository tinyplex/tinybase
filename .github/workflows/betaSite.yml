on: 
  - push
  - workflow_dispatch

jobs:
  betaSite:
    runs-on: ubuntu-latest
    steps:

    - name: Token
      id: token
      uses: peter-murray/workflow-application-token-action@v1
      with:
        application_id: ${{ secrets.TINYPLEXBOT_APPLICATION_ID }}
        application_private_key: ${{ secrets.TINYPLEXBOT_APPLICATION_PRIVATE_KEY }}
        organization: tinyplex
        
    - name: Copy
      id: copy
      uses: andstor/copycat-action@v3
      with:
        personal_token: ${{ steps.token.outputs.token }}
        src_branch: beta
        src_path: docs
        exclude: CNAME
        dst_owner: tinyplex
        dst_repo_name: tinybase-site-beta
        dst_branch: main
        dst_path: /
        commit_message: "[action] Mirrored from tinybase beta branch."
        username: jamesgpearce
        email: github@tripleodeon.com
