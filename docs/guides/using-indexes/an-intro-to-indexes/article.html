<nav><ul><li><a href="/">TinyBase</a></li><li><a href="/guides/">Guides</a></li><li><a href="/guides/using-indexes/">Using Indexes</a></li><li><a href="/guides/using-indexes/an-intro-to-indexes/">An Intro To Indexes</a></li></ul></nav><section class="s1" id="/guides/using-indexes/an-intro-to-indexes/" data-id="AITI"><h1>An Intro To Indexes</h1><p>This guide describes how the <a href="/api/indexes/"><code>indexes</code></a> module gives you the ability to create and track indexes based on the data in <a href="/api/store/interfaces/store/store/"><code>Store</code></a> objects, and which allow you to look up and display filtered data quickly.</p><p>The main entry point to using the <a href="/api/indexes/"><code>indexes</code></a> module is the <a href="/api/indexes/functions/creation/createindexes/"><code>createIndexes</code></a> function, which returns a new <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object. That object in turn has methods that let you create new <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> definitions, access the content of those <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> directly, and register listeners for when they change.</p><h3 id="the-basics"><a href="/guides/the-basics/">The Basics</a></h3><p>An <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> comprises a map of <a href="/api/indexes/type-aliases/concept/slice/"><code>Slice</code></a> objects, keyed by <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a>. The <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a> in a <a href="/api/indexes/type-aliases/concept/slice/"><code>Slice</code></a> represent <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> objects from a <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> that all have a derived string value in common, as described by the <a href="/api/indexes/interfaces/indexes/indexes/methods/configuration/setindexdefinition/"><code>setIndexDefinition</code></a> method. Those values are used as the key for each <a href="/api/indexes/type-aliases/concept/slice/"><code>Slice</code></a> in the overall <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> object.</p><p>This might be simpler to understand with an example: if a <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> contains pets, each with a species, then an <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> could be configured to contain the <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a> of each <a href="/api/store/type-aliases/store/row/"><code>Row</code></a>, grouped into a <a href="/api/indexes/type-aliases/concept/slice/"><code>Slice</code></a> for each distinct species. In other words, this <a href="/api/store/type-aliases/store/table/"><code>Table</code></a>:</p><pre><code><span class="punctuation">{</span> <span class="comment">// Store</span>
  <span class="literal-property">pets</span><span class="operator">:</span> <span class="punctuation">{</span>
    <span class="literal-property">fido</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">,</span>
    <span class="literal-property">felix</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'cat'</span><span class="punctuation">}</span><span class="punctuation">,</span>
    <span class="literal-property">cujo</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span>
</code></pre><p>would conceptually become this <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a>:</p><pre><code><span class="punctuation">{</span> <span class="comment">// Indexes</span>
  <span class="literal-property">bySpecies</span><span class="operator">:</span> <span class="punctuation">{</span>
    <span class="literal-property">dog</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'cujo'</span><span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="literal-property">cat</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'felix'</span><span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span>
</code></pre><p>This is for illustrative purposes: note that this resulting <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> structure is never an object literal like this: you would instead use the <a href="/api/indexes/interfaces/indexes/indexes/methods/getter/getsliceids/"><code>getSliceIds</code></a> method and the <a href="/api/indexes/interfaces/indexes/indexes/methods/getter/getslicerowids/"><code>getSliceRowIds</code></a> method to iterate through the it.</p><p>Here&#x27;s a simple example to show such an <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> in action. The <code>pets</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> has three <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> objects, each with a string <code>species</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a>. We create an <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> definition called <code>bySpecies</code> which groups them:</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>createIndexes<span class="punctuation">,</span> createStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>

<span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settable/">setTable</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="punctuation">{</span>
  <span class="literal-property">fido</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">felix</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'cat'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">cujo</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> indexes <span class="operator">=</span> <span class="function"><a href="/api/indexes/functions/creation/createindexes/">createIndexes</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">;</span>
indexes<span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/configuration/setindexdefinition/">setIndexDefinition</a></span><span class="punctuation">(</span>
  <span class="string">'bySpecies'</span><span class="punctuation">,</span> <span class="comment">// indexId</span>
  <span class="string">'pets'</span><span class="punctuation">,</span> <span class="comment">//      tableId to index</span>
  <span class="string">'species'</span><span class="punctuation">,</span> <span class="comment">//    cellId to index on</span>
<span class="punctuation">)</span><span class="punctuation">;</span>

console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>indexes<span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/getter/getsliceids/">getSliceIds</a></span><span class="punctuation">(</span><span class="string">'bySpecies'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> ['dog', 'cat']</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>indexes<span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/getter/getslicerowids/">getSliceRowIds</a></span><span class="punctuation">(</span><span class="string">'bySpecies'</span><span class="punctuation">,</span> <span class="string">'dog'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> ['fido', 'cujo']</span>
</code></pre><h3 id="index-reactivity"><a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> Reactivity</h3><p>As with the <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object, magic happens when the underlying data changes. The <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object efficiently takes care of tracking changes that will affect the <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> or the <a href="/api/indexes/type-aliases/concept/slice/"><code>Slice</code></a> arrays within it. A similar paradigm to that used on the <a href="/api/store/interfaces/store/store/"><code>Store</code></a> is used to let you add a listener to the <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object. The listener fires when there&#x27;s a change to the <a href="/api/indexes/type-aliases/concept/slice/"><code>Slice</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a> or a <a href="/api/indexes/type-aliases/concept/slice/"><code>Slice</code></a>&#x27;s content:</p><pre><code>indexes<span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/listener/addsliceidslistener/">addSliceIdsListener</a></span><span class="punctuation">(</span><span class="string">'bySpecies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>indexes<span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/getter/getsliceids/">getSliceIds</a></span><span class="punctuation">(</span><span class="string">'bySpecies'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setrow/">setRow</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'lowly'</span><span class="punctuation">,</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'worm'</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> ['dog', 'cat', 'worm']</span>

indexes<span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/listener/addslicerowidslistener/">addSliceRowIdsListener</a></span><span class="punctuation">(</span><span class="string">'bySpecies'</span><span class="punctuation">,</span> <span class="string">'worm'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>indexes<span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/getter/getslicerowids/">getSliceRowIds</a></span><span class="punctuation">(</span><span class="string">'bySpecies'</span><span class="punctuation">,</span> <span class="string">'worm'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setrow/">setRow</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'smaug'</span><span class="punctuation">,</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'worm'</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> ['lowly', 'smaug']</span>
</code></pre><p>You can set multiple <a href="/api/indexes/type-aliases/concept/index/"><code>Index</code></a> definitions on each <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object. However, a given <a href="/api/store/interfaces/store/store/"><code>Store</code></a> can only have one <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object associated with it. So, as with the <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object, if you call this function twice on the same <a href="/api/store/interfaces/store/store/"><code>Store</code></a>, your second call will return a reference to the <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object created by the first.</p><p>Let&#x27;s next find out how to include <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> in a user interface in the <a href="/guides/using-indexes/building-a-ui-with-indexes/">Building A UI With Indexes</a> guide.</p></section>