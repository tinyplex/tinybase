<nav><ul><li><a href="/">TinyBase</a></li><li><a href="/guides/">Guides</a></li><li><a href="/guides/developer-tools/">Developer Tools</a></li><li><a href="/guides/developer-tools/generating-apis/">Generating APIs</a></li></ul></nav><section class="s1" id="/guides/developer-tools/generating-apis/" data-id="GAPI"><h1>Generating APIs</h1><p><a href="/">TinyBase</a> can take a <a href="/api/store/type-aliases/schema/tablesschema/"><code>TablesSchema</code></a> and/or <a href="/api/store/type-aliases/schema/valuesschema/"><code>ValuesSchema</code></a> (which have either been explicitly set, or inferred) and generate the code for type definitions and ORM-like implementations to wrap the <a href="/api/store/interfaces/store/store/"><code>Store</code></a>.</p><p>This is most likely to be used as part of a build script which takes a <a href="/api/store/type-aliases/schema/tablesschema/"><code>TablesSchema</code></a> or <a href="/api/store/type-aliases/schema/valuesschema/"><code>ValuesSchema</code></a> as input (or imported data) to generate TypeScript definition (<code>.d.ts</code>) files and <code>.ts</code> and <code>.tsx</code> implementations. These can then be linked into the development and compilation of an application as a whole.</p><h3 id="using-the-getstoreapi-method">Using The getStoreApi Method</h3><p>This is performed from the <a href="/api/tools/interfaces/tools/tools/"><code>Tools</code></a> object - which is returned from the <a href="/api/tools/functions/creation/createtools/"><code>createTools</code></a> function - and via the <a href="/api/tools/interfaces/tools/tools/methods/modelling/getstoreapi/"><code>getStoreApi</code></a> method.</p><p>The method takes a parameter which serves as the &#x27;name&#x27; for your wrapped, typed, <a href="/api/store/interfaces/store/store/"><code>Store</code></a>:</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>createStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createTools<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/tools'</span><span class="punctuation">;</span>

<span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settable/">setTable</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="punctuation">{</span>
  <span class="literal-property">fido</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">felix</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'cat'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">cujo</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> tools <span class="operator">=</span> <span class="function"><a href="/api/tools/functions/creation/createtools/">createTools</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="punctuation">[</span>dTs<span class="punctuation">,</span> ts<span class="punctuation">,</span> uiReactDTs<span class="punctuation">,</span> uiReactTsx<span class="punctuation">]</span> <span class="operator">=</span> tools<span class="punctuation">.</span><span class="function"><a href="/api/tools/interfaces/tools/tools/methods/modelling/getstoreapi/">getStoreApi</a></span><span class="punctuation">(</span><span class="string">'shop'</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>In this case, the resulting four strings will need to be written to <code>shop.d.ts</code>, <code>shop.ts</code>, <code>shop-ui-react.d.ts</code>, and <code>shop-ui-react.tsx</code> files respectively. <a href="/">TinyBase</a> does not perform that step for you, so you&#x27;ll need to do it explicitly:</p><pre><code>fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop.d.ts'</span><span class="punctuation">,</span> dTs<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop.ts'</span><span class="punctuation">,</span> ts<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop-ui-react.d.ts'</span><span class="punctuation">,</span> uiReactDTs<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop-ui-react.tsx'</span><span class="punctuation">,</span> uiReactTsx<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><h3 id="prettified-code">Prettified Code</h3><p>The <a href="/api/tools/interfaces/tools/tools/methods/modelling/getprettystoreapi/"><code>getPrettyStoreApi</code></a> method is an asynchronous method that attempts to run a locally installed <code>prettier</code> module to ensure the file is reasonably formatted:</p><pre><code><span class="keyword">const</span> <span class="punctuation">[</span>prettyDTs<span class="punctuation">,</span> prettyTs<span class="punctuation">,</span> prettyUiReactDTs<span class="punctuation">,</span> prettyUiReactTsx<span class="punctuation">]</span> <span class="operator">=</span>
  <span class="keyword">await</span> tools<span class="punctuation">.</span><span class="function"><a href="/api/tools/interfaces/tools/tools/methods/modelling/getprettystoreapi/">getPrettyStoreApi</a></span><span class="punctuation">(</span><span class="string">'shop'</span><span class="punctuation">)</span><span class="punctuation">;</span>
fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop.d.ts'</span><span class="punctuation">,</span> prettyDTs<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop.ts'</span><span class="punctuation">,</span> prettyTs<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop-ui-react.d.ts'</span><span class="punctuation">,</span> prettyUiReactDTs<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
fs<span class="punctuation">.</span><span class="function">writeFileSync</span><span class="punctuation">(</span><span class="string">'shop-ui-react.tsx'</span><span class="punctuation">,</span> prettyUiReactTsx<span class="punctuation">,</span> <span class="string">'utf-8'</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>This will produce a file containing the types for your wrapped <a href="/api/store/interfaces/store/store/"><code>Store</code></a>, for example:</p><pre><code><span class="comment">//...</span>
<span class="comment">/**
 * Represents the 'pets' Table.
 */</span>
<span class="keyword">export</span> <span class="keyword">type</span> <span class="class-name">PetsTable</span> <span class="operator">=</span> <span class="punctuation">{</span><span class="punctuation">[</span>rowId<span class="operator">:</span> <span class="type"><a href="/api/common/type-aliases/identity/id/">Id</a></span><span class="punctuation">]</span><span class="operator">:</span> PetsRow<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="comment">/**
 * Represents a Row when getting the content of the 'pets' Table.
 */</span>
<span class="keyword">export</span> <span class="keyword">type</span> <span class="class-name">PetsRow</span> <span class="operator">=</span> <span class="punctuation">{</span>species<span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">}</span><span class="punctuation">;</span>
<span class="comment">//...</span>
</code></pre><p>The <code>.ts</code> implementation will contain the <code>createShop</code> entry point, and will look something like this:</p><pre><code><span class="comment">//...</span>
<span class="keyword">export</span> <span class="keyword">const</span> createShop<span class="operator">:</span> <span class="keyword">typeof</span> <span class="function-variable">createShopDecl</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="comment">// ...</span>
  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settablesschema/">setTablesSchema</a></span><span class="punctuation">(</span><span class="punctuation">{</span>
    pets<span class="operator">:</span> <span class="punctuation">{</span>
      species<span class="operator">:</span> <span class="punctuation">{</span>type<span class="operator">:</span> <span class="string">'string'</span><span class="punctuation">,</span> <span class="keyword">default</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">,</span>
    <span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">{</span>
    hasPetsTable<span class="operator">:</span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">:</span> <span class="builtin">boolean</span> <span class="operator">=></span> store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/getter/hastable/">hasTable</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">)</span><span class="punctuation">,</span>
    getPetsTable<span class="operator">:</span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">:</span> PetsTable <span class="operator">=></span> store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/getter/gettable/">getTable</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">)</span> <span class="keyword">as</span> PetsTable<span class="punctuation">,</span>
    <span class="comment">// ...</span>
  <span class="punctuation">}</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><h3 id="examples">Examples</h3><p>For the full set of methods and types generated by these code generation methods, inspect the output directly. Suffice to say that the generated APIs above will allow you to write domain-specific code like this:</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>createShop<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'./shop'</span><span class="punctuation">;</span>

<span class="keyword">const</span> shop <span class="operator">=</span> <span class="function">createShop</span><span class="punctuation">(</span><span class="punctuation">)</span>
  <span class="punctuation">.</span><span class="function">setPetsTable</span><span class="punctuation">(</span><span class="punctuation">{</span>fido<span class="operator">:</span> <span class="punctuation">{</span>species<span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">)</span>
  <span class="punctuation">.</span><span class="function">setPetsRow</span><span class="punctuation">(</span><span class="string">'felix'</span><span class="punctuation">,</span> <span class="punctuation">{</span>species<span class="operator">:</span> <span class="string">'cat'</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="builtin">console</span><span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>shop<span class="punctuation">.</span><span class="function">getPetsSpeciesCell</span><span class="punctuation">(</span><span class="string">'felix'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 'cat'</span>
</code></pre><p>And so on. There is complete equivalence between the generated methods in your domain-specific API and the underlying <a href="/api/store/interfaces/store/store/"><code>Store</code></a> interface. Similarly, every React hook and component has a domain-specific equivalent:</p><pre><code><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createRoot<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'react-dom/client'</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  shop <span class="operator">=</span> <span class="function">useCreateShop</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
    <span class="function">createShop</span><span class="punctuation">(</span><span class="punctuation">)</span>
      <span class="punctuation">.</span><span class="function">setPetsTable</span><span class="punctuation">(</span><span class="punctuation">{</span>fido<span class="operator">:</span> <span class="punctuation">{</span>species<span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">)</span>
      <span class="punctuation">.</span><span class="function">setPetsRow</span><span class="punctuation">(</span><span class="string">'felix'</span><span class="punctuation">,</span> <span class="punctuation">{</span>species<span class="operator">:</span> <span class="string">'cat'</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span> <span class="attr-name">shop</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>shop<span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">PetsRowView</span></span> <span class="attr-name">rowId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>fido<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">PetsSpeciesCellView</span></span> <span class="attr-name">rowId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>felix<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="function">createRoot</span><span class="punctuation">(</span>document<span class="punctuation">.</span>body<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><h3 id="other-notes">Other Notes</h3><p>Whether pretty or not, the resulting files can easily be included in your main application. Note that the implementations (eg <code>shop.ts</code>) import types from the definitions (eg <code>shop.d.ts</code>) and so it&#x27;s required that the four files are next to each other in the file system.</p><p>If the <a href="/api/store/interfaces/store/store/"><code>Store</code></a> has neither an explicit schema, nor can one be inferred, the four strings will be empty, since no type information can be usefully generated for the <a href="/api/store/interfaces/store/store/"><code>Store</code></a>.</p><p>If you do not wish to handle the programmatic steps described above, and simply want to take schemas stored in a file and generate these definitions directly, see the <a href="/guides/developer-tools/command-line/">Command Line</a> guide in this section.</p><p>You can also read the brief <a href="/guides/developer-tools/gathering-statistics/">Gathering Statistics</a> guide.</p></section>