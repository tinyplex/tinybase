var e,n;e=this,n=function(e){"use strict";const n=(e,n,o)=>e.slice(n,o),o=(e,n)=>e?.delete(n);e.createWsServer=e=>{const t=new Map(void 0);return e.on("connection",((e,s)=>{const r=s.headers["sec-websocket-key"];var c,i,d;c=t,i=r,null==(d=e)?o(c,i):c?.set(i,d),e.on("message",(e=>{const o=e.toString("utf8"),s=o.indexOf("\n");if(-1!==s){const e=n(o,0,s),c=n(o,s+1);""===e?((e,n)=>{var o;o=e,o?.forEach(((e,n)=>{return o=e,n!=r?o.send(r+"\n"+c):0;var o}))})(t):((e,n)=>e?.get(n))(t,e)?.send(r+"\n"+c)}})),e.on("close",(()=>{o(t,r)}))})),{getWebSocketServer:()=>e,destroy:()=>{e.close(),t.clear()}}}},"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseSynchronizerWsServer={});
