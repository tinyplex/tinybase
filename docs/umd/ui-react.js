var e,s;e=this,s=function(e,s){"use strict";const t=e=>typeof e,o="",r=t(o),d="Tables",l="TableIds",n="Table",u="RowIds",i="SortedRowIds",a="Row",I="CellIds",c="Cell",w=(e,s)=>e.map(s),R=e=>null==e,C=(e,s,t)=>R(e)?t?.():s(e),p=()=>{},{createContext:b,useContext:k}=s,g=b([]),m=(e,s)=>{const t=k(g);return R(e)?t[s]:((e,s)=>C(e,(e=>e[s])))(t[s+1],e)},h=(e,s)=>{const o=m(e,s);return R(e)||(e=>t(e)==r)(e)?o:e},y=e=>h(e,0),L=e=>h(e,2),T=e=>h(e,4),S=e=>h(e,6),f=e=>h(e,8),V=e=>h(e,10),{useCallback:q,useEffect:v,useMemo:x,useRef:P,useState:B}=s,M=(e,s,t=[])=>{const o=x((()=>s(e)),[e,...t]);return v((()=>()=>o.destroy()),[o]),o},D=(e,s,t,o=[],r)=>{const[,d]=B(),l=q((()=>s?.["get"+e]?.(...o)??t),[s,...o]),[n]=B(l),u=P(n);return x((()=>u.current=l()),[l]),A(e,s,((...e)=>{u.current=R(r)?l():e[r],d([])}),[],o),u.current},A=(e,s,t,o=[],r=[],...d)=>v((()=>{const o=s?.["add"+e+"Listener"]?.(...r,t,...d);return()=>s?.delListener(o)}),[s,...r,...o,...d]),F=(e,s,t,o=[],r=p,d=[],...l)=>{const n=y(e);return q((e=>C(n,(o=>C(t(e,o),(e=>r(o["set"+s](...l,e),e)))))),[n,s,...o,...d,...l])},G=(e,s,t=p,o=[],...r)=>{const d=y(e);return q((()=>t(d?.["del"+s](...r))),[d,s,...o,...r])},j=(e,s,t)=>{const o=V(e);return q((()=>o?.[s](t)),[o,s,t])},E=e=>D(l,y(e),[],[]),Q=(e,s)=>D(u,y(s),[],[e]),U=(e,s,t,o=0,r,d)=>D(i,y(d),[],[e,s,t,o,r],6),_=(e,s,t)=>D(I,y(t),[],[e,s]),O=(e,s,t,o)=>D(c,y(o),void 0,[e,s,t],4),z=(e,s)=>D("Metric",L(s),void 0,[e]),H=(e,s)=>D("SliceIds",T(s),[],[e]),J=(e,s,t)=>D("SliceRowIds",T(t),[],[e,s]),K=(e,s,t)=>D("RemoteRowId",S(t),void 0,[e,s]),N=(e,s,t)=>D("LocalRowIds",S(t),[],[e,s]),W=(e,s,t)=>D("LinkedRowIds",S(t),[],[e,s]),X=(e,s)=>D("ResultRowIds",f(s),[],[e]),Y=(e,s,t,o=0,r,d)=>D("ResultSortedRowIds",f(d),[],[e,s,t,o,r],6),Z=(e,s,t)=>D("ResultCellIds",f(t),[],[e,s]),$=(e,s,t,o)=>D("ResultCell",f(o),void 0,[e,s,t]),ee=e=>D("CheckpointIds",V(e),[[],void 0,[]]),se=(e,s)=>D("Checkpoint",V(s),void 0,[e]),te=e=>j(e,"goBackward"),oe=e=>j(e,"goForward"),{createElement:re,useMemo:de}=s,le=({tableId:e,store:s,rowComponent:t=Re,getRowComponentProps:o,separator:r,debugIds:d},l)=>ce(w(l,(r=>re(t,{...Ie(o,r),key:r,tableId:e,rowId:r,store:s,debugIds:d}))),r,d,e),ne=({queryId:e,queries:s,resultRowComponent:t=ke,getResultRowComponentProps:o,separator:r,debugIds:d},l)=>ce(w(l,(r=>re(t,{...Ie(o,r),key:r,queryId:e,rowId:r,queries:s,debugIds:d}))),r,d,e),ue=e=>{const s=S(e);return[s,s?.getStore()]},ie=({relationshipId:e,relationships:s,rowComponent:t=Re,getRowComponentProps:o,separator:r,debugIds:d},l,n)=>{const[u,i]=ue(s),a=u?.getLocalTableId(e),I=l(e,n,u);return ce(w(I,(e=>re(t,{...Ie(o,e),key:e,tableId:a,rowId:e,store:i,debugIds:d}))),r,d,n)},ae=e=>({checkpoints:s,checkpointComponent:t=ge,getCheckpointComponentProps:o,separator:r,debugIds:d})=>{const l=V(s);return ce(w(e(ee(l)),(e=>re(t,{...Ie(o,e),key:e,checkpoints:l,checkpointId:e,debugIds:d}))),r)},Ie=(e,s)=>R(e)?{}:e(s),ce=(e,s,t,o)=>{const r=R(s)||!Array.isArray(e)?e:w(e,((e,t)=>t>0?[s,e]:e));return t?[o,":{",r,"}"]:r},we=({tableId:e,rowId:s,cellId:t,store:r,debugIds:d})=>ce(o+(O(e,s,t,r)??o),void 0,d,t),Re=({tableId:e,rowId:s,store:t,cellComponent:o=we,getCellComponentProps:r,separator:d,debugIds:l})=>ce(w(_(e,s,t),(d=>re(o,{...Ie(r,d),key:d,tableId:e,rowId:s,cellId:d,store:t,debugIds:l}))),d,l,s),Ce=e=>le(e,Q(e.tableId,e.store)),pe=({indexId:e,sliceId:s,indexes:t,rowComponent:o=Re,getRowComponentProps:r,separator:d,debugIds:l})=>{const n=T(t),u=n?.getStore(),i=n?.getTableId(e),a=J(e,s,n);return ce(w(a,(e=>re(o,{...Ie(r,e),key:e,tableId:i,rowId:e,store:u,debugIds:l}))),d,l,s)},be=({queryId:e,rowId:s,cellId:t,queries:r,debugIds:d})=>ce(o+($(e,s,t,r)??o),void 0,d,t),ke=({queryId:e,rowId:s,queries:t,resultCellComponent:o=be,getResultCellComponentProps:r,separator:d,debugIds:l})=>ce(w(Z(e,s,t),(d=>re(o,{...Ie(r,d),key:d,queryId:e,rowId:s,cellId:d,queries:t,debugIds:l}))),d,l,s),ge=({checkpoints:e,checkpointId:s,debugIds:t})=>ce(se(s,e)??o,void 0,t,s),me=ae((e=>e[0])),he=ae((e=>R(e[1])?[]:[e[1]])),ye=ae((e=>e[2]));e.BackwardCheckpointsView=me,e.CellView=we,e.CheckpointView=ge,e.CurrentCheckpointView=he,e.ForwardCheckpointsView=ye,e.IndexView=({indexId:e,indexes:s,sliceComponent:t=pe,getSliceComponentProps:o,separator:r,debugIds:d})=>ce(w(H(e,s),(r=>re(t,{...Ie(o,r),key:r,indexId:e,sliceId:r,indexes:s,debugIds:d}))),r,d,e),e.LinkedRowsView=e=>ie(e,W,e.firstRowId),e.LocalRowsView=e=>ie(e,N,e.remoteRowId),e.MetricView=({metricId:e,metrics:s,debugIds:t})=>ce(z(e,s)??o,void 0,t,e),e.Provider=({store:e,storesById:t,metrics:o,metricsById:r,indexes:d,indexesById:l,relationships:n,relationshipsById:u,queries:i,queriesById:a,checkpoints:I,checkpointsById:c,children:w})=>{const R=s.useContext(g);return re(g.Provider,{value:de((()=>[e??R[0],{...R[1],...t},o??R[2],{...R[3],...r},d??R[4],{...R[5],...l},n??R[6],{...R[7],...u},i??R[8],{...R[9],...a},I??R[10],{...R[11],...c}]),[e,t,o,r,d,l,n,u,i,a,I,c,R])},w)},e.RemoteRowView=({relationshipId:e,localRowId:s,relationships:t,rowComponent:o=Re,getRowComponentProps:r,debugIds:d})=>{const[l,n]=ue(t),u=l?.getRemoteTableId(e),i=K(e,s,l);return ce(R(u)||R(i)?null:re(o,{...Ie(r,i),key:i,tableId:u,rowId:i,store:n,debugIds:d}),void 0,d,s)},e.ResultCellView=be,e.ResultRowView=ke,e.ResultSortedTableView=({cellId:e,descending:s,offset:t,limit:o,...r})=>ne(r,Y(r.queryId,e,s,t,o,r.queries)),e.ResultTableView=e=>ne(e,X(e.queryId,e.queries)),e.RowView=Re,e.SliceView=pe,e.SortedTableView=({cellId:e,descending:s,offset:t,limit:o,...r})=>le(r,U(r.tableId,e,s,t,o,r.store)),e.TableView=Ce,e.TablesView=({store:e,tableComponent:s=Ce,getTableComponentProps:t,separator:o,debugIds:r})=>ce(w(E(e),(o=>re(s,{...Ie(t,o),key:o,tableId:o,store:e,debugIds:r}))),o),e.tableView=le,e.useAddRowCallback=(e,s,t=[],o,r=p,d=[])=>{const l=y(o);return q((t=>C(l,(o=>C(s(t,o),(s=>r(o.addRow(e,s),o,s)))))),[l,e,...t,...d])},e.useCell=O,e.useCellIds=_,e.useCellIdsListener=(e,s,t,o,r,d)=>A(I,y(d),t,o,[e,s],r),e.useCellListener=(e,s,t,o,r,d,l)=>A(c,y(l),o,r,[e,s,t],d),e.useCheckpoint=se,e.useCheckpointIds=ee,e.useCheckpointIdsListener=(e,s,t)=>A("CheckpointIds",V(t),e,s),e.useCheckpointListener=(e,s,t,o)=>A("Checkpoint",V(o),s,t,[e]),e.useCheckpoints=e=>m(e,10),e.useCreateCheckpoints=(e,s,t)=>M(e,s,t),e.useCreateIndexes=(e,s,t)=>M(e,s,t),e.useCreateMetrics=(e,s,t)=>M(e,s,t),e.useCreatePersister=(e,s,t=[],o,r=[])=>{const[,d]=B(),l=x((()=>s(e)),[e,...t]);return v((()=>((async()=>{await(o?.(l)),d(1)})(),()=>{l.destroy()})),[l,...r]),l},e.useCreateQueries=(e,s,t)=>M(e,s,t),e.useCreateRelationships=(e,s,t)=>M(e,s,t),e.useCreateStore=(e,s=[])=>x(e,s),e.useDelCellCallback=(e,s,t,o,r,d,l)=>G(r,c,d,l,e,s,t,o),e.useDelRowCallback=(e,s,t,o,r)=>G(t,a,o,r,e,s),e.useDelTableCallback=(e,s,t,o)=>G(s,n,t,o,e),e.useDelTablesCallback=(e,s,t)=>G(e,d,s,t),e.useGoBackwardCallback=te,e.useGoForwardCallback=oe,e.useGoToCallback=(e,s=[],t,o=p,r=[])=>{const d=V(t);return q((s=>C(d,(t=>C(e(s),(e=>o(t.goTo(e),e)))))),[d,...s,...r])},e.useIndexes=e=>m(e,4),e.useLinkedRowIds=W,e.useLinkedRowIdsListener=(e,s,t,o,r)=>A("LinkedRowIds",S(r),t,o,[e,s]),e.useLocalRowIds=N,e.useLocalRowIdsListener=(e,s,t,o,r)=>A("LocalRowIds",S(r),t,o,[e,s]),e.useMetric=z,e.useMetricListener=(e,s,t,o)=>A("Metric",L(o),s,t,[e]),e.useMetrics=e=>m(e,2),e.useQueries=e=>m(e,8),e.useRedoInformation=e=>{const s=V(e),[,,[t]]=ee(s);return[!R(t),oe(s),t,C(t,(e=>s?.getCheckpoint(e)))??o]},e.useRelationships=e=>m(e,6),e.useRemoteRowId=K,e.useRemoteRowIdListener=(e,s,t,o,r)=>A("RemoteRowId",S(r),t,o,[e,s]),e.useResultCell=$,e.useResultCellIds=Z,e.useResultCellIdsListener=(e,s,t,o,r)=>A("ResultCellIds",f(r),t,o,[e,s]),e.useResultCellListener=(e,s,t,o,r,d)=>A("ResultCell",f(d),o,r,[e,s,t]),e.useResultRow=(e,s,t)=>D("ResultRow",f(t),{},[e,s]),e.useResultRowIds=X,e.useResultRowIdsListener=(e,s,t,o)=>A("ResultRowIds",f(o),s,t,[e]),e.useResultRowListener=(e,s,t,o,r)=>A("ResultRow",f(r),t,o,[e,s]),e.useResultSortedRowIds=Y,e.useResultSortedRowIdsListener=(e,s,t,o,r,d,l,n)=>A("ResultSortedRowIds",f(n),d,l,[e,s,t,o,r]),e.useResultTable=(e,s)=>D("ResultTable",f(s),{},[e]),e.useResultTableListener=(e,s,t,o)=>A("ResultTable",f(o),s,t,[e]),e.useRow=(e,s,t)=>D(a,y(t),{},[e,s]),e.useRowIds=Q,e.useRowIdsListener=(e,s,t,o,r)=>A(u,y(r),s,t,[e],o),e.useRowListener=(e,s,t,o,r,d)=>A(a,y(d),t,o,[e,s],r),e.useSetCellCallback=(e,s,t,o,r,d,l,n)=>F(d,c,o,r,l,n,e,s,t),e.useSetCheckpointCallback=(e=p,s=[],t,o=p,r=[])=>{const d=V(t);return q((s=>C(d,(t=>{const r=e(s);o(t.addCheckpoint(r),t,r)}))),[d,...s,...r])},e.useSetPartialRowCallback=(e,s,t,o,r,d,l)=>F(r,"PartialRow",t,o,d,l,e,s),e.useSetRowCallback=(e,s,t,o,r,d,l)=>F(r,a,t,o,d,l,e,s),e.useSetTableCallback=(e,s,t,o,r,d)=>F(o,n,s,t,r,d,e),e.useSetTablesCallback=(e,s,t,o,r)=>F(t,d,e,s,o,r),e.useSliceIds=H,e.useSliceIdsListener=(e,s,t,o)=>A("SliceIds",T(o),s,t,[e]),e.useSliceRowIds=J,e.useSliceRowIdsListener=(e,s,t,o,r)=>A("SliceRowIds",T(r),t,o,[e,s]),e.useSortedRowIds=U,e.useSortedRowIdsListener=(e,s,t,o,r,d,l,n,u)=>A(i,y(u),d,l,[e,s,t,o,r],n),e.useStore=e=>m(e,0),e.useTable=(e,s)=>D(n,y(s),{},[e]),e.useTableIds=E,e.useTableIdsListener=(e,s,t,o)=>A(l,y(o),e,s,[],t),e.useTableListener=(e,s,t,o,r)=>A(n,y(r),s,t,[e],o),e.useTables=e=>D(d,y(e),{}),e.useTablesListener=(e,s,t,o)=>A(d,y(o),e,s,[],t),e.useUndoInformation=e=>{const s=V(e),[t,r]=ee(s);return[(d=t,!(0==(e=>e.length)(d))),te(s),r,C(r,(e=>s?.getCheckpoint(e)))??o];var d},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],s):s((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseUiReact={},e.React);
