var e,l;e=this,l=function(e,l,t){"use strict";const a=e=>typeof e,s=a(""),n=a(!0),o=a(0),u="Value",r="currentTarget",d="value",i=isFinite,c=e=>null==e,m=(e,l,t,a)=>e==s?l:e==o?t:a,{PureComponent:b,Fragment:h,createElement:I,useCallback:C,useLayoutEffect:p,useRef:g,useState:y}=t,T=(e,...l)=>c(e)?{}:e(...l),w=(e,l)=>e.map(l),R=Object,f=R.entries,k=(e=[])=>R.fromEntries(e),S=(e,l)=>w(f(e),(([e,t])=>l(t,e))),{useCallback:N,useMemo:V,useState:v}=t,x="editable",q=(e,t)=>w(l.useTableCellIds(e,t),(l=>e+"."+l)),H=(e,l,t)=>{const a=N(e,l);return t?a:void 0},O=(...e)=>V((()=>e),e),B=(e,l)=>V((()=>({store:e,tableId:l})),[e,l]),F=(e,l)=>V((()=>({queries:e,queryId:l})),[e,l]),E=(e,l=!1,t,a=0,s,n,o,u)=>{const[[r,d,i],c]=v([e,l,a]),m=N((e=>{c(e),u?.(e)}),[u]),b=H((e=>m([e,e==r&&!d,i])),[m,r,d,i],t),h=N((e=>m([r,d,e])),[m,r,d]),C=!0===o?$:o;return[[r,d,i],b,V((()=>!1===o?null:I(C,{offset:i,limit:s,total:n,onChange:h})),[o,C,i,s,n,h])]},P=(e,l,t)=>V((()=>{const n=l??e;return o=Array.isArray(n)?k(w(n,(e=>[e,e]))):n,u=(e,l)=>{return{label:l,component:t,...(n=e,a(n)==s?{label:e}:e)};var n},k(S(o,((e,l)=>[l,u(e,l)])));var o,u}),[l,t,e]),j=({className:e,headerRow:l,idColumn:t,params:[a,s,n,o,u,r]})=>I("table",{className:e},r?I("caption",null,r):null,!1===l?null:I("thead",null,I("tr",null,!1===t?null:I(A,{sort:o??[],label:"Id",onClick:u}),S(a,(({label:e},l)=>I(A,{key:l,cellId:l,label:e,sort:o??[],onClick:u}))))),I("tbody",null,w(n,(e=>I("tr",{key:e},!1===t?null:I("th",null,e),S(a,(({component:l,getComponentProps:t},a)=>I("td",{key:a},I(l,{...T(t,e,a),...s,rowId:e,cellId:a}))))))))),A=({cellId:e,sort:[l,t],label:a=e??"",onClick:s})=>I("th",{onClick:H((()=>s?.(e)),[s,e],s),className:c(t)||l!=e?void 0:`sorted ${t?"de":"a"}scending`},c(t)||l!=e?null:(t?"↓":"↑")+" ",a),L=({localRowId:e,params:[a,s,n,o,u,r,d]})=>{const i=l.useRemoteRowId(u,e,r);return I("tr",null,!1===a?null:I(t.Fragment,null,I("th",null,e),I("th",null,i)),S(s,(({component:l,getComponentProps:t},a)=>{const[s,u]=a.split(".",2),r=s===n?e:s===o?i:null;return c(r)?null:I("td",{key:a},I(l,{...T(t,r,u),store:d,tableId:s,rowId:r,cellId:u}))})))},M=({thing:e,onThingChange:l,className:t,hasSchema:u,showType:c=!0})=>{const[b,h]=v(),[C,p]=v(),[g,y]=v(),[T,w]=v(),[R,f]=v();C!==e&&(h((e=>{const l=a(e);return(e=>e==s||e==n)(l)||l==o&&i(e)?l:void 0})(e)),p(e),y(e+""),w(Number(e)||0),f(!!e));const k=N(((e,t)=>{t(e),p(e),l(e)}),[l]),S=N((()=>{if(!u?.()){const e=m(b,o,n,s),t=m(e,g,T,R);h(e),p(t),l(t)}}),[u,l,g,T,R,b]);return I("div",{className:t},c?I("button",{className:b,onClick:S},b):null,m(b,I("input",{key:b,value:g,onChange:N((e=>k(e[r][d]+"",y)),[k])}),I("input",{key:b,type:"number",value:T,onChange:N((e=>k(Number(e[r][d]||0),w)),[k])}),I("input",{key:b,type:"checkbox",checked:R,onChange:N((e=>k(!!e[r].checked,f)),[k])})))},U=({tableId:e,rowId:t,cellId:a,store:s,className:n,showType:o})=>I(M,{thing:l.useCell(e,t,a,s),onThingChange:l.useSetCellCallback(e,t,a,(e=>e),[],s),className:n??x+"Cell",showType:o,hasSchema:l.useStoreOrStoreById(s)?.hasTablesSchema}),D=({valueId:e,store:t,className:a,showType:s})=>I(M,{thing:l.useValue(e,t),onThingChange:l.useSetValueCallback(e,(e=>e),[],t),className:a??x+u,showType:s,hasSchema:l.useStoreOrStoreById(t)?.hasValuesSchema}),$=({onChange:e,total:l,offset:a=0,limit:s=l,singular:n="row",plural:o=n+"s"})=>{(a>l||a<0)&&(a=0,e(0));const u=H((()=>e(a-s)),[e,a,s],a>0),r=H((()=>e(a+s)),[e,a,s],a+s<l);return I(t.Fragment,null,l>s&&I(t.Fragment,null,I("button",{className:"previous",disabled:0==a,onClick:u},"←"),I("button",{className:"next",disabled:a+s>=l,onClick:r},"→"),a+1," to ",Math.min(l,a+s)," of "),l," ",1!=l?o:n)};e.EditableCellView=U,e.EditableValueView=D,e.RelationshipInHtmlTable=({relationshipId:e,relationships:a,editable:s,customCells:n,className:o,headerRow:u,idColumn:r=!0})=>{const[d,i,c,m]=((e,l)=>[e,e?.getStore(),e?.getLocalTableId(l),e?.getRemoteTableId(l)])(l.useRelationshipsOrRelationshipsById(a),e),b=P([...q(c,i),...q(m,i)],n,s?U:l.CellView),h=O(r,b,c,m,e,d,i);return I("table",{className:o},!1===u?null:I("thead",null,I("tr",null,!1===r?null:I(t.Fragment,null,I("th",null,c,".Id"),I("th",null,m,".Id")),S(b,(({label:e},l)=>I("th",{key:l},e))))),I("tbody",null,w(l.useRowIds(c,i),(e=>I(L,{key:e,localRowId:e,params:h})))))},e.ResultSortedTableInHtmlTable=({queryId:e,cellId:t,descending:a,offset:s,limit:n,queries:o,sortOnClick:u,paginator:r=!1,customCells:d,onChange:i,...c})=>{const[m,b,h]=E(t,a,u,s,n,l.useResultRowCount(e,o),r,i);return I(j,{...c,params:O(P(l.useResultTableCellIds(e,o),d,l.ResultCellView),F(o,e),l.useResultSortedRowIds(e,...m,n,o),m,b,h)})},e.ResultTableInHtmlTable=({queryId:e,queries:t,customCells:a,...s})=>I(j,{...s,params:O(P(l.useResultTableCellIds(e,t),a,l.ResultCellView),F(t,e),l.useResultRowIds(e,t))}),e.SliceInHtmlTable=({indexId:e,sliceId:t,indexes:a,editable:s,customCells:n,...o})=>{const[u,r,d]=((e,l)=>[e,e?.getStore(),e?.getTableId(l)])(l.useIndexesOrIndexesById(a),e);return I(j,{...o,params:O(P(l.useTableCellIds(d,r),n,s?U:l.CellView),B(r,d),l.useSliceRowIds(e,t,u))})},e.SortedTableInHtmlTable=({tableId:e,cellId:t,descending:a,offset:s,limit:n,store:o,editable:u,sortOnClick:r,paginator:d=!1,onChange:i,customCells:c,...m})=>{const[b,h,C]=E(t,a,r,s,n,l.useRowCount(e,o),d,i);return I(j,{...m,params:O(P(l.useTableCellIds(e,o),c,u?U:l.CellView),B(o,e),l.useSortedRowIds(e,...b,n,o),b,h,C)})},e.SortedTablePaginator=$,e.TableInHtmlTable=({tableId:e,store:t,editable:a,customCells:s,...n})=>I(j,{...n,params:O(P(l.useTableCellIds(e,t),s,a?U:l.CellView),B(t,e),l.useRowIds(e,t))}),e.ValuesInHtmlTable=({store:e,editable:t=!1,valueComponent:a=(t?D:l.ValueView),getValueComponentProps:s,className:n,headerRow:o,idColumn:r})=>I("table",{className:n},!1===o?null:I("thead",null,I("tr",null,!1===r?null:I("th",null,"Id"),I("th",null,u))),I("tbody",null,w(l.useValueIds(e),(l=>I("tr",{key:l},!1===r?null:I("th",null,l),I("td",null,I(a,{...T(s,l),valueId:l,store:e})))))))},"object"==typeof exports&&"undefined"!=typeof module?l(exports,require("../ui-react/index.js"),require("react")):"function"==typeof define&&define.amd?define(["exports","../ui-react","react"],l):l((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseUiReactDom={},e.TinyBaseUiReact,e.React);
