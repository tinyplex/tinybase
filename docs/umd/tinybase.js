var e,t;e=this,t=function(e){"use strict";const t=e=>typeof e,s="",n=t(s),a=t(!0),o=t(0),r=t(t),l="type",i="default",c="Listener",d="Result",u="add",g="Has",h="Ids",f="Table",L=f+"s",C=f+h,b="Row",w=b+"Count",p=b+h,T="Sorted"+b+h,v="Cell",I=v+h,y="Value",R=y+"s",S=y+h,M=e=>s+e,m=(e,t)=>e.startsWith(t),V=(e,t)=>e.endsWith(t),E=Math.max,k=Math.min,D=isFinite,x=e=>null==e,A=(e,t,s)=>x(e)?s?.():t(e),H=e=>e==n||e==a,J=e=>t(e)==n,F=e=>t(e)==r,Q=e=>Array.isArray(e),z=(e,t,s)=>e.slice(t,s),N=e=>e.length,O=()=>{},P=(e,t)=>e.includes(t),W=(e,t)=>e.every(t),j=(e,t)=>N(e)===N(t)&&W(e,((e,s)=>t[s]===e)),B=(e,t)=>W(e,((s,n)=>0==n||t(e[n-1],s)<=0)),_=(e,t)=>e.sort(t),$=(e,t)=>e.forEach(t),q=(e,t)=>e.map(t),G=e=>U(e,((e,t)=>e+t),0),K=e=>0==N(e),U=(e,t,s)=>e.reduce(t,s),X=(e,...t)=>e.push(...t),Y=e=>e.pop(),Z=e=>e.shift(),ee=Object,te=e=>ee.getPrototypeOf(e),se=ee.entries,ne=ee.isFrozen,ae=e=>!x(e)&&A(te(e),(e=>e==ee.prototype||x(te(e))),(()=>!0)),oe=ee.keys,re=ee.freeze,le=(e=[])=>ee.fromEntries(e),ie=(e,t)=>t in e,ce=(e,t)=>(delete e[t],e),de=(e,t)=>$(se(e),(([e,s])=>t(s,e))),ue=(e,t)=>q(se(e),(([e,s])=>t(s,e))),ge=(e,t)=>le(ue(e,((e,s)=>[s,t(e,s)]))),he=e=>ae(e)&&0==(e=>N(oe(e)))(e),fe=(e,t,s)=>(ie(e,t)||(e[t]=s()),e[t]),Le=(e,t,s,n=0)=>x(e)||!ae(e)||!n&&he(e)||ne(e)?(s?.(),!1):(ue(e,((s,n)=>{t(s,n)||ce(e,n)})),!!n||!he(e)),Ce=e=>e?.size??0,be=(e,t)=>e?.has(t)??!1,we=e=>x(e)||0==Ce(e),pe=e=>[...e?.values()??[]],Te=e=>e.clear(),ve=(e,t)=>e?.forEach(t),Ie=(e,t)=>e?.delete(t),ye=e=>new Map(e),Re=e=>[...e?.keys()??[]],Se=(e,t)=>e?.get(t),Me=(e,t)=>ve(e,((e,s)=>t(s,e))),me=(e,t,s)=>x(s)?(Ie(e,t),e):e?.set(t,s),Ve=(e,t,s,n)=>(be(e,t)?n?.(Se(e,t)):me(e,t,s()),Se(e,t)),Ee=(e,t,s,n=me)=>(ue(t,((t,n)=>s(e,n,t))),Me(e,(s=>ie(t,s)?0:n(e,s))),e),ke=(e,t,s,n)=>{const a={};return ve(e,((e,o)=>{if(!s?.(e,o)){const s=t?t(e,o):e;!n?.(s)&&(a[o]=s)}})),a},De=(e,t,s)=>ke(e,(e=>ke(e,t,s)),we,he),xe=(e,t,s)=>ke(e,(e=>De(e,t,s)),we,he),Ae=(e,t)=>{const s=ye();return ve(e,((e,n)=>s.set(n,t?.(e)??e))),s},He=e=>Ae(e,Ae),Je=e=>Ae(e,He),Fe=(e,t,s,n,a=0)=>A((s?Ve:Se)(e,t[a],a>N(t)-2?s:ye),(o=>{if(a>N(t)-2)return n?.(o)&&me(e,t[a]),o;const r=Fe(o,t,s,n,a+1);return we(o)&&me(e,t[a]),r})),Qe=e=>{const s=t(e);return H(s)||s==o&&D(e)?s:void 0},ze=e=>null===e||!x(Qe(e)),Ne=(e,t,s,n,a)=>x(a)?e.delCell(t,s,n,!0):e.setCell(t,s,n,a),Oe=(e,t,s)=>x(s)?e.delValue(t):e.setValue(t,s),Pe=e=>new Set(Q(e)||x(e)?e:[e]),We=(e,t)=>e?.add(t),je=(e,t,s,n,a)=>{const o=e.hasRow,r=ye(),l=ye(),i=ye(),c=ye(),d=ye(),u=ye(),g=(t,s,...n)=>{const a=Ve(u,t,Pe);return $(n,(t=>We(a,t)&&s&&e.callListener(t))),n},h=(t,...s)=>A(Se(u,t),(n=>{$(K(s)?pe(n):s,(t=>{e.delListener(t),Ie(n,t)})),we(n)&&me(u,t)})),f=(e,s)=>{me(r,e,s),be(l,e)||(me(l,e,t()),me(c,e,ye()),me(d,e,ye()),a(i))},L=e=>{me(r,e),me(l,e),me(c,e),me(d,e),h(e),a(i)};return[()=>e,()=>Re(r),e=>Me(l,e),e=>be(l,e),e=>Se(r,e),e=>Se(l,e),(e,t)=>me(l,e,t),f,(t,n,a,r,l)=>{f(t,n);const i=ye(),u=ye(),L=Se(c,t),C=Se(d,t),b=t=>{const a=s=>e.getCell(n,t,s),c=Se(L,t),d=o(n,t)?s(r(a,t)):void 0;if(c===d||Q(c)&&Q(d)&&j(c,d)||me(i,t,[c,d]),!x(l)){const e=Se(C,t),s=o(n,t)?l(a,t):void 0;e!=s&&me(u,t,s)}},w=e=>{a((()=>{ve(i,(([,e],t)=>me(L,t,e))),ve(u,((e,t)=>me(C,t,e)))}),i,u,L,C,e),Te(i),Te(u)};Me(L,b),e.hasTable(n)&&$(e.getRowIds(n),(e=>{be(L,e)||b(e)})),w(!0),h(t),g(t,0,e.addRowListener(n,null,((e,t,s)=>b(s))),e.addTableListener(n,(()=>w())))},L,e=>n(e,i),()=>Me(u,L),g,h]},Be=(e,t)=>J(e)?t=>t(e):e??(()=>t??s),_e=(e,t)=>{const s=new WeakMap;return n=>{s.has(n)||s.set(n,e(n));const a=s.get(n);return t?.(a),a}},$e=/^\d+$/,qe=()=>{const e=[];let t=0;return[n=>(n?Z(e):null)??s+t++,t=>{$e.test(t)&&N(e)<1e3&&X(e,t)}]},Ge=e=>{let t;const[n,a]=qe(),o=ye();return[(a,r,l,i=[],c=(()=>[]))=>{t??=e();const d=n(1);return me(o,d,[a,r,l,i,c]),We(Fe(r,l??[s],Pe),d),d},(e,n,...a)=>$(((e,t=[s])=>{const n=[],a=(e,s)=>s==N(t)?X(n,e):null===t[s]?ve(e,(e=>a(e,s+1))):$([t[s],null],(t=>a(Se(e,t),s+1)));return a(e,0),n})(e,n),(e=>ve(e,(e=>Se(o,e)[0](t,...n??[],...a))))),e=>A(Se(o,e),(([,t,n])=>(Fe(t,n??[s],void 0,(t=>(Ie(t,e),we(t)?1:0))),me(o,e),a(e),n))),e=>A(Se(o,e),(([e,,s=[],n,a])=>{const o=(...r)=>{const l=N(r);l==N(s)?e(t,...r,...a(r)):x(s[l])?$(n[l]?.(...r)??[],(e=>o(...r,e))):o(...r,s[l])};o()}))]},Ke=_e((e=>{let t,n,a,o=100,r=ye(),l=ye(),i=1;const c=ye(),d=ye(),[u,g,h]=Ge((()=>J)),f=ye(),L=ye(),C=[],b=[],w=(t,s)=>{i=0,e.transaction((()=>{const[n,a]=Se(f,s);ve(n,((s,n)=>ve(s,((s,a)=>ve(s,((s,o)=>Ne(e,n,a,o,s[t]))))))),ve(a,((s,n)=>Oe(e,n,s[t])))})),i=1},p=e=>{me(f,e),me(L,e),g(d,[e])},T=(e,t)=>$(((e,t)=>e.splice(0,t))(e,t??N(e)),p),v=()=>T(C,N(C)-o),I=()=>A(t,(()=>{X(C,t),v(),T(b),t=void 0,a=1})),y=()=>{t=Y(C),a=1};let R,S;const M=(e="")=>(x(t)&&(t=s+n++,me(f,t,[r,l]),D(t,e),r=ye(),l=ye(),a=1),t),m=()=>{K(C)||(((e,...t)=>{e.unshift(...t)})(b,M()),w(0,t),t=Y(C),a=1)},V=()=>{K(b)||(X(C,t),t=Z(b),w(1,t),a=1)},E=()=>{a&&(g(c),a=0)},k=e=>{const t=M(e);return E(),t},D=(e,t)=>(H(e)&&Se(L,e)!==t&&(me(L,e,t),g(d,[e])),J),H=e=>be(f,e),J={setSize:e=>(o=e,v(),J),addCheckpoint:k,setCheckpoint:D,getStore:()=>e,getCheckpointIds:()=>[[...C],t,[...b]],forEachCheckpoint:e=>Me(L,e),hasCheckpoint:H,getCheckpoint:e=>Se(L,e),goBackward:()=>(m(),E(),J),goForward:()=>(V(),E(),J),goTo:e=>{const s=P(C,e)?m:P(b,e)?V:null;for(;!x(s)&&e!=t;)s();return E(),J},addCheckpointIdsListener:e=>u(e,c),addCheckpointListener:(e,t)=>u(t,d,[e]),delListener:e=>(h(e),J),clear:()=>(T(C),T(b),x(t)||p(t),t=void 0,n=0,k(),J),clearForward:()=>(K(b)||(T(b),g(c)),J),destroy:()=>{e.delListener(R),e.delListener(S)},getListenerStats:()=>({}),_registerListeners:()=>{R=e.addCellListener(null,null,null,((e,t,s,n,a,o)=>{if(i){I();const e=Ve(r,t,ye),l=Ve(e,s,ye),i=Ve(l,n,(()=>[o,void 0]));i[1]=a,i[0]===a&&we(me(l,n))&&we(me(e,s))&&we(me(r,t))&&y(),E()}})),S=e.addValueListener(null,((e,t,s,n)=>{if(i){I();const e=Ve(l,t,(()=>[n,void 0]));e[1]=s,e[0]===s&&we(me(l,t))&&y(),E()}}))}};return re(J.clear())}),(e=>e._registerListeners())),Ue=(e,t)=>(e??0)<(t??0)?-1:1,Xe=_e((e=>{const t=ye(),n=ye(),[a,o,r]=Ge((()=>p)),[l,i,c,d,u,g,h,,f,L,C,b]=je(e,ye,(e=>x(e)?s:Q(e)?q(e,M):M(e)),a,o),w=(t,s,n)=>{const a=u(t);ve(n,((t,n)=>s(n,(s=>ve(t,(t=>s(t,(s=>e.forEachCell(a,t,s)))))))))},p={setIndexDefinition:(e,s,a,r,l,i=Ue)=>{const c=x(l)?void 0:([e],[t])=>l(e,t);return f(e,s,((s,a,l,d,u,f)=>{let L=0;const C=Pe(),b=Pe(),w=g(e);if(ve(a,(([e,t],s)=>{const n=Pe(e),a=Pe(t);ve(n,(e=>Ie(a,e)?Ie(n,e):0)),ve(n,(e=>{We(C,e),A(Se(w,e),(t=>{Ie(t,s),we(t)&&(me(w,e),L=1)}))})),ve(a,(e=>{We(C,e),be(w,e)||(me(w,e,Pe()),L=1),We(Se(w,e),s),x(r)||We(b,e)}))})),s(),we(u)||(f?Me(w,(e=>We(b,e))):Me(l,(e=>A(Se(d,e),(e=>We(b,e))))),ve(b,(e=>{const t=(t,s)=>i(Se(u,t),Se(u,s),e),s=[...Se(w,e)];B(s,t)||(me(w,e,Pe(_(s,t))),We(C,e))}))),(L||f)&&!x(c)){const t=[...w];B(t,c)||(h(e,ye(_(t,c))),L=1)}L&&o(t,[e]),ve(C,(t=>o(n,[e,t])))}),Be(a),A(r,Be)),p},delIndexDefinition:e=>(L(e),p),getStore:l,getIndexIds:i,forEachIndex:e=>c(((t,s)=>e(t,(e=>w(t,e,s))))),forEachSlice:(e,t)=>w(e,t,g(e)),hasIndex:d,hasSlice:(e,t)=>be(g(e),t),getTableId:u,getSliceIds:e=>Re(g(e)),getSliceRowIds:(e,t)=>pe(Se(g(e),t)),addIndexIdsListener:C,addSliceIdsListener:(e,s)=>a(s,t,[e]),addSliceRowIdsListener:(e,t,s)=>a(s,n,[e,t]),delListener:e=>(r(e),p),destroy:b,getListenerStats:()=>({})};return re(p)})),Ye=ye([["avg",[(e,t)=>G(e)/t,(e,t,s)=>e+(t-e)/(s+1),(e,t,s)=>e+(e-t)/(s-1),(e,t,s,n)=>e+(t-s)/n]],["max",[e=>E(...e),(e,t)=>E(t,e),(e,t)=>t==e?void 0:e,(e,t,s)=>s==e?void 0:E(t,e)]],["min",[e=>k(...e),(e,t)=>k(t,e),(e,t)=>t==e?void 0:e,(e,t,s)=>s==e?void 0:k(t,e)]],["sum",[e=>G(e),(e,t)=>e+t,(e,t)=>e-t,(e,t,s)=>e-s+t]]]),Ze=(e,t,s,n,a,o=!1)=>{if(we(s))return;const[r,l,i,c]=a;return o||=x(e),ve(n,(([s,n])=>{o||(e=x(s)?l?.(e,n,t++):x(n)?i?.(e,s,t--):c?.(e,n,s,t),o||=x(e))})),o?r(pe(s),Ce(s)):e},et=_e((e=>{const t=ye(),[n,a,o]=Ge((()=>b)),[r,l,i,c,d,u,g,,h,f,L,C]=je(e,O,(e=>isNaN(e)||x(e)||!0===e||!1===e||e===s?void 0:1*e),n,a),b={setMetricDefinition:(e,s,n,o,r,l,i)=>{const c=F(n)?[n,r,l,i]:Se(Ye,n)??Se(Ye,"sum");return h(e,s,((s,n,o,r,l,i)=>{const d=u(e),h=Ce(r);i||=x(d),s();let f=Ze(d,h,r,n,c,i);D(f)||(f=void 0),f!=d&&(g(e,f),a(t,[e],f,d))}),Be(o,1)),b},delMetricDefinition:e=>(f(e),b),getStore:r,getMetricIds:l,forEachMetric:i,hasMetric:c,getTableId:d,getMetric:u,addMetricIdsListener:L,addMetricListener:(e,s)=>n(s,t,[e]),delListener:e=>(o(e),b),destroy:C,getListenerStats:()=>({})};return re(b)})),tt=ye(),st=ye(),nt=_e((e=>{const t=e.createStore,n=t(),a=t(),o=ye(),{addListener:r,callListeners:l,delListener:i}=a,[g,h,L,C,y,,,R,,S,M,m,V,E]=je(e,(()=>!0),O,r,l),k=(e,t,...s)=>$(s,(s=>We(Ve(Ve(o,t,ye),e,Pe),s))),D=e=>{A(Se(o,e),(e=>{Me(e,((e,t)=>ve(t,(t=>e.delListener(t))))),Te(e)})),$([a,n],(t=>t.delTable(e)))},H=(e,t,s)=>k(t,e,t.addStartTransactionListener(s.startTransaction),t.addDidFinishTransactionListener((()=>s.finishTransaction()))),J={setQueryDefinition:(t,o,r)=>{R(t,o),D(t);const l=[],i=[[null,[o,null,null,[],ye()]]],c=[],d=[],u=[];r({select:(e,t)=>{const n=F(e)?[N(l)+s,e]:[x(t)?e:t,s=>s(e,t)];return X(l,n),{as:e=>n[0]=e}},join:(e,t,s)=>{const n=x(s)||F(t)?null:t,a=x(n)?t:s,o=[e,[e,n,F(a)?a:e=>e(a),[],ye()]];return X(i,o),{as:e=>o[0]=e}},where:(e,t,s)=>X(c,F(e)?e:x(s)?s=>s(e)===t:n=>n(e,t)===s),group:(e,t,s,n,a)=>{const o=[e,[e,F(t)?[t,s,n,a]:Se(Ye,t)??[(e,t)=>t]]];return X(d,o),{as:e=>o[0]=e}},having:(e,t)=>X(u,F(e)?e:s=>s(e)===t)});const g=ye(l);if(we(g))return J;const h=ye(i);Me(h,((e,[,t])=>A(Se(h,t),(({3:t})=>x(e)?0:X(t,e)))));const f=ye(d);let L=n;if(we(f)&&K(u))L=a;else{H(t,L,a);const e=ye();Me(f,((t,[s,n])=>We(Ve(e,s,Pe),[t,n])));const s=Pe();Me(g,(t=>be(e,t)?0:We(s,t)));const n=ye(),o=(s,n,o,r)=>A(s,(([l,i,c,d])=>{Me(n,((t,[s])=>{const n=Ve(l,t,ye),a=Se(n,o),i=r?void 0:s;if(a!==i){const s=Pe([[a,i]]),r=Ce(n);me(n,o,i),ve(Se(e,t),(([e,t])=>{const a=Ze(d[e],r,n,s,t);d[e]=x(Qe(a))?null:a}))}})),we(i)||!W(u,(e=>e((e=>d[e]))))?a.delRow(t,c):x(c)?s[2]=a.addRow(t,d):a.setRow(t,c,d)}));k(L,t,L.addRowListener(t,null,((a,r,l,i)=>{const c=[],d=[],u=ye(),g=L.hasRow(t,l);let h=!g;ve(s,(e=>{const[s,n,a]=i(t,l,e);X(c,n),X(d,a),h||=s})),Me(e,(e=>{const[s,,n]=i(t,l,e);(h||s)&&me(u,e,[n])})),h&&o(Fe(n,c,void 0,(([,e])=>(Ie(e,l),we(e)))),u,l,1),g&&o(Fe(n,d,(()=>{const e={};return ve(s,(s=>e[s]=L.getCell(t,l,s))),[ye(),Pe(),void 0,e]}),(([,e])=>{We(e,l)})),u,l)})))}H(t,e,L);const C=(s,n,a,r)=>{const l=t=>e.getCell(n,a,t);$(r,(n=>{const[a,,o,r,i]=Se(h,n),c=o?.(l,s),[d,u]=Se(i,s)??[];c!=d&&(x(u)||E(t,u),me(i,s,x(c)?null:[c,...V(t,1,e.addRowListener(a,c,(()=>C(s,a,c,r))))]))})),(s=>{const n=(t,n)=>e.getCell(...x(n)?[o,s,t]:t===o?[o,s,n]:[Se(h,t)?.[0],Se(Se(h,t)?.[4],s)?.[0],n]);L.transaction((()=>W(c,(e=>e(n)))?Me(g,((e,a)=>Ne(L,t,s,e,a(n,s)))):L.delRow(t,s)))})(s)},{3:b}=Se(h,null);return L.transaction((()=>V(t,1,e.addRowListener(o,null,((s,n,a)=>{e.hasRow(o,a)?C(a,o,a,b):(L.delRow(t,a),ve(h,(({4:e})=>A(Se(e,a),(([,s])=>{E(t,s),me(e,a)})))))}))))),J},delQueryDefinition:e=>(D(e),S(e),J),getStore:g,getQueryIds:h,forEachQuery:L,hasQuery:C,getTableId:y,addQueryIdsListener:e=>M((()=>e(J))),delListener:e=>(i(e),J),destroy:m,getListenerStats:()=>{const{tables:e,tableIds:t,transaction:s,...n}=a.getListenerStats();return n}};return ue({[f]:[1,1],[f+I]:[0,1],[w]:[0,1],[p]:[0,1],[T]:[0,5],[b]:[1,2],[I]:[0,2],[v]:[1,3]},(([e,t],s)=>{$(e?["get","has","forEach"]:["get"],(e=>J[e+d+s]=(...t)=>a[e+s](...t))),J[u+d+s+c]=(...e)=>a[u+s+c](...z(e,0,t),((s,...n)=>e[t](J,...n)),!0)})),re(J)})),at=_e((e=>{const t=ye(),n=ye(),a=ye(),o=ye(),[r,l,i]=Ge((()=>I)),[c,d,u,g,h,f,,,L,C,b,w]=je(e,(()=>[ye(),ye(),ye(),ye()]),(e=>x(e)?void 0:e+s),r,l),p=(e,t,s)=>A(f(e),(([n,,a])=>{if(!be(a,t)){const o=Pe();if(h(e)!=v(e))We(o,t);else{let e=t;for(;!x(e)&&!be(o,e);)We(o,e),e=Se(n,e)}if(s)return o;me(a,t,o)}return Se(a,t)})),T=(e,t)=>A(f(e),(([,,e])=>me(e,t))),v=e=>Se(t,e),I={setRelationshipDefinition:(e,s,r,i)=>(me(t,e,r),L(e,s,((t,s)=>{const r=Pe(),i=Pe(),c=Pe(),[d,u]=f(e);ve(s,(([t,s],n)=>{x(t)||(We(i,t),A(Se(u,t),(e=>{Ie(e,n),we(e)&&me(u,t)}))),x(s)||(We(i,s),be(u,s)||me(u,s,Pe()),We(Se(u,s),n)),We(r,n),me(d,n,s),Me(Se(o,e),(t=>{be(p(e,t),n)&&We(c,t)}))})),t(),ve(r,(t=>l(n,[e,t]))),ve(i,(t=>l(a,[e,t]))),ve(c,(t=>{T(e,t),l(o,[e,t])}))}),Be(i)),I),delRelationshipDefinition:e=>(me(t,e),C(e),I),getStore:c,getRelationshipIds:d,forEachRelationship:t=>u((s=>t(s,(t=>e.forEachRow(h(s),t))))),hasRelationship:g,getLocalTableId:h,getRemoteTableId:v,getRemoteRowId:(e,t)=>Se(f(e)?.[0],t),getLocalRowIds:(e,t)=>pe(Se(f(e)?.[1],t)),getLinkedRowIds:(e,t)=>x(f(e))?[t]:pe(p(e,t,!0)),addRelationshipIdsListener:b,addRemoteRowIdListener:(e,t,s)=>r(s,n,[e,t]),addLocalRowIdsListener:(e,t,s)=>r(s,a,[e,t]),addLinkedRowIdsListener:(e,t,s)=>(p(e,t),r(s,o,[e,t])),delListener:e=>(T(...i(e)??[]),I),destroy:w,getListenerStats:()=>({})};return re(I)})),ot=new globalThis.TextEncoder,rt=e=>{let t=2166136261;return $(ot.encode(e),(e=>{t^=e,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)})),t>>>0},lt=([e,t,s])=>[e,t,s],it=([e,t])=>[e,t],ct=e=>e[2],dt=(e,t)=>rt(e+":"+t),ut=(e,t,s)=>{e[2]=t>>>0,s>e[0]&&(e[0]=s)},gt=e=>[e,le()],ht=(e="")=>[e,ye(),0],ft=([e,t,s],n=lt)=>[e,ke(t,n),s],Lt=(e,s)=>Q(e)&&3==N(e)&&J(e[0])&&s(e[1])&&t(e[2])==o&&D(e[2]),Ct=e=>[e,e],bt=()=>[ye(),ye()],wt=e=>[...e],pt=([e,t])=>e===t,Tt=e=>JSON.stringify(e,((e,t)=>t instanceof Map?ee.fromEntries([...t]):t)),vt=JSON.parse,It=(e,t,s)=>me(e,t,Se(e,t)==-s?void 0:s),yt=()=>{let e,t,s=!1,n=!1,a=0,r=[];const d=ye(),h=ye(),T=ye(),m=ye(),V=ye(),E=ye(),k=ye(),D=ye(),J=ye(),Q=ye(),N=ye(),O=ye(),W=ye(),B=ye(),G=Pe(),K=ye(),U=ye(),Y=ye(),Z=ye(),ee=bt(),te=bt(),se=bt(),ne=bt(),ae=bt(),oe=bt(),le=bt(),de=bt(),ge=bt(),fe=bt(),pe=bt(),Fe=bt(),ze=bt(),je=bt(),Be=bt(),_e=bt(),$e=bt(),Ke=bt(),Xe=bt(),Ye=bt(),Ze=bt(),et=bt(),tt=ye(),st=bt(),[nt,at,ot,rt]=Ge((()=>Hs)),lt=e=>{if(!Le(e,((e,t)=>P([l,i],t))))return!1;const t=e[l];return!(!H(t)&&t!=o||(Qe(e[i])!=t&&ce(e,i),0))},it=(t,s)=>(!e||be(N,s)||$t(s))&&Le(t,((e,t)=>ct(s,t,e)),(()=>$t(s))),ct=(e,t,s,n)=>Le(n?s:ht(s,e,t),((n,a)=>A(dt(e,t,a,n),(e=>(s[a]=e,!0)),(()=>!1))),(()=>$t(e,t))),dt=(t,s,n,a)=>e?A(Se(Se(N,t),n),(e=>Qe(a)!=e[l]?$t(t,s,n,a,e[i]):a),(()=>$t(t,s,n,a))):x(Qe(a))?$t(t,s,n,a):a,ut=(e,t)=>Le(t?e:ft(e),((t,s)=>A(gt(s,t),(t=>(e[s]=t,!0)),(()=>!1))),(()=>qt())),gt=(e,s)=>t?A(Se(W,e),(t=>Qe(s)!=t[l]?qt(e,s,t[i]):s),(()=>qt(e,s))):x(Qe(s))?qt(e,s):s,ht=(e,t,s)=>(A(Se(O,t),(([n,a])=>{ve(n,((t,s)=>{ie(e,s)||(e[s]=t)})),ve(a,(n=>{ie(e,n)||$t(t,s,n)}))})),e),ft=e=>(t&&(ve(B,((t,s)=>{ie(e,s)||(e[s]=t)})),ve(G,(t=>{ie(e,t)||qt(t)}))),e),Lt=e=>Ee(N,e,((e,t,s)=>{const n=ye(),a=Pe();Ee(Ve(N,t,ye),s,((e,t,s)=>{me(e,t,s),A(s[i],(e=>me(n,t,e)),(()=>We(a,t)))})),me(O,t,[n,a])}),((e,t)=>{me(N,t),me(O,t)})),Rt=e=>Ee(W,e,((e,t,s)=>{me(W,t,s),A(s[i],(e=>me(B,t,e)),(()=>We(G,t)))}),((e,t)=>{me(W,t),me(B,t),Ie(G,t)})),St=e=>he(e)?Ss():Ts(e),Mt=e=>Ee(Y,e,((e,t,s)=>mt(t,s)),((e,t)=>Ft(t))),mt=(e,t)=>Ee(Ve(Y,e,(()=>(Ot(e,1),me(K,e,qe()),me(U,e,ye()),ye()))),t,((t,s,n)=>Vt(e,t,s,n)),((t,s)=>Qt(e,t,s))),Vt=(e,t,s,n,a)=>Ee(Ve(t,s,(()=>(Pt(e,s,1),ye()))),n,((t,n,a)=>Et(e,s,t,n,a)),((n,o)=>zt(e,t,s,n,o,a))),Et=(e,t,s,n,a)=>{be(s,n)||Wt(e,t,n,1);const o=Se(s,n);a!==o&&(jt(e,t,n,o,a),me(s,n,a))},kt=(e,t,s,n,a)=>A(Se(t,s),(t=>Et(e,s,t,n,a)),(()=>Vt(e,t,s,ht({[n]:a},e,s)))),Dt=e=>he(e)?Vs():vs(e),xt=e=>Ee(Z,e,((e,t,s)=>At(t,s)),((e,t)=>Nt(t))),At=(e,t)=>{be(Z,e)||Bt(e,1);const s=Se(Z,e);t!==s&&(_t(e,s,t),me(Z,e,t))},Ht=(e,t)=>{const[s]=Se(K,e),n=s(t);return be(Se(Y,e),n)?Ht(e,t):n},Jt=e=>Se(Y,e)??mt(e,{}),Ft=e=>mt(e,{}),Qt=(e,t,s)=>{const[,n]=Se(K,e);n(s),Vt(e,t,s,{},!0)},zt=(e,t,s,n,a,o)=>{const r=Se(Se(O,e)?.[0],a);if(!x(r)&&!o)return Et(e,s,n,a,r);const l=t=>{jt(e,s,t,Se(n,t)),Wt(e,s,t,-1),me(n,t)};x(r)?l(a):Me(n,l),we(n)&&(Pt(e,s,-1),we(me(t,s))&&(Ot(e,-1),me(Y,e),me(K,e),me(U,e)))},Nt=e=>{const t=Se(B,e);if(!x(t))return At(e,t);_t(e,Se(Z,e)),Bt(e,-1),me(Z,e)},Ot=(e,t)=>It(d,e,t),Pt=(e,t,s)=>It(Ve(m,e,ye),t,s)&&me(T,e,Ve(T,e,(()=>0))+s),Wt=(e,t,s,n)=>{const a=Se(U,e),o=Se(a,s)??0;(0==o&&1==n||1==o&&-1==n)&&It(Ve(h,e,ye),s,n),me(a,s,o!=-n?o+n:null),It(Ve(Ve(V,e,ye),t,ye),s,n)},jt=(e,t,s,n,a)=>Ve(Ve(Ve(E,e,ye),t,ye),s,(()=>[n,0]))[1]=a,Bt=(e,t)=>It(k,e,t),_t=(e,t,s)=>Ve(D,e,(()=>[t,0]))[1]=s,$t=(e,t,s,n,a)=>(X(Ve(Ve(Ve(J,e,ye),t,ye),s,(()=>[])),n),a),qt=(e,t,s)=>(X(Ve(Q,e,(()=>[])),t),s),Gt=(e,t,s)=>A(Se(Se(Se(E,e),t),s),(([e,t])=>[!0,e,t]),(()=>[!1,...Ct(cs(e,t,s))])),Kt=e=>A(Se(D,e),(([e,t])=>[!0,e,t]),(()=>[!1,...Ct(gs(e))])),Ut=e=>we(J)||we(_e[e])?0:ve(e?Je(J):J,((t,s)=>ve(t,((t,n)=>ve(t,((t,a)=>at(_e[e],[s,n,a],t))))))),Xt=e=>we(Q)||we($e[e])?0:ve(e?Ae(Q):Q,((t,s)=>at($e[e],[s],t))),Yt=(e,t,s,n)=>{if(!we(e))return at(t,n,(()=>ke(e))),Me(e,((e,t)=>at(s,[...n??[],e],1==t))),1},Zt=e=>{const t=hs();t!=s&&at(ee[e],void 0,t);const n=we(fe[e]),a=we(ze[e])&&we(je[e])&&we(ge[e])&&we(pe[e])&&we(oe[e])&&we(le[e])&&we(de[e])&&n&&we(se[e])&&we(ne[e]),o=we(Be[e])&&we(Fe[e])&&we(ae[e])&&we(te[e]);if(!a||!o){const t=e?[Ae(d),He(h),Ae(T),He(m),Je(V),Je(E)]:[d,h,T,m,V,E];if(!a){Yt(t[0],se[e],ne[e]),ve(t[1],((t,s)=>Yt(t,oe[e],le[e],[s]))),ve(t[2],((t,s)=>{0!=t&&at(de[e],[s],os(s))}));const s=Pe();ve(t[3],((t,a)=>{Yt(t,ge[e],pe[e],[a])&&!n&&(at(fe[e],[a,null]),We(s,a))})),n||ve(t[5],((t,n)=>{if(!be(s,n)){const s=Pe();ve(t,(e=>ve(e,(([t,n],a)=>n!==t?We(s,a):Ie(e,a))))),ve(s,(t=>at(fe[e],[n,t])))}})),ve(t[4],((t,s)=>ve(t,((t,n)=>Yt(t,ze[e],je[e],[s,n])))))}if(!o){let s;ve(t[5],((t,n)=>{let a;ve(t,((t,o)=>{let r;ve(t,(([t,l],i)=>{l!==t&&(at(Be[e],[n,o,i],l,t,Gt),s=a=r=1)})),r&&at(Fe[e],[n,o],Gt)})),a&&at(ae[e],[n],Gt)})),s&&at(te[e],void 0,Gt)}}},es=e=>{const t=ws();t!=n&&at(Ke[e],void 0,t);const s=we(Ye[e])&&we(Ze[e]),a=we(et[e])&&we(Xe[e]);if(!s||!a){const t=e?[Ae(k),Ae(D)]:[k,D];if(s||Yt(t[0],Ye[e],Ze[e]),!a){let s;ve(t[1],(([t,n],a)=>{n!==t&&(at(et[e],[a],n,t,Kt),s=1)})),s&&at(Xe[e],void 0,Kt)}}},ts=(e,...t)=>(Ds((()=>e(...q(t,M)))),Hs),ss=()=>xe(Y),ns=()=>Re(Y),as=e=>Re(Se(U,M(e))),os=e=>Ce(Se(Y,M(e))),rs=e=>Re(Se(Y,M(e))),ls=(e,t,s,n=0,a)=>{return q(z(_((o=Se(Y,M(e)),r=(e,s)=>[x(t)?s:Se(e,M(t)),s],q([...o?.entries()??[]],(([e,t])=>r(t,e)))),(([e],[t])=>Ue(e,t)*(s?-1:1))),n,x(a)?a:n+a),(([,e])=>e));var o,r},is=(e,t)=>Re(Se(Se(Y,M(e)),M(t))),cs=(e,t,s)=>Se(Se(Se(Y,M(e)),M(t)),M(s)),ds=()=>ke(Z),us=()=>Re(Z),gs=e=>Se(Z,M(e)),hs=()=>!we(Y),fs=e=>be(Y,M(e)),Ls=(e,t)=>be(Se(U,M(e)),M(t)),Cs=(e,t)=>be(Se(Y,M(e)),M(t)),bs=(e,t,s)=>be(Se(Se(Y,M(e)),M(t)),M(s)),ws=()=>!we(Z),ps=e=>be(Z,M(e)),Ts=e=>ts((()=>(e=>Le(e,it,$t))(e)?Mt(e):0)),vs=e=>ts((()=>ut(e)?xt(e):0)),Is=e=>{try{St(vt(e))}catch{}return Hs},ys=t=>ts((()=>{if((e=Le(t,(e=>Le(e,lt))))&&(Lt(t),!we(Y))){const e=ss();Ss(),Ts(e)}})),Rs=e=>ts((()=>{if(t=(e=>Le(e,lt))(e)){const s=ds();ks(),Vs(),t=!0,Rt(e),vs(s)}})),Ss=()=>ts((()=>Mt({}))),Ms=e=>ts((e=>be(Y,e)?Ft(e):0),e),ms=(e,t)=>ts(((e,t)=>A(Se(Y,e),(s=>be(s,t)?Qt(e,s,t):0))),e,t),Vs=()=>ts((()=>xt({}))),Es=()=>ts((()=>{Lt({}),e=!1})),ks=()=>ts((()=>{Rt({}),t=!1})),Ds=(e,t)=>{if(-1!=a){xs();const s=e();return As(t),s}},xs=()=>(-1!=a&&a++,1==a&&at(tt,void 0),Hs),As=e=>(a>0&&(a--,0==a&&(a=1,Ut(1),we(E)||Zt(1),Xt(1),we(D)||es(1),e?.(Hs)&&(ve(E,((e,t)=>ve(e,((e,s)=>ve(e,(([e],n)=>Ne(Hs,t,s,n,e))))))),Te(E),ve(D,(([e],t)=>Oe(Hs,t,e))),Te(D)),at(st[0],void 0),a=-1,Ut(0),we(E)||Zt(0),Xt(0),we(D)||es(0),r[0]?.(Hs),at(st[1],void 0),r[1]?.(Hs),a=0,s=hs(),n=ws(),$([d,h,T,m,V,E,J,k,D,Q],Te))),Hs),Hs={getContent:()=>[ss(),ds()],getTables:ss,getTableIds:ns,getTable:e=>De(Se(Y,M(e))),getTableCellIds:as,getRowCount:os,getRowIds:rs,getSortedRowIds:ls,getRow:(e,t)=>ke(Se(Se(Y,M(e)),M(t))),getCellIds:is,getCell:cs,getValues:ds,getValueIds:us,getValue:gs,hasTables:hs,hasTable:fs,hasTableCell:Ls,hasRow:Cs,hasCell:bs,hasValues:ws,hasValue:ps,getTablesJson:()=>Tt(Y),getValuesJson:()=>Tt(Z),getJson:()=>Tt([Y,Z]),getTablesSchemaJson:()=>Tt(N),getValuesSchemaJson:()=>Tt(W),getSchemaJson:()=>Tt([N,W]),hasTablesSchema:()=>e,hasValuesSchema:()=>t,setContent:([e,t])=>ts((()=>{(he(e)?Ss:Ts)(e),(he(t)?Vs:vs)(t)})),setTables:Ts,setTable:(e,t)=>ts((e=>it(t,e)?mt(e,t):0),e),setRow:(e,t,s)=>ts(((e,t)=>ct(e,t,s)?Vt(e,Jt(e),t,s):0),e,t),addRow:(e,t,s=!0)=>Ds((()=>{let n;return ct(e,n,t)&&(e=M(e),Vt(e,Jt(e),n=Ht(e,s?1:0),t)),n})),setPartialRow:(e,t,s)=>ts(((e,t)=>{if(ct(e,t,s,1)){const n=Jt(e);ue(s,((s,a)=>kt(e,n,t,a,s)))}}),e,t),setCell:(e,t,s,n)=>ts(((e,t,s)=>A(dt(e,t,s,F(n)?n(cs(e,t,s)):n),(n=>kt(e,Jt(e),t,s,n)))),e,t,s),setValues:vs,setPartialValues:e=>ts((()=>ut(e,1)?ue(e,((e,t)=>At(t,e))):0)),setValue:(e,t)=>ts((e=>A(gt(e,F(t)?t(gs(e)):t),(t=>At(e,t)))),e),applyChanges:e=>ts((()=>{ue(e[0],((e,t)=>x(e)?Ms(t):ue(e,((e,s)=>x(e)?ms(t,s):ue(e,((e,n)=>Ne(Hs,t,s,n,e))))))),ue(e[1],((e,t)=>Oe(Hs,t,e)))})),setTablesJson:Is,setValuesJson:e=>{try{Dt(vt(e))}catch{}return Hs},setJson:e=>ts((()=>{try{const[t,s]=vt(e);St(t),Dt(s)}catch{Is(e)}})),setTablesSchema:ys,setValuesSchema:Rs,setSchema:(e,t)=>ts((()=>{ys(e),Rs(t)})),delTables:Ss,delTable:Ms,delRow:ms,delCell:(e,t,s,n)=>ts(((e,t,s)=>A(Se(Y,e),(a=>A(Se(a,t),(o=>be(o,s)?zt(e,a,t,o,s,n):0))))),e,t,s),delValues:Vs,delValue:e=>ts((e=>be(Z,e)?Nt(e):0),e),delTablesSchema:Es,delValuesSchema:ks,delSchema:()=>ts((()=>{Es(),ks()})),transaction:Ds,startTransaction:xs,getTransactionChanges:()=>[ke(E,((e,t)=>-1===Se(d,t)?void 0:ke(e,((e,s)=>-1===Se(Se(m,t),s)?void 0:ke(e,(([,e])=>e),(e=>pt(e)))),we,he)),we,he),ke(D,(([,e])=>e),(e=>pt(e))),1],getTransactionLog:()=>[!we(E),!we(D),xe(E,wt,pt),xe(J),ke(D,wt,pt),ke(Q),ke(d),De(m),xe(V),ke(k)],finishTransaction:As,forEachTable:e=>ve(Y,((t,s)=>e(s,(e=>ve(t,((t,s)=>e(s,(e=>Me(t,e))))))))),forEachTableCell:(e,t)=>Me(Se(U,M(e)),t),forEachRow:(e,t)=>ve(Se(Y,M(e)),((e,s)=>t(s,(t=>Me(e,t))))),forEachCell:(e,t,s)=>Me(Se(Se(Y,M(e)),M(t)),s),forEachValue:e=>Me(Z,e),addSortedRowIdsListener:(e,t,s,n,a,o,r)=>{let l=ls(e,t,s,n,a);return nt((()=>{const r=ls(e,t,s,n,a);j(r,l)||(l=r,o(Hs,e,t,s,n,a,l))}),fe[r?1:0],[e,t],[ns])},addStartTransactionListener:e=>nt(e,tt),addWillFinishTransactionListener:e=>nt(e,st[0]),addDidFinishTransactionListener:e=>nt(e,st[1]),callListener:e=>(rt(e),Hs),delListener:e=>(ot(e),Hs),getListenerStats:()=>({}),createStore:yt,addListener:nt,callListeners:at,setInternalListeners:(e,t)=>r=[e,t]};return ue({[g+L]:[0,ee,[],()=>[hs()]],[L]:[0,te],[C]:[0,se],[g+f]:[1,ne,[ns],e=>[fs(...e)]],[f]:[1,ae,[ns]],[f+I]:[1,oe,[ns]],[g+f+v]:[2,le,[ns,as],e=>[Ls(...e)]],[w]:[1,de,[ns]],[p]:[1,ge,[ns]],[g+b]:[2,pe,[ns,rs],e=>[Cs(...e)]],[b]:[2,Fe,[ns,rs]],[I]:[2,ze,[ns,rs]],[g+v]:[3,je,[ns,rs,is],e=>[bs(...e)]],[v]:[3,Be,[ns,rs,is],e=>Ct(cs(...e))],InvalidCell:[3,_e],[g+R]:[0,Ke,[],()=>[ws()]],[R]:[0,Xe],[S]:[0,Ye],[g+y]:[1,Ze,[us],e=>[ps(...e)]],[y]:[1,et,[us],e=>Ct(gs(e[0]))],InvalidValue:[1,$e]},(([e,t,s,n],a)=>{Hs[u+a+c]=(...a)=>nt(a[e],t[a[e+1]?1:0],e>0?z(a,0,e):void 0,s,n)})),re(Hs)},Rt=2**36,St=2**30,Mt=2**24,mt=2**18,Vt=4096,Et=64,kt=e=>String.fromCharCode(48+(63&e)),Dt=(e,t)=>((e,t)=>e.charCodeAt(t))(e,t)-48,xt={HasTable:1,Table:1,TableCellIds:1,HasTableCell:2,RowCount:1,RowIds:1,SortedRowIds:5,HasRow:2,Row:2,CellIds:2,HasCell:3,Cell:3,HasValue:1,Value:1,InvalidCell:3,InvalidValue:1},At=(e="")=>[e,[ht(e),ht(e)],0];e.createCheckpoints=Ke,e.createCustomPersister=(e,t,s,n,a,o,r,l={},i=[])=>{let c,d,u,g=0;Ve(tt,i,(()=>0)),Ve(st,i,(()=>[]));const[h,f,L,C]=((e,t)=>!e||x(t.getMergeableContent)?[0,t.getContent,t.getTransactionChanges,([e,t])=>!he(e)||!he(t)]:[1,t.getMergeableContent,t.getTransactionMergeableChanges,([,[[,e],[,t]]])=>!he(e)||!he(t)])(r,e),b=async e=>(2!=g&&(g=1,await p.schedule((async()=>{await e(),g=0}))),p),w=t=>{(h&&J(t?.[0])?1===t?.[1][2]?e.applyMergeableChanges:e.setMergeableContent:1===t?.[2]?e.applyChanges:e.setContent)(t)},p={load:async(s,n)=>await b((async()=>{try{w(await t())}catch(t){o?.(t),e.setContent([s,n])}})),startAutoLoad:async(e={},s={})=>(await p.stopAutoLoad().load(e,s),d=n((async(e,s)=>{const n=s?.();await b((async()=>{try{w(n??e?.()??await t())}catch(e){o?.(e)}}))})),p),stopAutoLoad:()=>(d&&(a(d),d=void 0),p),isAutoLoading:()=>!x(d),save:async e=>(1!=g&&(g=2,await p.schedule((async()=>{try{await s(f,e)}catch(e){o?.(e)}g=0}))),p),startAutoSave:async()=>(await p.stopAutoSave().save(),u=e.addDidFinishTransactionListener((()=>{const e=L();C(e)&&p.save((()=>e))})),p),stopAutoSave:()=>(A(u,e.delListener),u=void 0,p),isAutoSaving:()=>!x(u),schedule:async(...e)=>(X(Se(st,i),...e),await(async()=>{if(!Se(tt,i)){for(me(tt,i,1);!x(c=Z(Se(st,i)));)try{await c()}catch(e){o?.(e)}me(tt,i,0)}})(),p),getStore:()=>e,destroy:()=>p.stopAutoLoad().stopAutoSave(),getStats:()=>({}),...l};return re(p)},e.createIndexes=Xe,e.createMergeableStore=e=>{let t,n,a=1,o=At();const[r,l]=(e=>{let t=0,s=-1;const n=rt(e),a=e=>{const n=t,[a,o]=x(e)||""==e?[0,0]:[Dt(r=e,0)*Rt+Dt(r,1)*St+Dt(r,2)*Mt+Dt(r,3)*mt+Dt(r,4)*Vt+Dt(r,5)*Et+Dt(r,6),Dt(r,7)*mt+Dt(r,8)*Vt+Dt(r,9)*Et+Dt(r,10),Dt(r,11)*Mt+Dt(r,12)*mt+Dt(r,13)*Vt+Dt(r,14)*Et+Dt(r,15)];var r;t=E(n,a,Date.now()),s=t==n?t==a?E(s,o):s:t==a?o:-1};return[()=>{return a(),o=++s,r=n,kt((e=t)/Rt)+kt(e/St)+kt(e/Mt)+kt(e/mt)+kt(e/Vt)+kt(e/Et)+kt(e)+kt(o/mt)+kt(o/Vt)+kt(o/Et)+kt(o)+kt(r/Mt)+kt(r/mt)+kt(r/Vt)+kt(r/Et)+kt(r);var e,o,r},a]})(e),i=yt(),c=e=>{const t=a;return a=0,e(),a=t,L},d=(e,t=0)=>{const s={},n={},[a,[[r,l,i],c],d]=e,[,[g,h]]=o,[f,L,C]=g;if(r){let e=t?i:C^(r>f?(f?rt(f):0)^rt(r):0);de(l,(([n,a,o],r)=>{const l=Ve(L,r,ht),[i,c,d]=l;let g=t?o:d^(n>i?(i?rt(i):0)^rt(n):0);de(a,((e,n)=>{const[a,o]=u(e,Ve(c,n,ht),fe(fe(s,r,le),n,le),t);g^=t?0:(a?dt(n,a):0)^dt(n,o)})),ut(l,g,n),e^=t?0:(d?dt(r,d):0)^dt(r,l[2])})),ut(g,e,r)}return u(c,h,n,t),ut(o,t?d:g[2]^h[2],a),[s,n,1]},u=(e,t,n,a)=>{const[o,r,l]=e,[i,c,d]=t;if(o){let e=a?l:d^(o>i?(i?rt(i):0)^rt(o):0);de(r,(([t,o,r],l)=>{const i=Ve(c,l,(()=>[s,void 0,0])),[d,,u]=i;t>d&&(ut(i,a?r:rt(Tt(o??null)+":"+t),t),i[1]=o,n[l]=o,e^=a?0:dt(l,u)^dt(l,i[2]))})),ut(t,e,o)}return[d,t[2]]},g=()=>[o[0],[ft(o[1][0],(e=>ft(e,(e=>ft(e))))),ft(o[1][1])],o[2]],h=()=>{if(x(n)){const[,,e,,n]=i.getTransactionLog(),a=he(e)&&he(n)?s:t??(t=r()),o=[a,[gt(he(e)?s:a),gt(he(n)?s:a),1]],[[,l],[,c]]=o[1];return ue(e,((e,t)=>{const[,s]=l[t]=gt(a);ue(e,((e,t)=>{const[,n]=s[t]=gt(a);ue(e,(([,e],t)=>n[t]=[a,e]))}))})),ue(n,(([,e],t)=>c[t]=[a,e])),o}return n},f=e=>c((()=>{l(e[0]),i.applyChanges(d(e))})),L={getId:()=>e,getMergeableContent:g,getMergeableContentHashes:()=>[o[0],[o[1][0][2],o[1][1][2]]],getMergeableTableHashes:()=>ke(o[1][0][1],ct),getMergeableTableIdsDiff:e=>{const t=[];return Me(o[1][0][1],((s,[,,n])=>{n!==e?.[s]&&X(t,s)})),t},getMergeableRowHashes:e=>le(q(e,(e=>[e,ke(Se(o[1][0][1],e)?.[1],ct)]))),getMergeableRowIdsDiff:e=>ge(e,((e,t)=>{const s=[];return Me(Se(o[1][0][1],t)?.[1],((t,[,,n])=>{n!==e?.[t]&&X(s,t)})),s})),getMergeableCellHashes:e=>ge(e,((e,t)=>le(q(e,(e=>[e,ke(Se(Se(o[1][0][1],t)?.[1],e)?.[1],ct)]))))),getMergeableTablesChanges:e=>{const[,[[t,s]]]=o,n={};return de(e,((e,t)=>A(Se(s,t),(([s,a])=>{const o={};de(e,((e,t)=>A(Se(a,t),(([s,n])=>{const a=ke(n,it,(([,,t],s)=>t==e?.[s]));he(a)||(o[t]=[s,a])})))),he(o)||(n[t]=[s,o])})))),[t,n]},getMergeableValuesHashes:()=>ke(o[1][1][1],ct),getMergeableValuesChanges:e=>[o[1][1][0],ke(o[1][1][1],it,(([,,t],s)=>t==e?.[s]))],setMergeableContent:e=>c((()=>(e=>Lt(e,(e=>Q(e)&&2==N(e)&&Lt(e[0],(e=>Le(e,(e=>Lt(e,(e=>Le(e,(e=>Lt(e,(e=>Le(e,(e=>Lt(e,ze)),void 0,1)))),void 0,1)))),void 0,1)))&&Lt(e[1],(e=>Le(e,(e=>Lt(e,ze)),void 0,1))))))(e)?i.transaction((()=>{i.delTables().delValues(),o=At(),l(e[0]),i.applyChanges(d(e,1))})):0)),getTransactionMergeableChanges:h,applyMergeableChanges:f,merge:e=>{const t=g(),s=e.getMergeableContent();return e.applyMergeableChanges(t),f(s)}};return i.setInternalListeners((()=>{a&&(n=h(),d(n))}),(()=>t=n=void 0)),ue(i,((e,t)=>L[t]=m(t,"set")||m(t,"del")||m(t,"apply")||V(t,"Transaction")||"callListener"==t?(...t)=>(e(...t),L):m(t,"add")&&V(t,"Listener")?(...s)=>{const n=xt[z(t,3,-8)]??0,a=s[n];return s[n]=(e,...t)=>a(L,...t),e(...s)}:e)),re(L)},e.createMetrics=et,e.createQueries=nt,e.createRelationships=at,e.createStore=yt,e.defaultSorter=Ue},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBase={});
