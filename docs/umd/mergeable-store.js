var e,t;e=this,t=function(e){"use strict";const t=e=>typeof e,s="",n=t(s),a=t(!0),l=t(0),o=t(t),r="type",c="default",i="Has",d="Ids",u="Table",g=u+"s",h=u+d,f="Row",b=f+"Count",T=f+d,C="Cell",p=C+d,v="Value",V=v+"s",y=v+d,S=e=>s+e,w=(e,t)=>e.startsWith(t),m=(e,t)=>e.endsWith(t),I=(e,t=0)=>e.charCodeAt(t),R=Math.max,L=isFinite,M=e=>null==e,J=(e,t,s)=>M(e)?s?.():t(e),E=e=>e==n||e==a,H=e=>t(e)==o,x=(e,t,s)=>e.slice(t,s),F=e=>e.length,O=(e,t)=>e.forEach(t),z=(e,t)=>e.map(t),A=(e,...t)=>e.push(...t),P=Object,W=e=>P.getPrototypeOf(e),j=P.entries,k=P.keys,D=P.isFrozen,N=P.freeze,B=e=>!M(e)&&J(W(e),(e=>e==P.prototype||M(W(e))),(()=>!0)),$=(e=[])=>P.fromEntries(e),q=(e,t)=>t in e,G=(e,t)=>(delete e[t],e),K=(e,t)=>O(j(e),(([e,s])=>t(s,e))),Q=(e,t)=>z(j(e),(([e,s])=>t(s,e))),U=e=>B(e)&&0==(e=>F(k(e)))(e),X=e=>e?.size??0,Y=(e,t)=>e?.has(t)??!1,Z=e=>M(e)||0==X(e),_=e=>e.clear(),ee=(e,t)=>e?.forEach(t),te=(e,t)=>e?.delete(t),se=e=>new Map(e),ne=e=>[...e?.keys()??[]],ae=(e,t)=>e?.get(t),le=(e,t)=>ee(e,((e,s)=>t(s,e))),oe=(e,t,s)=>M(s)?(te(e,t),e):e?.set(t,s),re=(e,t,s)=>(Y(e,t)||oe(e,t,s()),ae(e,t)),ce=(e,t,s,n=oe)=>(Q(t,((t,n)=>s(e,n,t))),le(e,(s=>q(t,s)?0:n(e,s))),e),ie=(e,t,s)=>{const n={};return ee(e,((e,a)=>{const l=t?t(e,a):e;!s?.(l,e)&&(n[a]=l)})),n},de=(e,t,s)=>ie(e,(e=>ie(e,t,s)),U),ue=(e,t,s)=>ie(e,(e=>de(e,t,s)),U),ge=(e,t)=>{const s=se();return ee(e,((e,n)=>s.set(n,t?.(e)??e))),s},he=e=>ge(e,ge),fe=e=>ge(e,he),be=(e,t,s,n,a=0)=>J((s?re:ae)(e,t[a],a>F(t)-2?s:se),(l=>{if(a>F(t)-2)return n?.(l)&&oe(e,t[a]),l;const o=be(l,t,s,n,a+1);return Z(l)&&oe(e,t[a]),o})),Te=(e="",t)=>[e,t],Ce=(e="")=>Te(e,se()),pe=e=>Te(e,$()),ve=([e,t],s)=>[e,s(t,e)],Ve=([e,t])=>[e,t],ye=(e,t)=>ve(e,(e=>ie(e,t))),Se=(e,t,s,n)=>K(e,((e,a)=>we(e,re(t,a,Ce),s[a]=$(),n))),we=([e,t],s,n,a)=>{e>s[0]&&(s[0]=e),a(t,s[1],n)},me=(e,t,s)=>K(e,(([e,n],a)=>{const l=re(t,a,Te);e>l[0]&&(l[0]=e,l[1]=s[a]=n)})),Ie=e=>new Set(Array.isArray(e)||M(e)?e:[e]),Re=(e,t)=>e?.add(t),Le=/^\d+$/,Me=()=>{const e=[];let t=0;return[n=>(n?e.shift():null)??s+t++,t=>{Le.test(t)&&F(e)<1e3&&A(e,t)}]},Je=e=>[e,e],Ee=()=>[se(),se()],He=e=>[...e],xe=([e,t])=>e===t,Fe=e=>{const s=t(e);return E(s)||s==l&&L(e)?s:void 0},Oe=(e,t,s,n,a)=>M(a)?e.delCell(t,s,n,!0):e.setCell(t,s,n,a),ze=(e,t,s)=>M(s)?e.delValue(t):e.setValue(t,s),Ae=e=>JSON.stringify(e,((e,t)=>t instanceof Map?P.fromEntries([...t]):t)),Pe=JSON.parse,We=(e,t,s)=>M(e)||!B(e)||U(e)||D(e)?(s?.(),!1):(Q(e,((s,n)=>{t(s,n)||G(e,n)})),!U(e)),je=(e,t,s)=>oe(e,t,ae(e,t)==-s?void 0:s),ke=()=>{let e,t,n=!1,a=!1,o=0,d=[];const w=se(),m=se(),I=se(),R=se(),L=se(),P=se(),W=se(),j=se(),k=se(),D=se(),B=se(),$=se(),K=se(),Te=se(),Ce=Ie(),pe=se(),ve=se(),Ve=se(),ye=se(),Se=Ee(),we=Ee(),me=Ee(),Le=Ee(),De=Ee(),Ne=Ee(),Be=Ee(),$e=Ee(),qe=Ee(),Ge=Ee(),Ke=Ee(),Qe=Ee(),Ue=Ee(),Xe=Ee(),Ye=Ee(),Ze=Ee(),_e=Ee(),et=Ee(),tt=Ee(),st=Ee(),nt=Ee(),at=Ee(),lt=se(),ot=Ee(),[rt,ct,it,dt]=(e=>{let t;const[n,a]=Me(),l=se();return[(e,a,o,r=[],c=(()=>[]))=>{t??=Es;const i=n(1);return oe(l,i,[e,a,o,r,c]),Re(be(a,o??[s],Ie),i),i},(e,n,...a)=>O(((e,t=[s])=>{const n=[],a=(e,s)=>s==F(t)?A(n,e):null===t[s]?ee(e,(e=>a(e,s+1))):O([t[s],null],(t=>a(ae(e,t),s+1)));return a(e,0),n})(e,n),(e=>ee(e,(e=>ae(l,e)[0](t,...n??[],...a))))),e=>J(ae(l,e),(([,t,n])=>(be(t,n??[s],void 0,(t=>(te(t,e),Z(t)?1:0))),oe(l,e),a(e),n))),e=>J(ae(l,e),(([e,,s=[],n,a])=>{const l=(...o)=>{const r=F(o);r==F(s)?e(t,...o,...a(o)):M(s[r])?O(n[r]?.(...o)??[],(e=>l(...o,e))):l(...o,s[r])};l()}))]})(),ut=e=>{if(!We(e,((e,t)=>[r,c].includes(t))))return!1;const t=e[r];return!(!E(t)&&t!=l||(Fe(e[c])!=t&&G(e,c),0))},gt=(t,s)=>(!e||Y(B,s)||Nt(s))&&We(t,((e,t)=>ht(s,t,e)),(()=>Nt(s))),ht=(e,t,s,n)=>We(n?s:Ct(s,e,t),((n,a)=>J(ft(e,t,a,n),(e=>(s[a]=e,!0)),(()=>!1))),(()=>Nt(e,t))),ft=(t,s,n,a)=>e?J(ae(ae(B,t),n),(e=>Fe(a)!=e[r]?Nt(t,s,n,a,e[c]):a),(()=>Nt(t,s,n,a))):M(Fe(a))?Nt(t,s,n,a):a,bt=(e,t)=>We(t?e:pt(e),((t,s)=>J(Tt(s,t),(t=>(e[s]=t,!0)),(()=>!1))),(()=>Bt())),Tt=(e,s)=>t?J(ae(K,e),(t=>Fe(s)!=t[r]?Bt(e,s,t[c]):s),(()=>Bt(e,s))):M(Fe(s))?Bt(e,s):s,Ct=(e,t,s)=>(J(ae($,t),(([n,a])=>{ee(n,((t,s)=>{q(e,s)||(e[s]=t)})),ee(a,(n=>{q(e,n)||Nt(t,s,n)}))})),e),pt=e=>(t&&(ee(Te,((t,s)=>{q(e,s)||(e[s]=t)})),ee(Ce,(t=>{q(e,t)||Bt(t)}))),e),vt=e=>ce(B,e,((e,t,s)=>{const n=se(),a=Ie();ce(re(B,t,se),s,((e,t,s)=>{oe(e,t,s),J(s[c],(e=>oe(n,t,e)),(()=>Re(a,t)))})),oe($,t,[n,a])}),((e,t)=>{oe(B,t),oe($,t)})),Vt=e=>ce(K,e,((e,t,s)=>{oe(K,t,s),J(s[c],(e=>oe(Te,t,e)),(()=>Re(Ce,t)))}),((e,t)=>{oe(K,t),oe(Te,t),te(Ce,t)})),yt=e=>U(e)?ys():Ts(e),St=e=>ce(Ve,e,((e,t,s)=>wt(t,s)),((e,t)=>xt(t))),wt=(e,t)=>ce(re(Ve,e,(()=>(At(e,1),oe(pe,e,Me()),oe(ve,e,se()),se()))),t,((t,s,n)=>mt(e,t,s,n)),((t,s)=>Ft(e,t,s))),mt=(e,t,s,n,a)=>ce(re(t,s,(()=>(Pt(e,s,1),se()))),n,((t,n,a)=>It(e,s,t,n,a)),((n,l)=>Ot(e,t,s,n,l,a))),It=(e,t,s,n,a)=>{Y(s,n)||Wt(e,t,n,1);const l=ae(s,n);a!==l&&(jt(e,t,n,l,a),oe(s,n,a))},Rt=(e,t,s,n,a)=>J(ae(t,s),(t=>It(e,s,t,n,a)),(()=>mt(e,t,s,Ct({[n]:a},e,s)))),Lt=e=>U(e)?ms():Cs(e),Mt=e=>ce(ye,e,((e,t,s)=>Jt(t,s)),((e,t)=>zt(t))),Jt=(e,t)=>{Y(ye,e)||kt(e,1);const s=ae(ye,e);t!==s&&(Dt(e,s,t),oe(ye,e,t))},Et=(e,t)=>{const[s]=ae(pe,e),n=s(t);return Y(ae(Ve,e),n)?Et(e,t):n},Ht=e=>ae(Ve,e)??wt(e,{}),xt=e=>wt(e,{}),Ft=(e,t,s)=>{const[,n]=ae(pe,e);n(s),mt(e,t,s,{},!0)},Ot=(e,t,s,n,a,l)=>{const o=ae(ae($,e)?.[0],a);if(!M(o)&&!l)return It(e,s,n,a,o);const r=t=>{jt(e,s,t,ae(n,t)),Wt(e,s,t,-1),oe(n,t)};M(o)?r(a):le(n,r),Z(n)&&(Pt(e,s,-1),Z(oe(t,s))&&(At(e,-1),oe(Ve,e),oe(pe,e),oe(ve,e)))},zt=e=>{const t=ae(Te,e);if(!M(t))return Jt(e,t);Dt(e,ae(ye,e)),kt(e,-1),oe(ye,e)},At=(e,t)=>je(w,e,t),Pt=(e,t,s)=>je(re(R,e,se),t,s)&&oe(I,e,re(I,e,(()=>0))+s),Wt=(e,t,s,n)=>{const a=ae(ve,e),l=ae(a,s)??0;(0==l&&1==n||1==l&&-1==n)&&je(re(m,e,se),s,n),oe(a,s,l!=-n?l+n:null),je(re(re(L,e,se),t,se),s,n)},jt=(e,t,s,n,a)=>re(re(re(P,e,se),t,se),s,(()=>[n,0]))[1]=a,kt=(e,t)=>je(W,e,t),Dt=(e,t,s)=>re(j,e,(()=>[t,0]))[1]=s,Nt=(e,t,s,n,a)=>(A(re(re(re(k,e,se),t,se),s,(()=>[])),n),a),Bt=(e,t,s)=>(A(re(D,e,(()=>[])),t),s),$t=(e,t,s)=>J(ae(ae(ae(P,e),t),s),(([e,t])=>[!0,e,t]),(()=>[!1,...Je(ls(e,t,s))])),qt=e=>J(ae(j,e),(([e,t])=>[!0,e,t]),(()=>[!1,...Je(cs(e))])),Gt=e=>Z(k)||Z(Ze[e])?0:ee(e?fe(k):k,((t,s)=>ee(t,((t,n)=>ee(t,((t,a)=>ct(Ze[e],[s,n,a],t))))))),Kt=e=>Z(D)||Z(_e[e])?0:ee(e?ge(D):D,((t,s)=>ct(_e[e],[s],t))),Qt=(e,t,s,n)=>{if(!Z(e))return ct(t,n,(()=>ie(e))),le(e,((e,t)=>ct(s,[...n??[],e],1==t))),1},Ut=e=>{const t=is();t!=n&&ct(Se[e],void 0,t);const s=Z(Ge[e]),a=Z(Ue[e])&&Z(Xe[e])&&Z(qe[e])&&Z(Ke[e])&&Z(Ne[e])&&Z(Be[e])&&Z($e[e])&&s&&Z(me[e])&&Z(Le[e]),l=Z(Ye[e])&&Z(Qe[e])&&Z(De[e])&&Z(we[e]);if(!a||!l){const t=e?[ge(w),he(m),ge(I),he(R),fe(L),fe(P)]:[w,m,I,R,L,P];if(!a){Qt(t[0],me[e],Le[e]),ee(t[1],((t,s)=>Qt(t,Ne[e],Be[e],[s]))),ee(t[2],((t,s)=>{0!=t&&ct($e[e],[s],ts(s))}));const n=Ie();ee(t[3],((t,a)=>{Qt(t,qe[e],Ke[e],[a])&&!s&&(ct(Ge[e],[a,null]),Re(n,a))})),s||ee(t[5],((t,s)=>{if(!Y(n,s)){const n=Ie();ee(t,(e=>ee(e,(([t,s],a)=>s!==t?Re(n,a):te(e,a))))),ee(n,(t=>ct(Ge[e],[s,t])))}})),ee(t[4],((t,s)=>ee(t,((t,n)=>Qt(t,Ue[e],Xe[e],[s,n])))))}if(!l){let s;ee(t[5],((t,n)=>{let a;ee(t,((t,l)=>{let o;ee(t,(([t,r],c)=>{r!==t&&(ct(Ye[e],[n,l,c],r,t,$t),s=a=o=1)})),o&&ct(Qe[e],[n,l],$t)})),a&&ct(De[e],[n],$t)})),s&&ct(we[e],void 0,$t)}}},Xt=e=>{const t=fs();t!=a&&ct(et[e],void 0,t);const s=Z(st[e])&&Z(nt[e]),n=Z(at[e])&&Z(tt[e]);if(!s||!n){const t=e?[ge(W),ge(j)]:[W,j];if(s||Qt(t[0],st[e],nt[e]),!n){let s;ee(t[1],(([t,n],a)=>{n!==t&&(ct(at[e],[a],n,t,qt),s=1)})),s&&ct(tt[e],void 0,qt)}}},Yt=(e,...t)=>(Ls((()=>e(...z(t,S)))),Es),Zt=()=>ue(Ve),_t=()=>ne(Ve),es=e=>ne(ae(ve,S(e))),ts=e=>X(ae(Ve,S(e))),ss=e=>ne(ae(Ve,S(e))),ns=(e,t,s,n=0,a)=>{return z(x((o=ae(Ve,S(e)),r=(e,s)=>[M(t)?s:ae(e,S(t)),s],l=([e],[t])=>((e??0)<(t??0)?-1:1)*(s?-1:1),z([...o?.entries()??[]],(([e,t])=>r(t,e))).sort(l)),n,M(a)?a:n+a),(([,e])=>e));var l,o,r},as=(e,t)=>ne(ae(ae(Ve,S(e)),S(t))),ls=(e,t,s)=>ae(ae(ae(Ve,S(e)),S(t)),S(s)),os=()=>ie(ye),rs=()=>ne(ye),cs=e=>ae(ye,S(e)),is=()=>!Z(Ve),ds=e=>Y(Ve,S(e)),us=(e,t)=>Y(ae(ve,S(e)),S(t)),gs=(e,t)=>Y(ae(Ve,S(e)),S(t)),hs=(e,t,s)=>Y(ae(ae(Ve,S(e)),S(t)),S(s)),fs=()=>!Z(ye),bs=e=>Y(ye,S(e)),Ts=e=>Yt((()=>(e=>We(e,gt,Nt))(e)?St(e):0)),Cs=e=>Yt((()=>bt(e)?Mt(e):0)),ps=e=>{try{yt(Pe(e))}catch{}return Es},vs=t=>Yt((()=>{if((e=We(t,(e=>We(e,ut))))&&(vt(t),!Z(Ve))){const e=Zt();ys(),Ts(e)}})),Vs=e=>Yt((()=>{if(t=(e=>We(e,ut))(e)){const s=os();Rs(),ms(),t=!0,Vt(e),Cs(s)}})),ys=()=>Yt((()=>St({}))),Ss=e=>Yt((e=>Y(Ve,e)?xt(e):0),e),ws=(e,t)=>Yt(((e,t)=>J(ae(Ve,e),(s=>Y(s,t)?Ft(e,s,t):0))),e,t),ms=()=>Yt((()=>Mt({}))),Is=()=>Yt((()=>{vt({}),e=!1})),Rs=()=>Yt((()=>{Vt({}),t=!1})),Ls=(e,t)=>{if(-1!=o){Ms();const s=e();return Js(t),s}},Ms=()=>(-1!=o&&o++,1==o&&ct(lt,void 0),Es),Js=e=>(o>0&&(o--,0==o&&(o=1,Gt(1),Z(P)||Ut(1),Kt(1),Z(j)||Xt(1),e?.(Es)&&(ee(P,((e,t)=>ee(e,((e,s)=>ee(e,(([e],n)=>Oe(Es,t,s,n,e))))))),_(P),ee(j,(([e],t)=>ze(Es,t,e))),_(j)),ct(ot[0],void 0),o=-1,Gt(0),Z(P)||Ut(0),Kt(0),Z(j)||Xt(0),d[0]?.(Es),ct(ot[1],void 0),d[1]?.(Es),o=0,n=is(),a=fs(),O([w,m,I,R,L,P,k,W,j,D],_))),Es),Es={getContent:()=>[Zt(),os()],getTables:Zt,getTableIds:_t,getTable:e=>de(ae(Ve,S(e))),getTableCellIds:es,getRowCount:ts,getRowIds:ss,getSortedRowIds:ns,getRow:(e,t)=>ie(ae(ae(Ve,S(e)),S(t))),getCellIds:as,getCell:ls,getValues:os,getValueIds:rs,getValue:cs,hasTables:is,hasTable:ds,hasTableCell:us,hasRow:gs,hasCell:hs,hasValues:fs,hasValue:bs,getTablesJson:()=>Ae(Ve),getValuesJson:()=>Ae(ye),getJson:()=>Ae([Ve,ye]),getTablesSchemaJson:()=>Ae(B),getValuesSchemaJson:()=>Ae(K),getSchemaJson:()=>Ae([B,K]),hasTablesSchema:()=>e,hasValuesSchema:()=>t,setContent:([e,t])=>Yt((()=>{(U(e)?ys:Ts)(e),(U(t)?ms:Cs)(t)})),setTables:Ts,setTable:(e,t)=>Yt((e=>gt(t,e)?wt(e,t):0),e),setRow:(e,t,s)=>Yt(((e,t)=>ht(e,t,s)?mt(e,Ht(e),t,s):0),e,t),addRow:(e,t,s=!0)=>Ls((()=>{let n;return ht(e,n,t)&&(e=S(e),mt(e,Ht(e),n=Et(e,s?1:0),t)),n})),setPartialRow:(e,t,s)=>Yt(((e,t)=>{if(ht(e,t,s,1)){const n=Ht(e);Q(s,((s,a)=>Rt(e,n,t,a,s)))}}),e,t),setCell:(e,t,s,n)=>Yt(((e,t,s)=>J(ft(e,t,s,H(n)?n(ls(e,t,s)):n),(n=>Rt(e,Ht(e),t,s,n)))),e,t,s),setValues:Cs,setPartialValues:e=>Yt((()=>bt(e,1)?Q(e,((e,t)=>Jt(t,e))):0)),setValue:(e,t)=>Yt((e=>J(Tt(e,H(t)?t(cs(e)):t),(t=>Jt(e,t)))),e),applyChanges:e=>Yt((()=>{Q(e[0],((e,t)=>M(e)?Ss(t):Q(e,((e,s)=>M(e)?ws(t,s):Q(e,((e,n)=>Oe(Es,t,s,n,e))))))),Q(e[1],((e,t)=>ze(Es,t,e)))})),setTablesJson:ps,setValuesJson:e=>{try{Lt(Pe(e))}catch{}return Es},setJson:e=>Yt((()=>{try{const[t,s]=Pe(e);yt(t),Lt(s)}catch{ps(e)}})),setTablesSchema:vs,setValuesSchema:Vs,setSchema:(e,t)=>Yt((()=>{vs(e),Vs(t)})),delTables:ys,delTable:Ss,delRow:ws,delCell:(e,t,s,n)=>Yt(((e,t,s)=>J(ae(Ve,e),(a=>J(ae(a,t),(l=>Y(l,s)?Ot(e,a,t,l,s,n):0))))),e,t,s),delValues:ms,delValue:e=>Yt((e=>Y(ye,e)?zt(e):0),e),delTablesSchema:Is,delValuesSchema:Rs,delSchema:()=>Yt((()=>{Is(),Rs()})),transaction:Ls,startTransaction:Ms,getTransactionChanges:()=>[ie(P,((e,t)=>-1===ae(w,t)?void 0:ie(e,((e,s)=>-1===ae(ae(R,t),s)?void 0:ie(e,(([,e])=>e),((e,t)=>xe(t)))),U)),U),ie(j,(([,e])=>e),((e,t)=>xe(t)))],getTransactionLog:()=>[!Z(P),!Z(j),ue(P,He,xe),ue(k),ie(j,He,xe),ie(D),ie(w),de(R),ue(L),ie(W)],finishTransaction:Js,forEachTable:e=>ee(Ve,((t,s)=>e(s,(e=>ee(t,((t,s)=>e(s,(e=>le(t,e))))))))),forEachTableCell:(e,t)=>le(ae(ve,S(e)),t),forEachRow:(e,t)=>ee(ae(Ve,S(e)),((e,s)=>t(s,(t=>le(e,t))))),forEachCell:(e,t,s)=>le(ae(ae(Ve,S(e)),S(t)),s),forEachValue:e=>le(ye,e),addSortedRowIdsListener:(e,t,s,n,a,l,o)=>{let r=ns(e,t,s,n,a);return rt((()=>{const o=ns(e,t,s,n,a);var c,i,d;i=r,F(c=o)===F(i)&&(d=(e,t)=>i[t]===e,c.every(d))||(r=o,l(Es,e,t,s,n,a,r))}),Ge[o?1:0],[e,t],[_t])},addStartTransactionListener:e=>rt(e,lt),addWillFinishTransactionListener:e=>rt(e,ot[0]),addDidFinishTransactionListener:e=>rt(e,ot[1]),callListener:e=>(dt(e),Es),delListener:e=>(it(e),Es),getListenerStats:()=>({}),createStore:ke,addListener:rt,callListeners:ct,setInternalListeners:(e,t)=>d=[e,t]};return Q({[i+g]:[0,Se,[],()=>[is()]],[g]:[0,we],[h]:[0,me],[i+u]:[1,Le,[_t],e=>[ds(...e)]],[u]:[1,De,[_t]],[u+p]:[1,Ne,[_t]],[i+u+C]:[2,Be,[_t,es],e=>[us(...e)]],[b]:[1,$e,[_t]],[T]:[1,qe,[_t]],[i+f]:[2,Ke,[_t,ss],e=>[gs(...e)]],[f]:[2,Qe,[_t,ss]],[p]:[2,Ue,[_t,ss]],[i+C]:[3,Xe,[_t,ss,as],e=>[hs(...e)]],[C]:[3,Ye,[_t,ss,as],e=>Je(ls(...e))],InvalidCell:[3,Ze],[i+V]:[0,et,[],()=>[fs()]],[V]:[0,tt],[y]:[0,st],[i+v]:[1,nt,[rs],e=>[bs(...e)]],[v]:[1,at,[rs],e=>Je(cs(e[0]))],InvalidValue:[1,_e]},(([e,t,s,n],a)=>{Es["add"+a+"Listener"]=(...a)=>rt(a[e],t[a[e+1]?1:0],e>0?x(a,0,e):void 0,s,n)})),N(Es)},De=2**36,Ne=2**30,Be=2**24,$e=2**18,qe=4096,Ge=64,Ke=e=>String.fromCharCode(48+(63&e)),Qe=(e,t)=>I(e,t)-48,Ue={HasTable:1,Table:1,TableCellIds:1,HasTableCell:2,RowCount:1,RowIds:1,SortedRowIds:5,HasRow:2,Row:2,CellIds:2,HasCell:3,Cell:3,HasValue:1,Value:1,InvalidCell:3,InvalidValue:1},Xe=(e="")=>[e,[Ce(e),Ce(e)]];e.createMergeableStore=e=>{let t,n,a=1,l=Xe();const[o,r]=(e=>{let t=0,s=-1;const n=(a=(e,t)=>(e<<5)+e^I(t),((e,t="",s)=>e.split(t,s))(e).reduce(a,5381)>>>0);var a;const l=e=>{const n=t,[a,l]=M(e)?[0,0]:[Qe(o=e,0)*De+Qe(o,1)*Ne+Qe(o,2)*Be+Qe(o,3)*$e+Qe(o,4)*qe+Qe(o,5)*Ge+Qe(o,6),Qe(o,7)*$e+Qe(o,8)*qe+Qe(o,9)*Ge+Qe(o,10),Qe(o,11)*Be+Qe(o,12)*$e+Qe(o,13)*qe+Qe(o,14)*Ge+Qe(o,15)];var o;t=R(n,a,Date.now()),s=t==n?t==a?R(s,l):s:t==a?l:-1};return[()=>{return l(),a=++s,o=n,Ke((e=t)/De)+Ke(e/Ne)+Ke(e/Be)+Ke(e/$e)+Ke(e/qe)+Ke(e/Ge)+Ke(e)+Ke(a/$e)+Ke(a/qe)+Ke(a/Ge)+Ke(a)+Ke(o/Be)+Ke(o/$e)+Ke(o/qe)+Ke(o/Ge)+Ke(o);var e,a,o},l]})(e),c=ke(),i=e=>{const t=a;a=0,e(),a=t},d=()=>{if(M(n)){const[,,e,,n]=c.getTransactionLog(),a=U(e)&&U(n)?s:t??(t=o()),l=Te(a,[pe(U(e)?s:a),pe(U(n)?s:a)]),[[,r],[,i]]=l[1];return Q(e,((e,t)=>{const[,s]=r[t]=pe(a);Q(e,((e,t)=>{const[,n]=s[t]=pe(a);Q(e,(([,e],t)=>n[t]=Te(a,e)))}))})),Q(n,(([,e],t)=>i[t]=Te(a,e))),l}return n},u=e=>{const t=[{},{}];return r(e[0]),we(e,l,t,(([e,t],[s,n],[a,l])=>{we(e,s,a,((e,t,s)=>Se(e,t,s,((e,t,s)=>Se(e,t,s,me))))),we(t,n,l,me)})),i((()=>c.applyChanges(t))),g},g={getMergeableContent:()=>ve(l,(([e,t])=>[ye(e,(e=>ye(e,(e=>ye(e,Ve))))),ye(t,Ve)])),setMergeableContent:e=>(i((()=>c.transaction((()=>{c.delTables().delValues(),l=Xe()})))),u(e),g),getTransactionMergeableChanges:d,applyMergeableChanges:u,merge:e=>{const t=g.getMergeableContent(),s=e.getMergeableContent();return e.applyMergeableChanges(t),u(s)}};return c.setInternalListeners((()=>{if(a){n=d();const[e,[t,s]]=n,a=!U(t[1]),o=!U(s[1]),[,[r,c]]=l;(a||o)&&(l[0]=e),a&&(r[0]=e,Q(t[1],(([,t],s)=>{const n=re(r[1],s,Ce);n[0]=e,Q(t,(([,t],s)=>{const a=re(n[1],s,Ce);a[0]=e,Q(t,(([,t],s)=>oe(a[1],s,Te(e,t))))}))}))),o&&(c[0]=e,Q(s[1],(([,t],s)=>oe(c[1],s,Te(e,t)))))}}),(()=>t=n=void 0)),Q(c,((e,t)=>g[t]=w(t,"set")||w(t,"del")||w(t,"apply")||m(t,"Transaction")||"callListener"==t?(...t)=>(e(...t),g):w(t,"add")&&m(t,"Listener")?(...s)=>{const n=Ue[x(t,3,-8)]??0,a=s[n];return s[n]=(e,...t)=>a(g,...t),e(...s)}:e)),N(g)}},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseMergeableStore={});
