var e,t;e=this,t=function(e){"use strict";const t=e=>typeof e,s="",n=t(s),a=t(!0),l=t(0),o=t(t),r="type",i="default",c="Has",d="Ids",u="Table",f=u+"s",h=u+d,g="Row",T=g+"Count",b=g+d,S="Cell",V=S+d,p="Value",v=p+"s",y=p+d,C=e=>s+e,m=isFinite,w=e=>null==e,L=(e,t,s)=>w(e)?s?.():t(e),R=e=>e==n||e==a,I=e=>t(e)==o,J=(e,t,s)=>e.slice(t,s),E=e=>e.length,F=(e,t)=>e.forEach(t),O=(e,t)=>e.map(t),x=(e,...t)=>e.push(...t),z=Object,P=e=>z.getPrototypeOf(e),j=z.entries,k=z.isFrozen,A=e=>!w(e)&&L(P(e),(e=>e==z.prototype||w(P(e))),(()=>!0)),M=z.keys,N=z.freeze,B=(e,t)=>t in e,D=(e,t)=>(delete e[t],e),H=(e,t)=>O(j(e),(([e,s])=>t(s,e))),W=e=>A(e)&&0==(e=>E(M(e)))(e),$=(e,t,s,n=0)=>w(e)||!A(e)||!n&&W(e)||k(e)?(s?.(),!1):(H(e,((s,n)=>{t(s,n)||D(e,n)})),!!n||!W(e)),q=e=>e?.size??0,G=(e,t)=>e?.has(t)??!1,K=e=>w(e)||0==q(e),Q=e=>e.clear(),U=(e,t)=>e?.forEach(t),X=(e,t)=>e?.delete(t),Y=e=>new Map(e),Z=e=>[...e?.keys()??[]],_=(e,t)=>e?.get(t),ee=(e,t)=>U(e,((e,s)=>t(s,e))),te=(e,t,s)=>w(s)?(X(e,t),e):e?.set(t,s),se=(e,t,s,n)=>(G(e,t)?n?.(_(e,t)):te(e,t,s()),_(e,t)),ne=(e,t,s,n=te)=>(H(t,((t,n)=>s(e,n,t))),ee(e,(s=>B(t,s)?0:n(e,s))),e),ae=(e,t,s,n)=>{const a={};return U(e,((e,l)=>{if(!s?.(e,l)){const s=t?t(e,l):e;!n?.(s)&&(a[l]=s)}})),a},le=(e,t,s)=>ae(e,(e=>ae(e,t,s)),K,W),oe=(e,t,s)=>ae(e,(e=>le(e,t,s)),K,W),re=(e,t)=>{const s=Y();return U(e,((e,n)=>s.set(n,t?.(e)??e))),s},ie=e=>re(e,re),ce=e=>re(e,ie),de=(e,t,s,n,a=0)=>L((s?se:_)(e,t[a],a>E(t)-2?s:Y),(l=>{if(a>E(t)-2)return n?.(l)&&te(e,t[a]),l;const o=de(l,t,s,n,a+1);return K(l)&&te(e,t[a]),o})),ue=e=>new Set(Array.isArray(e)||w(e)?e:[e]),fe=(e,t)=>e?.add(t),he=/^\d+$/,ge=()=>{const e=[];let t=0;return[n=>(n?e.shift():null)??s+t++,t=>{he.test(t)&&E(e)<1e3&&x(e,t)}]},Te=e=>[e,e],be=()=>[Y(),Y()],Se=e=>[...e],Ve=([e,t])=>e===t,pe=e=>{const s=t(e);return R(s)||s==l&&m(e)?s:void 0},ve=(e,t,s,n,a)=>w(a)?e.delCell(t,s,n,!0):e.setCell(t,s,n,a),ye=(e,t,s)=>w(s)?e.delValue(t):e.setValue(t,s),Ce=e=>JSON.stringify(e,((e,t)=>t instanceof Map?z.fromEntries([...t]):t)),me=JSON.parse,we=(e,t,s)=>te(e,t,_(e,t)==-s?void 0:s),Le=()=>{let e,t,n=!1,a=!1,o=0,d=[];const m=Y(),z=Y(),P=Y(),j=Y(),k=Y(),A=Y(),M=Y(),he=Y(),Re=Y(),Ie=Y(),Je=Y(),Ee=Y(),Fe=Y(),Oe=Y(),xe=ue(),ze=Y(),Pe=Y(),je=Y(),ke=Y(),Ae=be(),Me=be(),Ne=be(),Be=be(),De=be(),He=be(),We=be(),$e=be(),qe=be(),Ge=be(),Ke=be(),Qe=be(),Ue=be(),Xe=be(),Ye=be(),Ze=be(),_e=be(),et=be(),tt=be(),st=be(),nt=be(),at=be(),lt=Y(),ot=be(),[rt,it,ct,dt]=(e=>{let t;const[n,a]=ge(),l=Y();return[(e,a,o,r=[],i=(()=>[]))=>{t??=Fs;const c=n(1);return te(l,c,[e,a,o,r,i]),fe(de(a,o??[s],ue),c),c},(e,n,...a)=>F(((e,t=[s])=>{const n=[],a=(e,s)=>s==E(t)?x(n,e):null===t[s]?U(e,(e=>a(e,s+1))):F([t[s],null],(t=>a(_(e,t),s+1)));return a(e,0),n})(e,n),(e=>U(e,(e=>_(l,e)[0](t,...n??[],...a))))),e=>L(_(l,e),(([,t,n])=>(de(t,n??[s],void 0,(t=>(X(t,e),K(t)?1:0))),te(l,e),a(e),n))),e=>L(_(l,e),(([e,,s=[],n,a])=>{const l=(...o)=>{const r=E(o);r==E(s)?e(t,...o,...a(o)):w(s[r])?F(n[r]?.(...o)??[],(e=>l(...o,e))):l(...o,s[r])};l()}))]})(),ut=e=>{if(!$(e,((e,t)=>[r,i].includes(t))))return!1;const t=e[r];return!(!R(t)&&t!=l||(pe(e[i])!=t&&D(e,i),0))},ft=(t,s)=>(!e||G(Je,s)||Ht(s))&&$(t,((e,t)=>ht(s,t,e)),(()=>Ht(s))),ht=(e,t,s,n)=>$(n?s:St(s,e,t),((n,a)=>L(gt(e,t,a,n),(e=>(s[a]=e,!0)),(()=>!1))),(()=>Ht(e,t))),gt=(t,s,n,a)=>e?L(_(_(Je,t),n),(e=>pe(a)!=e[r]?Ht(t,s,n,a,e[i]):a),(()=>Ht(t,s,n,a))):w(pe(a))?Ht(t,s,n,a):a,Tt=(e,t)=>$(t?e:Vt(e),((t,s)=>L(bt(s,t),(t=>(e[s]=t,!0)),(()=>!1))),(()=>Wt())),bt=(e,s)=>t?L(_(Fe,e),(t=>pe(s)!=t[r]?Wt(e,s,t[i]):s),(()=>Wt(e,s))):w(pe(s))?Wt(e,s):s,St=(e,t,s)=>(L(_(Ee,t),(([n,a])=>{U(n,((t,s)=>{B(e,s)||(e[s]=t)})),U(a,(n=>{B(e,n)||Ht(t,s,n)}))})),e),Vt=e=>(t&&(U(Oe,((t,s)=>{B(e,s)||(e[s]=t)})),U(xe,(t=>{B(e,t)||Wt(t)}))),e),pt=e=>ne(Je,e,((e,t,s)=>{const n=Y(),a=ue();ne(se(Je,t,Y),s,((e,t,s)=>{te(e,t,s),L(s[i],(e=>te(n,t,e)),(()=>fe(a,t)))})),te(Ee,t,[n,a])}),((e,t)=>{te(Je,t),te(Ee,t)})),vt=e=>ne(Fe,e,((e,t,s)=>{te(Fe,t,s),L(s[i],(e=>te(Oe,t,e)),(()=>fe(xe,t)))}),((e,t)=>{te(Fe,t),te(Oe,t),X(xe,t)})),yt=e=>W(e)?ys():bs(e),Ct=e=>ne(je,e,((e,t,s)=>mt(t,s)),((e,t)=>xt(t))),mt=(e,t)=>ne(se(je,e,(()=>(kt(e,1),te(ze,e,ge()),te(Pe,e,Y()),Y()))),t,((t,s,n)=>wt(e,t,s,n)),((t,s)=>zt(e,t,s))),wt=(e,t,s,n,a)=>ne(se(t,s,(()=>(At(e,s,1),Y()))),n,((t,n,a)=>Lt(e,s,t,n,a)),((n,l)=>Pt(e,t,s,n,l,a))),Lt=(e,t,s,n,a)=>{G(s,n)||Mt(e,t,n,1);const l=_(s,n);a!==l&&(Nt(e,t,n,l,a),te(s,n,a))},Rt=(e,t,s,n,a)=>L(_(t,s),(t=>Lt(e,s,t,n,a)),(()=>wt(e,t,s,St({[n]:a},e,s)))),It=e=>W(e)?ws():Ss(e),Jt=e=>ne(ke,e,((e,t,s)=>Et(t,s)),((e,t)=>jt(t))),Et=(e,t)=>{G(ke,e)||Bt(e,1);const s=_(ke,e);t!==s&&(Dt(e,s,t),te(ke,e,t))},Ft=(e,t)=>{const[s]=_(ze,e),n=s(t);return G(_(je,e),n)?Ft(e,t):n},Ot=e=>_(je,e)??mt(e,{}),xt=e=>mt(e,{}),zt=(e,t,s)=>{const[,n]=_(ze,e);n(s),wt(e,t,s,{},!0)},Pt=(e,t,s,n,a,l)=>{const o=_(_(Ee,e)?.[0],a);if(!w(o)&&!l)return Lt(e,s,n,a,o);const r=t=>{Nt(e,s,t,_(n,t)),Mt(e,s,t,-1),te(n,t)};w(o)?r(a):ee(n,r),K(n)&&(At(e,s,-1),K(te(t,s))&&(kt(e,-1),te(je,e),te(ze,e),te(Pe,e)))},jt=e=>{const t=_(Oe,e);if(!w(t))return Et(e,t);Dt(e,_(ke,e)),Bt(e,-1),te(ke,e)},kt=(e,t)=>we(m,e,t),At=(e,t,s)=>we(se(j,e,Y),t,s)&&te(P,e,se(P,e,(()=>0))+s),Mt=(e,t,s,n)=>{const a=_(Pe,e),l=_(a,s)??0;(0==l&&1==n||1==l&&-1==n)&&we(se(z,e,Y),s,n),te(a,s,l!=-n?l+n:null),we(se(se(k,e,Y),t,Y),s,n)},Nt=(e,t,s,n,a)=>{se(se(se(A,e,Y),t,Y),s,(()=>[n,0]))[1]=a,d[3]?.(e,t,s,a)},Bt=(e,t)=>we(M,e,t),Dt=(e,t,s)=>{se(he,e,(()=>[t,0]))[1]=s,d[4]?.(e,s)},Ht=(e,t,s,n,a)=>(x(se(se(se(Re,e,Y),t,Y),s,(()=>[])),n),a),Wt=(e,t,s)=>(x(se(Ie,e,(()=>[])),t),s),$t=(e,t,s)=>L(_(_(_(A,e),t),s),(([e,t])=>[!0,e,t]),(()=>[!1,...Te(ls(e,t,s))])),qt=e=>L(_(he,e),(([e,t])=>[!0,e,t]),(()=>[!1,...Te(is(e))])),Gt=e=>K(Re)||K(Ze[e])?0:U(e?ce(Re):Re,((t,s)=>U(t,((t,n)=>U(t,((t,a)=>it(Ze[e],[s,n,a],t))))))),Kt=e=>K(Ie)||K(_e[e])?0:U(e?re(Ie):Ie,((t,s)=>it(_e[e],[s],t))),Qt=(e,t,s,n)=>{if(!K(e))return it(t,n,(()=>ae(e))),ee(e,((e,t)=>it(s,[...n??[],e],1==t))),1},Ut=e=>{const t=cs();t!=n&&it(Ae[e],void 0,t);const s=K(Ge[e]),a=K(Ue[e])&&K(Xe[e])&&K(qe[e])&&K(Ke[e])&&K(He[e])&&K(We[e])&&K($e[e])&&s&&K(Ne[e])&&K(Be[e]),l=K(Ye[e])&&K(Qe[e])&&K(De[e])&&K(Me[e]);if(!a||!l){const t=e?[re(m),ie(z),re(P),ie(j),ce(k),ce(A)]:[m,z,P,j,k,A];if(!a){Qt(t[0],Ne[e],Be[e]),U(t[1],((t,s)=>Qt(t,He[e],We[e],[s]))),U(t[2],((t,s)=>{0!=t&&it($e[e],[s],ts(s))}));const n=ue();U(t[3],((t,a)=>{Qt(t,qe[e],Ke[e],[a])&&!s&&(it(Ge[e],[a,null]),fe(n,a))})),s||U(t[5],((t,s)=>{if(!G(n,s)){const n=ue();U(t,(e=>U(e,(([t,s],a)=>s!==t?fe(n,a):X(e,a))))),U(n,(t=>it(Ge[e],[s,t])))}})),U(t[4],((t,s)=>U(t,((t,n)=>Qt(t,Ue[e],Xe[e],[s,n])))))}if(!l){let s;U(t[5],((t,n)=>{let a;U(t,((t,l)=>{let o;U(t,(([t,r],i)=>{r!==t&&(it(Ye[e],[n,l,i],r,t,$t),s=a=o=1)})),o&&it(Qe[e],[n,l],$t)})),a&&it(De[e],[n],$t)})),s&&it(Me[e],void 0,$t)}}},Xt=e=>{const t=gs();t!=a&&it(et[e],void 0,t);const s=K(st[e])&&K(nt[e]),n=K(at[e])&&K(tt[e]);if(!s||!n){const t=e?[re(M),re(he)]:[M,he];if(s||Qt(t[0],st[e],nt[e]),!n){let s;U(t[1],(([t,n],a)=>{n!==t&&(it(at[e],[a],n,t,qt),s=1)})),s&&it(tt[e],void 0,qt)}}},Yt=(e,...t)=>(Is((()=>e(...O(t,C)))),Fs),Zt=()=>oe(je),_t=()=>Z(je),es=e=>Z(_(Pe,C(e))),ts=e=>q(_(je,C(e))),ss=e=>Z(_(je,C(e))),ns=(e,t,s,n=0,a)=>{return O(J((o=_(je,C(e)),r=(e,s)=>[w(t)?s:_(e,C(t)),s],l=([e],[t])=>((e??0)<(t??0)?-1:1)*(s?-1:1),O([...o?.entries()??[]],(([e,t])=>r(t,e))).sort(l)),n,w(a)?a:n+a),(([,e])=>e));var l,o,r},as=(e,t)=>Z(_(_(je,C(e)),C(t))),ls=(e,t,s)=>_(_(_(je,C(e)),C(t)),C(s)),os=()=>ae(ke),rs=()=>Z(ke),is=e=>_(ke,C(e)),cs=()=>!K(je),ds=e=>G(je,C(e)),us=(e,t)=>G(_(Pe,C(e)),C(t)),fs=(e,t)=>G(_(je,C(e)),C(t)),hs=(e,t,s)=>G(_(_(je,C(e)),C(t)),C(s)),gs=()=>!K(ke),Ts=e=>G(ke,C(e)),bs=e=>Yt((()=>(e=>$(e,ft,Ht))(e)?Ct(e):0)),Ss=e=>Yt((()=>Tt(e)?Jt(e):0)),Vs=e=>{try{yt(me(e))}catch{}return Fs},ps=t=>Yt((()=>{if((e=$(t,(e=>$(e,ut))))&&(pt(t),!K(je))){const e=Zt();ys(),bs(e)}})),vs=e=>Yt((()=>{if(t=(e=>$(e,ut))(e)){const s=os();Rs(),ws(),t=!0,vt(e),Ss(s)}})),ys=()=>Yt((()=>Ct({}))),Cs=e=>Yt((e=>G(je,e)?xt(e):0),e),ms=(e,t)=>Yt(((e,t)=>L(_(je,e),(s=>G(s,t)?zt(e,s,t):0))),e,t),ws=()=>Yt((()=>Jt({}))),Ls=()=>Yt((()=>{pt({}),e=!1})),Rs=()=>Yt((()=>{vt({}),t=!1})),Is=(e,t)=>{if(-1!=o){Js();const s=e();return Es(t),s}},Js=()=>(-1!=o&&o++,1==o&&(d[0]?.(),it(lt,void 0)),Fs),Es=e=>(o>0&&(o--,0==o&&(o=1,Gt(1),K(A)||Ut(1),Kt(1),K(he)||Xt(1),e?.(Fs)&&(U(A,((e,t)=>U(e,((e,s)=>U(e,(([e],n)=>ve(Fs,t,s,n,e))))))),Q(A),U(he,(([e],t)=>ye(Fs,t,e))),Q(he)),it(ot[0],void 0),o=-1,Gt(0),K(A)||Ut(0),Kt(0),K(he)||Xt(0),d[1]?.(),it(ot[1],void 0),d[2]?.(),o=0,n=cs(),a=gs(),F([m,z,P,j,k,A,Re,M,he,Ie],Q))),Fs),Fs={getContent:()=>[Zt(),os()],getTables:Zt,getTableIds:_t,getTable:e=>le(_(je,C(e))),getTableCellIds:es,getRowCount:ts,getRowIds:ss,getSortedRowIds:ns,getRow:(e,t)=>ae(_(_(je,C(e)),C(t))),getCellIds:as,getCell:ls,getValues:os,getValueIds:rs,getValue:is,hasTables:cs,hasTable:ds,hasTableCell:us,hasRow:fs,hasCell:hs,hasValues:gs,hasValue:Ts,getTablesJson:()=>Ce(je),getValuesJson:()=>Ce(ke),getJson:()=>Ce([je,ke]),getTablesSchemaJson:()=>Ce(Je),getValuesSchemaJson:()=>Ce(Fe),getSchemaJson:()=>Ce([Je,Fe]),hasTablesSchema:()=>e,hasValuesSchema:()=>t,setContent:([e,t])=>Yt((()=>{(W(e)?ys:bs)(e),(W(t)?ws:Ss)(t)})),setTables:bs,setTable:(e,t)=>Yt((e=>ft(t,e)?mt(e,t):0),e),setRow:(e,t,s)=>Yt(((e,t)=>ht(e,t,s)?wt(e,Ot(e),t,s):0),e,t),addRow:(e,t,s=!0)=>Is((()=>{let n;return ht(e,n,t)&&(e=C(e),wt(e,Ot(e),n=Ft(e,s?1:0),t)),n})),setPartialRow:(e,t,s)=>Yt(((e,t)=>{if(ht(e,t,s,1)){const n=Ot(e);H(s,((s,a)=>Rt(e,n,t,a,s)))}}),e,t),setCell:(e,t,s,n)=>Yt(((e,t,s)=>L(gt(e,t,s,I(n)?n(ls(e,t,s)):n),(n=>Rt(e,Ot(e),t,s,n)))),e,t,s),setValues:Ss,setPartialValues:e=>Yt((()=>Tt(e,1)?H(e,((e,t)=>Et(t,e))):0)),setValue:(e,t)=>Yt((e=>L(bt(e,I(t)?t(is(e)):t),(t=>Et(e,t)))),e),applyChanges:e=>Yt((()=>{H(e[0],((e,t)=>w(e)?Cs(t):H(e,((e,s)=>w(e)?ms(t,s):H(e,((e,n)=>ve(Fs,t,s,n,e))))))),H(e[1],((e,t)=>ye(Fs,t,e)))})),setTablesJson:Vs,setValuesJson:e=>{try{It(me(e))}catch{}return Fs},setJson:e=>Yt((()=>{try{const[t,s]=me(e);yt(t),It(s)}catch{Vs(e)}})),setTablesSchema:ps,setValuesSchema:vs,setSchema:(e,t)=>Yt((()=>{ps(e),vs(t)})),delTables:ys,delTable:Cs,delRow:ms,delCell:(e,t,s,n)=>Yt(((e,t,s)=>L(_(je,e),(a=>L(_(a,t),(l=>G(l,s)?Pt(e,a,t,l,s,n):0))))),e,t,s),delValues:ws,delValue:e=>Yt((e=>G(ke,e)?jt(e):0),e),delTablesSchema:Ls,delValuesSchema:Rs,delSchema:()=>Yt((()=>{Ls(),Rs()})),transaction:Is,startTransaction:Js,getTransactionChanges:()=>[ae(A,((e,t)=>-1===_(m,t)?void 0:ae(e,((e,s)=>-1===_(_(j,t),s)?void 0:ae(e,(([,e])=>e),(e=>Ve(e)))),K,W)),K,W),ae(he,(([,e])=>e),(e=>Ve(e))),1],getTransactionLog:()=>[!K(A),!K(he),oe(A,Se,Ve),oe(Re),ae(he,Se,Ve),ae(Ie),ae(m),le(j),oe(k),ae(M)],finishTransaction:Es,forEachTable:e=>U(je,((t,s)=>e(s,(e=>U(t,((t,s)=>e(s,(e=>ee(t,e))))))))),forEachTableCell:(e,t)=>ee(_(Pe,C(e)),t),forEachRow:(e,t)=>U(_(je,C(e)),((e,s)=>t(s,(t=>ee(e,t))))),forEachCell:(e,t,s)=>ee(_(_(je,C(e)),C(t)),s),forEachValue:e=>ee(ke,e),addSortedRowIdsListener:(e,t,s,n,a,l,o)=>{let r=ns(e,t,s,n,a);return rt((()=>{const o=ns(e,t,s,n,a);var i,c,d;c=r,E(i=o)===E(c)&&(d=(e,t)=>c[t]===e,i.every(d))||(r=o,l(Fs,e,t,s,n,a,r))}),Ge[o?1:0],[e,t],[_t])},addStartTransactionListener:e=>rt(e,lt),addWillFinishTransactionListener:e=>rt(e,ot[0]),addDidFinishTransactionListener:e=>rt(e,ot[1]),callListener:e=>(dt(e),Fs),delListener:e=>(ct(e),Fs),getListenerStats:()=>({}),createStore:Le,addListener:rt,callListeners:it,setInternalListeners:(e,t,s,n,a)=>d=[e,t,s,n,a]};return H({[c+f]:[0,Ae,[],()=>[cs()]],[f]:[0,Me],[h]:[0,Ne],[c+u]:[1,Be,[_t],e=>[ds(...e)]],[u]:[1,De,[_t]],[u+V]:[1,He,[_t]],[c+u+S]:[2,We,[_t,es],e=>[us(...e)]],[T]:[1,$e,[_t]],[b]:[1,qe,[_t]],[c+g]:[2,Ke,[_t,ss],e=>[fs(...e)]],[g]:[2,Qe,[_t,ss]],[V]:[2,Ue,[_t,ss]],[c+S]:[3,Xe,[_t,ss,as],e=>[hs(...e)]],[S]:[3,Ye,[_t,ss,as],e=>Te(ls(...e))],InvalidCell:[3,Ze],[c+v]:[0,et,[],()=>[gs()]],[v]:[0,tt],[y]:[0,st],[c+p]:[1,nt,[rs],e=>[Ts(...e)]],[p]:[1,at,[rs],e=>Te(is(e[0]))],InvalidValue:[1,_e]},(([e,t,s,n],a)=>{Fs["add"+a+"Listener"]=(...a)=>rt(a[e],t[a[e+1]?1:0],e>0?J(a,0,e):void 0,s,n)})),N(Fs)};e.createStore=Le},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseStore={});
