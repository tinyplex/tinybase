<nav><ul><li><a href="/">TinyBase</a></li><li><a href="/demos">Demos</a></li></ul></nav><section class="s1" id="/demos/tinymovies" data-id="TM"><h1>TinyMovies</h1><iframe srcdoc="&lt;html&gt;&lt;head&gt;&lt;script src=&quot;/umd/react.production.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/umd/react-dom.production.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/umd/tinybase.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/umd/ui-react.js&quot;&gt;&lt;/script&gt;&lt;style&gt;#loading{animation:spin 1s infinite linear;height:2rem;margin:40vh auto;width:2rem}#loading::before{content:url(&#x27;data:image/svg+xml,&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;2rem&quot; viewBox=&quot;0 0 100 100&quot;&gt;&lt;path d=&quot;M50 10A40 40 0 1 1 10 50&quot; stroke=&quot;black&quot; fill=&quot;none&quot; stroke-width=&quot;4&quot; /&gt;&lt;/svg&gt;&#x27;)}@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}nav{background:#eee;display:flex}nav a{flex:1;padding:.25rem;text-align:center}nav a.current{background:#ddd;font-weight:600}main{padding:.5rem}button{border:0;cursor:pointer;height:1rem;padding:0;vertical-align:text-top;width:1rem}button.prev{margin-left:.5rem}button.prev::before{content:url(&#x27;data:image/svg+xml,&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;1rem&quot; viewBox=&quot;0 0 100 100&quot; fill=&quot;black&quot;&gt;&lt;path d=&quot;M65 20v60l-30-30z&quot; /&gt;&lt;/svg&gt;&#x27;)}button.next{margin-right:.5rem}button.next::before{content:url(&#x27;data:image/svg+xml,&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;1rem&quot; viewBox=&quot;0 0 100 100&quot; fill=&quot;black&quot;&gt;&lt;path d=&quot;M35 20v60l30-30z&quot; /&gt;&lt;/svg&gt;&#x27;)}button.disabled{cursor:default;opacity:.3}table{border-collapse:collapse;font-size:inherit;line-height:inherit;margin-top:.5rem;table-layout:fixed;width:100%}table td,table th{overflow:hidden;padding:.25rem .5rem .25rem 0;white-space:nowrap}table th{border:solid #ddd;border-width:1px 0;cursor:pointer;text-align:left}table th.col0{width:40%}table th.col1,table th.col2,table th.col3{width:20%}table td{border-bottom:1px solid #eee}img{width:1rem;height:1.5rem;object-fit:cover;vertical-align:top;margin:0 .25rem 0 0}img.large{width:4rem;height:6rem;margin:0 .5rem 1rem 0;object-fit:contain;float:left}img.large+ul+*{clear:both}@font-face{font-family:Lato;src:url(https://tinybase.org/fonts/lato-light.woff2) format(&#x27;woff2&#x27;);font-weight:400}@font-face{font-family:Lato;src:url(https://tinybase.org/fonts/lato-regular.woff2) format(&#x27;woff2&#x27;);font-weight:600}*{box-sizing:border-box}body{user-select:none;font-family:Lato,sans-serif;font-size:.8rem;line-height:1.5rem;margin:0;color:#333}h1{margin:0 0 1rem}h2{margin:1.5rem 0 .5rem}ul{padding-left:0}li{display:block;padding-bottom:.25rem}a{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;cursor:pointer;max-width:100%;display:inline-block;vertical-align:top;color:#000}a:hover{text-decoration:underline}p{line-height:1.2rem}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script&gt;(()=&gt;{const v=React[&quot;createElement&quot;],{createQueries:l,createStore:n}=TinyBase,{CellView:o,Provider:a,ResultCellView:p,ResultSortedTableView:y,useCell:i,useCreateQueries:s,useCreateStore:d,useQueries:u,useResultCell:c,useResultRowIds:C,useRow:e,useSetRowCallback:t}=TinyBaseUiReact,{useCallback:w,useMemo:m,useState:f}=React,r=ReactDOM[&quot;render&quot;],I=()=&gt;{const e=d(n),r=d(()=&gt;n().setCell(&quot;ui&quot;,&quot;route&quot;,&quot;currentSection&quot;,&quot;movies&quot;)),l=s(e,j,[]),[t,o]=f(!0);return m(async()=&gt;{await F(e),o(!1)},[]),v(a,{store:e,storesById:{sessionStore:r},queries:l},v(q,null),v(t?g:b,null))};addEventListener(&quot;load&quot;,()=&gt;{r(v(I,null),document.body)});const g=()=&gt;v(&quot;div&quot;,{id:&quot;loading&quot;}),N={movies:[&quot;Movies&quot;,({detailId:e})=&gt;null==e?v(Q,null):v(L,{movieId:e})],years:[&quot;Years&quot;,({detailId:e})=&gt;null==e?v(G,null):v(P,{year:e})],genres:[&quot;Genres&quot;,({detailId:e})=&gt;null==e?v(M,null):v(E,{genreId:e})],people:[&quot;People&quot;,({detailId:e})=&gt;null==e?v(Y,null):v(T,{personId:e})]},h=()=&gt;e(&quot;ui&quot;,&quot;route&quot;,&quot;sessionStore&quot;),R=(e,r)=&gt;t(&quot;ui&quot;,&quot;route&quot;,()=&gt;({currentSection:e,currentDetailId:r}),[e,r],&quot;sessionStore&quot;),q=()=&gt;{const l=h()[&quot;currentSection&quot;];return v(&quot;nav&quot;,null,Object.entries(N).map(([e,[r]])=&gt;v(&quot;a&quot;,{className:l==e?&quot;current&quot;:&quot;&quot;,onClick:R(e,null)},r)))},b=()=&gt;{var{currentSection:e,currentDetailId:r}=h(),[,e]=N[e];return v(&quot;main&quot;,null,v(e,{detailId:r}))},S=/^[\d\.]+$/,F=async r=&gt;{r.startTransaction(),await Promise.all([&quot;movies&quot;,&quot;genres&quot;,&quot;people&quot;,&quot;cast&quot;].map(e=&gt;(async(t,o)=&gt;{const e=(await(await fetch(`https://tinybase.org/assets/${o}.tsv`)).text()).split(`
`),n=e.shift().split(&quot;\t&quot;);e.forEach(e=&gt;{const r=e.split(&quot;\t&quot;);if(r.length==n.length){const l=r.shift();r.forEach((e,r)=&gt;{&quot;&quot;!=e&amp;&amp;(S.test(e)&amp;&amp;(e=parseFloat(e)),t.setCell(o,l,n[r+1],e))})}})})(r,e))),r.finishTransaction()},D=({select:e,join:r})=&gt;{e((e,r)=&gt;r).as(&quot;movieId&quot;),e(&quot;name&quot;).as(&quot;movieName&quot;),e(&quot;image&quot;).as(&quot;movieImage&quot;),e(&quot;year&quot;),e(&quot;rating&quot;),e(&quot;genreId&quot;),e(&quot;genres&quot;,&quot;name&quot;).as(&quot;genreName&quot;),r(&quot;genres&quot;,&quot;genreId&quot;)},j=e=&gt;{const r=l(e);return r.setQueryDefinition(&quot;movies&quot;,&quot;movies&quot;,({select:t,join:o})=&gt;{D({select:t,join:o}),t(&quot;overview&quot;),t(&quot;directorId&quot;),t(&quot;directors&quot;,&quot;name&quot;).as(&quot;directorName&quot;),t(&quot;directors&quot;,&quot;image&quot;).as(&quot;directorImage&quot;),o(&quot;people&quot;,&quot;directorId&quot;).as(&quot;directors&quot;),[1,2,3].forEach(l=&gt;{var e=&quot;cast&quot;+l;o(&quot;cast&quot;,(e,r)=&gt;r+&quot;/&quot;+l).as(e),t(e,&quot;castId&quot;).as(&quot;castId&quot;+l);var r=&quot;actors&quot;+l;o(&quot;people&quot;,e,&quot;castId&quot;).as(r),t(r,&quot;name&quot;).as(&quot;castName&quot;+l),t(r,&quot;image&quot;).as(&quot;castImage&quot;+l)})}),r.setQueryDefinition(&quot;years&quot;,&quot;movies&quot;,({select:e,group:r})=&gt;{e(&quot;year&quot;),e((e,r)=&gt;r).as(&quot;movieId&quot;),r(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),r.setQueryDefinition(&quot;genres&quot;,&quot;movies&quot;,({select:e,join:r,group:l})=&gt;{e(&quot;genreId&quot;),e((e,r)=&gt;r).as(&quot;movieId&quot;),r(&quot;genres&quot;,&quot;genreId&quot;),e(&quot;genres&quot;,&quot;name&quot;).as(&quot;genreName&quot;),l(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),r.setQueryDefinition(&quot;directors&quot;,&quot;movies&quot;,({select:e,join:r,group:l})=&gt;{e(&quot;directorId&quot;),e((e,r)=&gt;r).as(&quot;movieId&quot;),e(&quot;people&quot;,&quot;name&quot;).as(&quot;directorName&quot;),e(&quot;people&quot;,&quot;image&quot;).as(&quot;directorImage&quot;),e(&quot;people&quot;,&quot;gender&quot;),e(&quot;people&quot;,&quot;popularity&quot;),r(&quot;people&quot;,&quot;directorId&quot;),l(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),r.setQueryDefinition(&quot;cast&quot;,&quot;cast&quot;,({select:e,join:r,group:l})=&gt;{e(&quot;castId&quot;),e(&quot;movieId&quot;),e(&quot;people&quot;,&quot;name&quot;).as(&quot;castName&quot;),e(&quot;people&quot;,&quot;image&quot;).as(&quot;castImage&quot;),e(&quot;people&quot;,&quot;gender&quot;),e(&quot;people&quot;,&quot;popularity&quot;),r(&quot;people&quot;,&quot;castId&quot;),l(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),r},k=({queryId:e,columns:r,defaultSortCellId:l,defaultDescending:t=!0,limit:o=20,noun:n=&quot;record&quot;})=&gt;{const a=JSON.stringify(r),[i,s]=f(l),[d,u]=f(t),[c,m]=f(0),I=C(e).length;c&gt;I&amp;&amp;m(0);var g=w(()=&gt;v(React.Fragment,null,I,&quot; &quot;,n,1!=I?&quot;s&quot;:&quot;&quot;,I&gt;o&amp;&amp;v(React.Fragment,null,0&lt;c?v(&quot;button&quot;,{className:&quot;prev&quot;,onClick:()=&gt;m(c-o)}):v(&quot;button&quot;,{className:&quot;prev disabled&quot;}),c+o&lt;I?v(&quot;button&quot;,{className:&quot;next&quot;,onClick:()=&gt;m(c+o)}):v(&quot;button&quot;,{className:&quot;next disabled&quot;}),c+1,&quot; to &quot;,Math.min(I,c+o))),[I,c,o]),l=w(()=&gt;v(&quot;tr&quot;,null,r.map(([e,r],l)=&gt;e==i?v(&quot;th&quot;,{onClick:()=&gt;u(!d),className:&quot;col&quot;+l},d?&quot;↓&quot;:&quot;↑&quot;,&quot; &quot;,r):v(&quot;th&quot;,{onClick:()=&gt;s(e),className:&quot;col&quot;+l},r))),[i,d,a]),t=w(l=&gt;v(&quot;tr&quot;,null,r.map(([e,,r])=&gt;v(&quot;td&quot;,null,null==r?v(p,{...l,cellId:e}):v(r,{...l})))),[a]);return v(React.Fragment,null,v(g,null),v(&quot;table&quot;,null,v(l,null),v(y,{queryId:e,cellId:i,descending:d,offset:c,limit:o,resultRowComponent:t})))},Q=()=&gt;v(W,{title:&quot;Rated movies&quot;},v(k,{queryId:&quot;movies&quot;,columns:[[&quot;movieName&quot;,&quot;Movie&quot;,B],[&quot;year&quot;,&quot;Year&quot;,x],[&quot;rating&quot;,&quot;Rating&quot;],[&quot;genreName&quot;,&quot;Genre&quot;,O]],defaultSortCellId:&quot;rating&quot;,noun:&quot;movie&quot;})),G=()=&gt;v(W,{title:&quot;Years&quot;},v(k,{queryId:&quot;years&quot;,columns:[[&quot;year&quot;,&quot;Year&quot;,x],[&quot;movieCount&quot;,&quot;Rated movies&quot;]],defaultSortCellId:&quot;year&quot;,noun:&quot;year&quot;})),M=()=&gt;v(W,{title:&quot;Genres&quot;},v(k,{queryId:&quot;genres&quot;,columns:[[&quot;genreName&quot;,&quot;Genre&quot;,O],[&quot;movieCount&quot;,&quot;Rated movies&quot;]],defaultSortCellId:&quot;movieCount&quot;,noun:&quot;genre&quot;})),Y=()=&gt;v(W,{title:&quot;People&quot;},v(&quot;h2&quot;,null,&quot;Directors&quot;),v(k,{queryId:&quot;directors&quot;,columns:[[&quot;directorName&quot;,&quot;Director&quot;,V],[&quot;gender&quot;,&quot;Gender&quot;,U],[&quot;popularity&quot;,&quot;Popularity&quot;],[&quot;movieCount&quot;,&quot;Rated movies&quot;]],defaultSortCellId:&quot;popularity&quot;,noun:&quot;director&quot;}),v(&quot;h2&quot;,null,&quot;Cast&quot;),v(k,{queryId:&quot;cast&quot;,columns:[[&quot;castName&quot;,&quot;Cast&quot;,A],[&quot;gender&quot;,&quot;Gender&quot;,U],[&quot;popularity&quot;,&quot;Popularity&quot;],[&quot;movieCount&quot;,&quot;Rated movies&quot;]],defaultSortCellId:&quot;popularity&quot;,noun:&quot;actor&quot;})),L=({movieId:e})=&gt;{var r={queryId:&quot;movies&quot;,rowId:e};return v(W,{title:c(&quot;movies&quot;,e,&quot;movieName&quot;)},v(z,{...r,cellId:&quot;movieImage&quot;,isLarge:!0}),v(&quot;ul&quot;,null,v(&quot;li&quot;,null,&quot;Year: &quot;,v(x,{...r})),v(&quot;li&quot;,null,&quot;Genre: &quot;,v(O,{...r})),v(&quot;li&quot;,null,&quot;Rating: &quot;,v(p,{...r,cellId:&quot;rating&quot;}))),v(&quot;p&quot;,null,v(p,{...r,cellId:&quot;overview&quot;})),v(&quot;h2&quot;,null,&quot;Credits&quot;),v(&quot;ul&quot;,null,v(&quot;li&quot;,null,v(V,{...r}),&quot;, director&quot;),v(&quot;li&quot;,null,v(A,{...r,billing:1})),v(&quot;li&quot;,null,v(A,{...r,billing:2})),v(&quot;li&quot;,null,v(A,{...r,billing:3}))))},P=({year:t})=&gt;{const e=u();return m(()=&gt;e.setQueryDefinition(&quot;moviesForYear&quot;,&quot;movies&quot;,({select:e,join:r,where:l})=&gt;{D({select:e,join:r}),l(&quot;year&quot;,t)}),[t]),v(W,{title:&quot;Movies from &quot;+t},v(k,{queryId:&quot;moviesForYear&quot;,columns:[[&quot;movieName&quot;,&quot;Movie&quot;,B],[&quot;rating&quot;,&quot;Rating&quot;],[&quot;genre&quot;,&quot;Genre&quot;,O]],defaultSortCellId:&quot;rating&quot;,noun:&quot;movie&quot;}))},E=({genreId:t})=&gt;{const e=u();return m(()=&gt;e.setQueryDefinition(&quot;moviesForGenre&quot;,&quot;movies&quot;,({select:e,join:r,where:l})=&gt;{D({select:e,join:r}),l(&quot;genreId&quot;,t)}),[t]),v(W,{title:i(&quot;genres&quot;,t,&quot;name&quot;)+&quot; movies&quot;},v(k,{queryId:&quot;moviesForGenre&quot;,columns:[[&quot;movieName&quot;,&quot;Movie&quot;,B],[&quot;year&quot;,&quot;Year&quot;,x],[&quot;rating&quot;,&quot;Rating&quot;]],defaultSortCellId:&quot;rating&quot;,noun:&quot;movie&quot;}))},T=({personId:t})=&gt;{const e=u();m(()=&gt;e.setQueryDefinition(&quot;moviesForDirector&quot;,&quot;movies&quot;,({select:e,join:r,where:l})=&gt;{D({select:e,join:r}),l(&quot;directorId&quot;,t)}).setQueryDefinition(&quot;moviesForCast&quot;,&quot;cast&quot;,({select:e,join:r,where:l})=&gt;{e(&quot;movieId&quot;),e(&quot;movies&quot;,&quot;name&quot;).as(&quot;movieName&quot;),e(&quot;movies&quot;,&quot;image&quot;).as(&quot;movieImage&quot;),e(&quot;movies&quot;,&quot;year&quot;),e(&quot;movies&quot;,&quot;rating&quot;),e(&quot;movies&quot;,&quot;genreId&quot;),e(&quot;genres&quot;,&quot;name&quot;).as(&quot;genreName&quot;),r(&quot;movies&quot;,&quot;movieId&quot;),r(&quot;genres&quot;,&quot;movies&quot;,&quot;genreId&quot;),l(&quot;castId&quot;,t)}),[t]);var r={tableId:&quot;people&quot;,rowId:t};return v(W,{title:i(&quot;people&quot;,t,&quot;name&quot;)},v(H,{...r,cellId:&quot;image&quot;,isLarge:!0}),v(&quot;ul&quot;,null,v(&quot;li&quot;,null,&quot;Gender: &quot;,v($,{...r})),v(&quot;li&quot;,null,&quot;Born: &quot;,v(o,{...r,cellId:&quot;born&quot;}),i(&quot;people&quot;,t,&quot;died&quot;)&amp;&amp;v(React.Fragment,null,&quot;; died: &quot;,v(o,{...r,cellId:&quot;died&quot;}))),v(&quot;li&quot;,null,&quot;Popularity: &quot;,v(o,{...r,cellId:&quot;popularity&quot;}))),v(&quot;p&quot;,null,v(o,{...r,cellId:&quot;biography&quot;})),0==C(&quot;moviesForDirector&quot;).length?null:v(React.Fragment,null,v(&quot;h2&quot;,null,&quot;As director:&quot;),v(k,{queryId:&quot;moviesForDirector&quot;,columns:[[&quot;movieName&quot;,&quot;Movie&quot;,B],[&quot;year&quot;,&quot;Year&quot;,x],[&quot;rating&quot;,&quot;Rating&quot;]],defaultSortCellId:&quot;rating&quot;,noun:&quot;rated movie&quot;})),0==C(&quot;moviesForCast&quot;).length?null:v(React.Fragment,null,v(&quot;h2&quot;,null,&quot;As cast:&quot;),v(k,{queryId:&quot;moviesForCast&quot;,columns:[[&quot;movieName&quot;,&quot;Movie&quot;,B],[&quot;year&quot;,&quot;Year&quot;,x],[&quot;rating&quot;,&quot;Rating&quot;]],defaultSortCellId:&quot;rating&quot;,noun:&quot;rated movie&quot;})))},B=({queryId:e,rowId:r})=&gt;{var l=c(e,r,&quot;movieId&quot;);return v(&quot;a&quot;,{onClick:R(&quot;movies&quot;,l)},v(z,{queryId:e,rowId:r,cellId:&quot;movieImage&quot;}),v(p,{queryId:e,rowId:r,cellId:&quot;movieName&quot;}))},x=({queryId:e,rowId:r})=&gt;{var l=c(e,r,&quot;year&quot;);return v(&quot;a&quot;,{onClick:R(&quot;years&quot;,l)},v(p,{queryId:e,rowId:r,cellId:&quot;year&quot;}))},O=({queryId:e,rowId:r})=&gt;{var l=c(e,r,&quot;genreId&quot;);return v(&quot;a&quot;,{onClick:R(&quot;genres&quot;,l)},v(p,{queryId:e,rowId:r,cellId:&quot;genreName&quot;}))},V=({queryId:e,rowId:r})=&gt;{var l=c(e,r,&quot;directorId&quot;);return v(&quot;a&quot;,{onClick:R(&quot;people&quot;,l)},v(z,{queryId:e,rowId:r,cellId:&quot;directorImage&quot;}),v(p,{queryId:e,rowId:r,cellId:&quot;directorName&quot;}))},A=({queryId:e,rowId:r,billing:l=1})=&gt;{var t=c(e,r,&quot;castId&quot;+l);return null==t?null:v(&quot;a&quot;,{onClick:R(&quot;people&quot;,t)},v(z,{queryId:e,rowId:r,cellId:&quot;castImage&quot;+l}),v(p,{queryId:e,rowId:r,cellId:&quot;castName&quot;+l}))},U=({queryId:e,rowId:r})=&gt;J(c(e,r,&quot;gender&quot;)),$=({tableId:e,rowId:r})=&gt;J(i(e,r,&quot;gender&quot;)),J=e=&gt;{switch(e){case 1:return&quot;Female&quot;;case 2:return&quot;Male&quot;;case 3:return&quot;Non-binary&quot;;default:return&quot;Unknown&quot;}},z=({queryId:e,rowId:r,cellId:l,isLarge:t})=&gt;v(K,{imageFile:c(e,r,l),isLarge:t}),H=({tableId:e,rowId:r,cellId:l,isLarge:t})=&gt;v(K,{imageFile:i(e,r,l),isLarge:t}),K=({imageFile:e,isLarge:r})=&gt;v(&quot;img&quot;,{src:&quot;https://image.tmdb.org/t/p/w&quot;+(r?92:45)+e,className:r?&quot;large&quot;:&quot;&quot;}),W=({title:e,children:r})=&gt;v(React.Fragment,null,v(&quot;h1&quot;,null,e),r)})()&lt;/script&gt;&lt;/html&gt;"></iframe><p>In this demo, we build an app that showcases the relational query capabilities of <a href="/">TinyBase</a> v2.0, joining together information about movies, directors, and actors.</p><p><img src="https://www.themoviedb.org/assets/2/v4/logos/v2/blue_short-8e7b30f73a4020692ccca9c88bafe5dcb6f8a62a4c6bc55cd9ba82bb2cd95f6c.svg" alt="TMDB" title="Inline logo for TMDB"> - we use The Movie Database as the source of the movie information in this app. Thank you for a great data set to demonstrate <a href="/">TinyBase</a>!</p><p>This demo includes a powerful general component called <a href="#the-resultsortablegrid-component"><code>ResultSortableGrid</code></a> that you should feel free to use in your own apps.</p><h3 id="an-overview-of-the-data">An Overview Of The Data</h3><p>Before looking at code, let&#x27;s familiarize ourselves with the data used in this application.</p><h4 id="tables"><a href="/api/store/type-aliases/store/tables"><code>Tables</code></a></h4><p>The raw data is loaded into four normalized <a href="/api/store/type-aliases/store/table"><code>Table</code></a> objects: <code>movies</code> (the top 250 movies on TMDB), <code>genres</code> (the styles of those movies), <code>people</code> (actors and directors), and <code>cast</code> (how the actors are associated with the movies).</p><p>Naturally, there are relationships between these. For example, the <code>directorId</code> <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> of the <code>movies</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> references a person in the <code>people</code> table, and the <code>genreId</code> <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> references the <code>genre</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a>. The <code>cast</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> is a many-to-many join that contains all the <code>movieId</code>/<code>castId</code> pairs for the top three billed actors of each movie.</p><div class="table"><table><thead><tr><th><a href="/api/store/type-aliases/store/table"><code>Table</code></a></th><th><a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a></th></tr></thead><tbody><tr><td><code>movies</code></td><td><code>id</code>, <code>name</code>, <code>genreId</code>, <code>directorId</code>, <code>year</code>, <code>rating</code>, <code>overview</code>, <code>image</code></td></tr><tr><td><code>genres</code></td><td><code>id</code>, <code>name</code></td></tr><tr><td><code>people</code></td><td><code>id</code>, <code>name</code>, <code>gender</code>, <code>born</code>, <code>died</code>, <code>popularity</code>, <code>biography</code>, <code>image</code></td></tr><tr><td><code>cast</code></td><td><code>id</code>, <code>movieId</code>, <code>castId</code></td></tr></tbody></table></div><p>Because the data is normalized (and fetched as TSV over the wire), it loads quickly. But generally this data isn&#x27;t suited to render directly into the application: the user doesn&#x27;t want to see the movie&#x27;s <code>directorId</code>. They want to see the director&#x27;s <code>name</code>!</p><h4 id="queries"><a href="/api/queries/interfaces/queries/queries"><code>Queries</code></a></h4><p>The app therefore uses a set of queries against these underlying <a href="/api/store/type-aliases/store/table"><code>Table</code></a> objects. These act as de-normalized &#x27;views&#x27; of the underlying normalized data and make it easy for the application to render &#x27;virtual&#x27; rows comprised of <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> values from multiple joined <a href="/api/store/type-aliases/store/table"><code>Table</code></a> objects in the <a href="/api/store/interfaces/store/store"><code>Store</code></a>.</p><p>Some of these, like the main <code>movies</code> query, are set up for the lifetime of the application:</p><div class="table"><table><thead><tr><th>Query</th><th>From <a href="/api/store/type-aliases/store/tables"><code>Tables</code></a></th><th><a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a></th></tr></thead><tbody><tr><td><code>movies</code></td><td><code>movies</code>, <code>genres</code>, <code>people</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code>, <code>overview</code>, <code>directorId</code>, <code>directorName</code>, <code>directorImage</code>, <code>castId1</code>, <code>castName1</code>, <code>castImage1</code>, <code>castId2</code>, <code>castName2</code>, <code>castImage2</code>, <code>castId3</code>, <code>castName3</code>, <code>castImage3</code></td></tr><tr><td><code>years</code></td><td><code>movies</code></td><td><code>year</code>, <code>movieCount</code></td></tr><tr><td><code>genres</code></td><td><code>movies</code></td><td><code>genreId</code>, <code>genreName</code>, <code>movieCount</code></td></tr><tr><td><code>directors</code></td><td><code>movies</code>, <code>people</code></td><td><code>directorId</code>, <code>directorName</code>, <code>directorImage</code>, <code>gender</code>, <code>popularity</code>, <code>movieCount</code></td></tr><tr><td><code>cast</code></td><td><code>cast</code>, <code>people</code></td><td><code>castId</code>, <code>castName</code>, <code>castImage</code>, <code>gender</code>, <code>popularity</code>, <code>movieCount</code></td></tr></tbody></table></div><p>Others, like the <code>moviesForYear</code> query, are set up when a specific page is being viewed (in that case, the detail page for a particular year):</p><div class="table"><table><thead><tr><th>Query</th><th>From <a href="/api/store/type-aliases/store/tables"><code>Tables</code></a></th><th><a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a></th></tr></thead><tbody><tr><td><code>moviesForYear</code></td><td><code>movies</code>, <code>genres</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code></td></tr><tr><td><code>moviesForGenre</code></td><td><code>movies</code>, <code>genres</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code></td></tr><tr><td><code>moviesForDirector</code></td><td><code>movies</code>, <code>genres</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code></td></tr><tr><td><code>moviesForCast</code></td><td><code>cast</code>, <code>movies</code>, <code>genres</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code></td></tr></tbody></table></div><p>You might notice that many of these queries share the same <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a>. You&#x27;ll discover that <a href="/">TinyBase</a> lets you compose queries programmatically, so we&#x27;ll be able to build these queries without much repetition: the common <code>queryMovieBasics</code> function is used to select the same <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a> into most of these query views.</p><p>Refer back to this section when we start <a href="#loading-the-data">loading the data</a>, <a href="#querying-the-data">querying the data</a>, and rendering them into the user interface. Otherwise, that&#x27;s enough preamble... let&#x27;s get to some code!</p><h3 id="boilerplate">Boilerplate</h3><p>As per usual, we first pull in React, ReactDOM, and <a href="/">TinyBase</a>:</p><pre><code><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>script</span> <span class="attr-name">src</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>/umd/react.production.min.js<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="script"></span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>script</span><span class="punctuation">></span></span>
<span class="tag"><span class="tag"><span class="punctuation">&lt;</span>script</span> <span class="attr-name">src</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>/umd/react-dom.production.min.js<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="script"></span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>script</span><span class="punctuation">></span></span>
<span class="tag"><span class="tag"><span class="punctuation">&lt;</span>script</span> <span class="attr-name">src</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>/umd/tinybase.js<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="script"></span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>script</span><span class="punctuation">></span></span>
<span class="tag"><span class="tag"><span class="punctuation">&lt;</span>script</span> <span class="attr-name">src</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>/umd/ui-react.js<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="script"></span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>script</span><span class="punctuation">></span></span>
</code></pre><p>We need the following parts of the <a href="/">TinyBase</a> API, the <a href="/api/ui-react"><code>ui-react</code></a> module, and React itself:</p><pre><code><span class="keyword">const</span> <span class="punctuation">{</span>createQueries<span class="punctuation">,</span> createStore<span class="punctuation">}</span> <span class="operator">=</span> TinyBase<span class="punctuation">;</span>
<span class="keyword">const</span> <span class="punctuation">{</span>
  CellView<span class="punctuation">,</span>
  Provider<span class="punctuation">,</span>
  ResultCellView<span class="punctuation">,</span>
  ResultSortedTableView<span class="punctuation">,</span>
  useCell<span class="punctuation">,</span>
  useCreateQueries<span class="punctuation">,</span>
  useCreateStore<span class="punctuation">,</span>
  useQueries<span class="punctuation">,</span>
  useResultCell<span class="punctuation">,</span>
  useResultRowIds<span class="punctuation">,</span>
  useRow<span class="punctuation">,</span>
  useSetRowCallback<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="operator">=</span> TinyBaseUiReact<span class="punctuation">;</span>
<span class="keyword">const</span> <span class="punctuation">{</span>createElement<span class="punctuation">,</span> useCallback<span class="punctuation">,</span> useMemo<span class="punctuation">,</span> useState<span class="punctuation">}</span> <span class="operator">=</span> React<span class="punctuation">;</span>
<span class="keyword">const</span> <span class="punctuation">{</span>render<span class="punctuation">}</span> <span class="operator">=</span> ReactDOM<span class="punctuation">;</span>
</code></pre><h3 id="initializing-the-application">Initializing The Application</h3><p>In the main part of the application, we want to initialize a default <a href="/api/store/interfaces/store/store"><code>Store</code></a> (called <code>store</code>) and a named <a href="/api/store/interfaces/store/store"><code>Store</code></a> called <code>sessionStore</code>. The latter serves the sole purpose of remembering the &#x27;route&#x27; in the application, which describes which part of the user interface the user is looking at.</p><p>We also initialize a <a href="/api/queries/interfaces/queries/queries"><code>Queries</code></a> object, and use the <code>createAndInitQueries</code> function (which we&#x27;ll describe later) to set up the queries for the application.</p><p>The two <a href="/api/store/interfaces/store/store"><code>Store</code></a> objects and the <a href="/api/queries/interfaces/queries/queries"><code>Queries</code></a> object are memoized by the useCreateStore method and useCreateQueries method so they are only created the first time the app is rendered.</p><pre><code><span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatestore">useCreateStore</a></span><span class="punctuation">(</span>createStore<span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> sessionStore <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatestore">useCreateStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
    <span class="function"><a href="/api/store/functions/creation/createstore">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'ui'</span><span class="punctuation">,</span> <span class="string">'route'</span><span class="punctuation">,</span> <span class="string">'currentSection'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> queries <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/usecreatequeries">useCreateQueries</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> createAndInitQueries<span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="comment">// ...</span>
</code></pre><p>This application depends on loading data into the main <a href="/api/store/interfaces/store/store"><code>Store</code></a> the first time it is rendered. We do this by having an <code>isLoading</code> flag in the application&#x27;s state, and setting it to <code>false</code> only once the asynchronous loading sequence in the (soon-to-be described) <code>loadStore</code> function has completed. Until then, a loading spinner is shown.</p><pre><code>  <span class="comment">// ...</span>
  <span class="keyword">const</span> <span class="punctuation">[</span>isLoading<span class="punctuation">,</span> setIsLoading<span class="punctuation">]</span> <span class="operator">=</span> <span class="function">useState</span><span class="punctuation">(</span><span class="boolean">true</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">useMemo</span><span class="punctuation">(</span><span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="keyword">await</span> <span class="function">loadStore</span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">setIsLoading</span><span class="punctuation">(</span><span class="boolean">false</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider">Provider</a></span></span> <span class="attr-name">store</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>store<span class="punctuation">}</span></span> <span class="attr-name">storesById</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">{</span>sessionStore<span class="punctuation">}</span><span class="punctuation">}</span></span> <span class="attr-name">queries</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queries<span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Header</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="punctuation">{</span>isLoading <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Loading</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Body</span></span> <span class="punctuation">/></span></span><span class="punctuation">}</span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider">Provider</a></span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><p>With simple boilerplate code to load the component, off we go:</p><pre><code><span class="function">addEventListener</span><span class="punctuation">(</span><span class="string">'load'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="punctuation">/></span></span><span class="punctuation">,</span> document<span class="punctuation">.</span>body<span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><h3 id="basic-components">Basic Components</h3><p>Before we get to the really interesting parts, let&#x27;s dispense with the basic building blocks for the application&#x27;s user interface.</p><h4 id="loading-spinner">Loading Spinner</h4><p>First the loading spinner, a plain element with some CSS.</p><pre><code><span class="keyword">const</span> <span class="function-variable">Loading</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>div</span> <span class="attr-name">id</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>loading<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>
</code></pre><p>This is styled as a 270° arc with a spinning animation:</p><pre><code><span class="selector">#loading</span> <span class="punctuation">{</span>
  <span class="property">animation</span><span class="punctuation">:</span> spin 1s infinite linear<span class="punctuation">;</span>
  <span class="property">height</span><span class="punctuation">:</span> 2rem<span class="punctuation">;</span>
  <span class="property">margin</span><span class="punctuation">:</span> 40vh auto<span class="punctuation">;</span>
  <span class="property">width</span><span class="punctuation">:</span> 2rem<span class="punctuation">;</span>
  <span class="selector">&amp;::before</span> <span class="punctuation">{</span>
    <span class="property">content</span><span class="punctuation">:</span> <span class="url"><span class="function">url</span><span class="punctuation">(</span><span class="string">'data:image/svg+xml,&lt;svg xmlns="http://www.w3.org/2000/svg" height="2rem" viewBox="0 0 100 100">&lt;path d="M50 10A40 40 0 1 1 10 50" stroke="black" fill="none" stroke-width="4" />&lt;/svg>'</span><span class="punctuation">)</span></span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>

<span class="atrule">@keyframes spin</span> <span class="punctuation">{</span>
  <span class="selector">from</span> <span class="punctuation">{</span>
    <span class="property">transform</span><span class="punctuation">:</span> <span class="function">rotate</span><span class="punctuation">(</span>0<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
  <span class="selector">to</span> <span class="punctuation">{</span>
    <span class="property">transform</span><span class="punctuation">:</span> <span class="function">rotate</span><span class="punctuation">(</span>360deg<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><h4 id="application-sections">Application Sections</h4><p>Next the structure of the application. It has four sections: &#x27;Movies&#x27;, &#x27;Years&#x27;, &#x27;Genres&#x27;, and &#x27;People&#x27;. We define their outer components and create a keyed collection of them. Each either shows an overview (for example, all movies) or the detail of one particular record (for example, a single movie):</p><pre><code><span class="keyword">const</span> <span class="function-variable">MoviesSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">MoviesOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">MovieDetail</span></span> <span class="attr-name">movieId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">YearsSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">YearsOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">YearDetail</span></span> <span class="attr-name">year</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">GenresSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenresOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenreDetail</span></span> <span class="attr-name">genreId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">PeopleSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">PeopleOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">PersonDetail</span></span> <span class="attr-name">personId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="constant">SECTIONS</span> <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">movies</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'Movies'</span><span class="punctuation">,</span> MoviesSection<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="literal-property">years</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'Years'</span><span class="punctuation">,</span> YearsSection<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="literal-property">genres</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'Genres'</span><span class="punctuation">,</span> GenresSection<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="literal-property">people</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'People'</span><span class="punctuation">,</span> PeopleSection<span class="punctuation">]</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>The <code>sessionStore</code> contains a single record in the <code>ui</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> that is called <code>route</code>. This is the section name and optionally a detail ID (such as the movie&#x27;s ID). The <code>useRoute</code> hook gets this pair, and the <code>useSetRouteCallback</code> hook will be used to set it in response to the user clicking links in the app.</p><pre><code><span class="keyword">const</span> <span class="function-variable">useRoute</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function"><a href="/api/ui-react/functions/store-hooks/userow">useRow</a></span><span class="punctuation">(</span><span class="string">'ui'</span><span class="punctuation">,</span> <span class="string">'route'</span><span class="punctuation">,</span> <span class="string">'sessionStore'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> <span class="function-variable">useSetRouteCallback</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">currentSection<span class="punctuation">,</span> currentDetailId</span><span class="punctuation">)</span> <span class="operator">=></span>
  <span class="function"><a href="/api/ui-react/functions/store-hooks/usesetrowcallback">useSetRowCallback</a></span><span class="punctuation">(</span>
    <span class="string">'ui'</span><span class="punctuation">,</span>
    <span class="string">'route'</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span><span class="punctuation">{</span>currentSection<span class="punctuation">,</span> currentDetailId<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>currentSection<span class="punctuation">,</span> currentDetailId<span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="string">'sessionStore'</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>Note that we&#x27;re not doing anything fancy here like updating the browser&#x27;s URL address or history state as the user navigates around, but we would add that in this method if we did.</p><p>(Another easy, but interesting, exercise for the reader would be to use the <a href="/api/checkpoints/interfaces/checkpoints/checkpoints"><code>Checkpoints</code></a> API on the <code>sessionsStore</code> to create an in-app history stack for the pages viewed!)</p><h4 id="application-header">Application Header</h4><p>The header component simply renders all the links for the <code>SECTIONS</code> object and highlights the one that matches the current route.</p><pre><code><span class="keyword">const</span> <span class="function-variable">Header</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> <span class="punctuation">{</span>currentSection<span class="punctuation">}</span> <span class="operator">=</span> <span class="function">useRoute</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>nav</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="punctuation">{</span>Object<span class="punctuation">.</span><span class="function">entries</span><span class="punctuation">(</span><span class="constant">SECTIONS</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter"><span class="punctuation">[</span>section<span class="punctuation">,</span> <span class="punctuation">[</span>title<span class="punctuation">]</span><span class="punctuation">]</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
        <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span>
          <span class="attr-name">className</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>currentSection <span class="operator">==</span> section <span class="operator">?</span> <span class="string">'current'</span> <span class="operator">:</span> <span class="string">''</span><span class="punctuation">}</span></span>
          <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span>section<span class="punctuation">,</span> <span class="keyword">null</span><span class="punctuation">)</span><span class="punctuation">}</span></span>
        <span class="punctuation">></span></span><span class="plain-text">
          </span><span class="punctuation">{</span>title<span class="punctuation">}</span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
      <span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>nav</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>The header also has very simple styling:</p><pre><code><span class="selector">nav</span> <span class="punctuation">{</span>
  <span class="property">background</span><span class="punctuation">:</span> #eee<span class="punctuation">;</span>
  <span class="property">display</span><span class="punctuation">:</span> flex<span class="punctuation">;</span>
  <span class="selector">a</span> <span class="punctuation">{</span>
    <span class="property">flex</span><span class="punctuation">:</span> 1<span class="punctuation">;</span>
    <span class="property">padding</span><span class="punctuation">:</span> 0.25rem<span class="punctuation">;</span>
    <span class="property">text-align</span><span class="punctuation">:</span> center<span class="punctuation">;</span>
    <span class="selector">&amp;.current</span> <span class="punctuation">{</span>
      <span class="property">background</span><span class="punctuation">:</span> #ddd<span class="punctuation">;</span>
      <span class="property">font-weight</span><span class="punctuation">:</span> 600<span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><h4 id="application-body">Application Body</h4><p>Finally, we use the current route to load the appropriate section and render it into the main part of the application:</p><pre><code><span class="keyword">const</span> <span class="function-variable">Body</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> <span class="punctuation">{</span>currentSection<span class="punctuation">,</span> currentDetailId<span class="punctuation">}</span> <span class="operator">=</span> <span class="function">useRoute</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> <span class="punctuation">[</span><span class="punctuation">,</span> Section<span class="punctuation">]</span> <span class="operator">=</span> <span class="constant">SECTIONS</span><span class="punctuation">[</span>currentSection<span class="punctuation">]</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>main</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Section</span></span> <span class="attr-name">detailId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>currentDetailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>main</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Again, this component has minimal styling:</p><pre><code><span class="selector">main</span> <span class="punctuation">{</span>
  <span class="property">padding</span><span class="punctuation">:</span> 0.5rem<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><h3 id="loading-the-data">Loading The Data</h3><p>We now move onto the more interesting data manipulation and rendering logic in the application.</p><p>The movie data for the application is sourced from TMDB and has been converted into a tab-separated variable format. TSV files are smaller and faster than JSON to load over the wire, but nonetheless, we load them asynchronously.</p><p>The logic here should be reasonably self-evident. We extract the column names from the top of the TSV, check each row has a matching cardinality, use the first column as the <a href="/api/store/type-aliases/store/row"><code>Row</code></a> <a href="/api/common/type-aliases/identity/id"><code>Id</code></a>, coerce numeric <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> values, and load everything into a standard <a href="/api/store/type-aliases/store/table"><code>Table</code></a>.</p><pre><code><span class="keyword">const</span> <span class="constant">NUMERIC</span> <span class="operator">=</span> <span class="regex"><span class="regex-delimiter">/</span><span class="regex-source">^[\d\.]+$</span><span class="regex-delimiter">/</span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">loadTable</span> <span class="operator">=</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">store<span class="punctuation">,</span> tableId</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> rows <span class="operator">=</span> <span class="punctuation">(</span>
    <span class="keyword">await</span> <span class="punctuation">(</span><span class="keyword">await</span> <span class="function">fetch</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">https://tinybase.org/assets/</span><span class="interpolation"><span class="interpolation-punctuation">${</span>tableId<span class="interpolation-punctuation">}</span></span><span class="string">.tsv</span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">text</span><span class="punctuation">(</span><span class="punctuation">)</span>
  <span class="punctuation">)</span><span class="punctuation">.</span><span class="function">split</span><span class="punctuation">(</span><span class="string">'\n'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> cellIds <span class="operator">=</span> rows<span class="punctuation">.</span><span class="function">shift</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">split</span><span class="punctuation">(</span><span class="string">'\t'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  rows<span class="punctuation">.</span><span class="function">forEach</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">row</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="keyword">const</span> cells <span class="operator">=</span> row<span class="punctuation">.</span><span class="function">split</span><span class="punctuation">(</span><span class="string">'\t'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span>cells<span class="punctuation">.</span>length <span class="operator">==</span> cellIds<span class="punctuation">.</span>length<span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">const</span> rowId <span class="operator">=</span> cells<span class="punctuation">.</span><span class="function">shift</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
      cells<span class="punctuation">.</span><span class="function">forEach</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">cell<span class="punctuation">,</span> c</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span>cell <span class="operator">!=</span> <span class="string">''</span><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">if</span> <span class="punctuation">(</span><span class="constant">NUMERIC</span><span class="punctuation">.</span><span class="function">test</span><span class="punctuation">(</span>cell<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
            cell <span class="operator">=</span> <span class="function">parseFloat</span><span class="punctuation">(</span>cell<span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span>
          store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellIds<span class="punctuation">[</span>c <span class="operator">+</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> cell<span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>There are four raw tables used in this application, as described in our opening section. We wait for all four to load (again, asynchronously) wrapped in a single <a href="/api/store/interfaces/store/store"><code>Store</code></a> transaction.</p><pre><code><span class="keyword">const</span> <span class="function-variable">loadStore</span> <span class="operator">=</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/starttransaction">startTransaction</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">await</span> Promise<span class="punctuation">.</span><span class="function">all</span><span class="punctuation">(</span>
    <span class="punctuation">[</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'cast'</span><span class="punctuation">]</span><span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">tableId</span><span class="punctuation">)</span> <span class="operator">=></span>
      <span class="function">loadTable</span><span class="punctuation">(</span>store<span class="punctuation">,</span> tableId<span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/finishtransaction">finishTransaction</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p><code>loadStore</code> was the function referenced in the <a href="#initializing-the-application">main <code>App</code> component</a>, so once this completes, the data is loaded and we&#x27;re ready to go.</p><h3 id="querying-the-data">Querying The Data</h3><p>As described <a href="#queries">at the start of this article</a>, there are a number of queries that are set up at the beginning of the app and which are used throughout its lifetime. These include the list of all movies with de-normalized genre, director, and cast names (a query called <code>movies</code>); and queries that group counts of movies by genre, year, and so on.</p><p>Since many queries throughout the app re-use the same set of fields - such as movie name, image, year, and genre - we can first create a re-usable function that specifies those <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a>. This can be used whenever the <code>movies</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> is the root of the query. When provided a <code>select</code> and <code>join</code> function, it selects those common columns:</p><pre><code><span class="keyword">const</span> <span class="function-variable">queryMovieBasics</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> movieId</span><span class="punctuation">)</span> <span class="operator">=></span> movieId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'rating'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'genreName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">join</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Notice that we use a convention in this app of suffixing <code>[</code>Id<code>](/api/common/type-aliases/identity/id)</code>, <code>Name</code> and <code>Image</code> to resulting <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a>.</p><p>In the <code>App</code> component we described at the start of the article, we call a function called <code>createAndInitQueries</code> to initialize the queries. Here&#x27;s its implementation:</p><pre><code><span class="keyword">const</span> <span class="function-variable">createAndInitQueries</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> queries <span class="operator">=</span> <span class="function"><a href="/api/queries/functions/creation/createqueries">createQueries</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="comment">// ...</span>
</code></pre><p>First we define the <code>movies</code> query that populates the main overview of the movies section of the app, and provides the detail about the movie&#x27;s overview, directors and cast.</p><p>The join to the <code>people</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> for the director name and image should be self-explanatory. What is slightly more interesting is the way we join to get the cast names and images. Each movie has up to three cast members captured in the <code>cast</code> many-to-many join <a href="/api/store/type-aliases/store/table"><code>Table</code></a> - and so we join through <em>that</em> table three times according to their billing.</p><pre><code><span class="comment">// ...</span>
queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">queryMovieBasics</span><span class="punctuation">(</span><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'overview'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span><span class="punctuation">.</span><span class="function">forEach</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">billing</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="keyword">const</span> castJoin <span class="operator">=</span> <span class="template-string"><span class="template-punctuation">`</span><span class="string">cast</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">;</span>
    <span class="function">join</span><span class="punctuation">(</span><span class="string">'cast'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> movieId</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="template-string"><span class="template-punctuation">`</span><span class="interpolation"><span class="interpolation-punctuation">${</span>movieId<span class="interpolation-punctuation">}</span></span><span class="string">/</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span>castJoin<span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span>castJoin<span class="punctuation">,</span> <span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castId</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">const</span> actorJoin <span class="operator">=</span> <span class="template-string"><span class="template-punctuation">`</span><span class="string">actors</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">;</span>
    <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> castJoin<span class="punctuation">,</span> <span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span>actorJoin<span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span>actorJoin<span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castName</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span>actorJoin<span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castImage</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// ...</span>
</code></pre><p>For the SQL-inclined amongst you, we&#x27;ve created something more or less equivalent to the following query:</p><pre><code><span class="comment">-- movies query</span>
<span class="keyword">SELECT</span>
  movies<span class="punctuation">.</span>_rowId <span class="keyword">AS</span> movieId<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>name <span class="keyword">AS</span> movieName<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>image <span class="keyword">AS</span> movieImage<span class="punctuation">,</span>
  movies<span class="punctuation">.</span><span class="keyword">year</span> <span class="keyword">AS</span> <span class="keyword">year</span><span class="punctuation">,</span>
  movies<span class="punctuation">.</span>rating <span class="keyword">AS</span> rating<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>genreId <span class="keyword">AS</span> genreId<span class="punctuation">,</span>
  genres<span class="punctuation">.</span>name <span class="keyword">AS</span> genreName<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>overview <span class="keyword">AS</span> overview<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>directorId <span class="keyword">AS</span> directorId<span class="punctuation">,</span>
  directors<span class="punctuation">.</span>name <span class="keyword">AS</span> directorName<span class="punctuation">,</span>
  directors<span class="punctuation">.</span>image <span class="keyword">AS</span> directorImage<span class="punctuation">,</span>
  cast1<span class="punctuation">.</span>castId <span class="keyword">AS</span> castId1<span class="punctuation">,</span>
  actors1<span class="punctuation">.</span>name <span class="keyword">AS</span> castName1<span class="punctuation">,</span>
  actors1<span class="punctuation">.</span>image <span class="keyword">AS</span> castImage1<span class="punctuation">,</span>
  cast2<span class="punctuation">.</span>castId <span class="keyword">AS</span> castId2<span class="punctuation">,</span>
  actors2<span class="punctuation">.</span>name <span class="keyword">AS</span> castName2<span class="punctuation">,</span>
  actors2<span class="punctuation">.</span>image <span class="keyword">AS</span> castImage2<span class="punctuation">,</span>
  cast3<span class="punctuation">.</span>castId <span class="keyword">AS</span> castId3<span class="punctuation">,</span>
  actors3<span class="punctuation">.</span>name <span class="keyword">AS</span> castName3<span class="punctuation">,</span>
  actors3<span class="punctuation">.</span>image <span class="keyword">AS</span> castImage3
<span class="keyword">FROM</span>
  movies
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> genres
      <span class="keyword">ON</span> genres<span class="punctuation">.</span>_rowId <span class="operator">=</span> movies<span class="punctuation">.</span>genreId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> directors
      <span class="keyword">ON</span> directors<span class="punctuation">.</span>_rowId <span class="operator">=</span> movies<span class="punctuation">.</span>directorId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> cast <span class="keyword">AS</span> cast1
      <span class="keyword">ON</span> cast1<span class="punctuation">.</span>_rowId <span class="operator">=</span> CONCAT<span class="punctuation">(</span>movies<span class="punctuation">.</span>movieId<span class="punctuation">,</span> <span class="string">'/1'</span><span class="punctuation">)</span>
      <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> actors1
        <span class="keyword">ON</span> actors1<span class="punctuation">.</span>_rowId <span class="operator">=</span> cast1<span class="punctuation">.</span>castId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> cast <span class="keyword">AS</span> cast2
      <span class="keyword">ON</span> cast2<span class="punctuation">.</span>_rowId <span class="operator">=</span> CONCAT<span class="punctuation">(</span>movies<span class="punctuation">.</span>movieId<span class="punctuation">,</span> <span class="string">'/2'</span><span class="punctuation">)</span>
      <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> actors2
        <span class="keyword">ON</span> actors2<span class="punctuation">.</span>_rowId <span class="operator">=</span> cast2<span class="punctuation">.</span>castId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> cast <span class="keyword">AS</span> cast3
      <span class="keyword">ON</span> cast3<span class="punctuation">.</span>_rowId <span class="operator">=</span> CONCAT<span class="punctuation">(</span>movies<span class="punctuation">.</span>movieId<span class="punctuation">,</span> <span class="string">'/3'</span><span class="punctuation">)</span>
      <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> actors3
        <span class="keyword">ON</span> actors3<span class="punctuation">.</span>_rowId <span class="operator">=</span> cast3<span class="punctuation">.</span>castId
</code></pre><p>(Except the results in our case are reactive - not something you usually get to benefit from with a SQL-based database!)</p><p>We also create query definitions for the other persistent queries. These use the <code>group</code> function to count the number of movies per year, genre, and so on, used in the overview components of each of the main sections of the app.</p><pre><code>  <span class="comment">// ...</span>
  queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'years'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> rowId</span><span class="punctuation">)</span> <span class="operator">=></span> rowId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

  queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> rowId</span><span class="punctuation">)</span> <span class="operator">=></span> rowId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">join</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'genreName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

  queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> rowId</span><span class="punctuation">)</span> <span class="operator">=></span> rowId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'popularity'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

  queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'cast'</span><span class="punctuation">,</span> <span class="string">'cast'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'castName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'castImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'popularity'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> queries<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><p>That&#x27;s it for the main persistent queries that power most of the major views of the app. We&#x27;ll refer to these by their query <a href="/api/common/type-aliases/identity/id"><code>Id</code></a> when we actually bind them to components.</p><h3 id="the-resultsortablegrid-component">The <code>ResultSortableGrid</code> Component</h3><p>Most of the movies app is built from tabular data views, and it&#x27;s nice to have a re-usable <code>&lt;table&gt;</code> rendering, complete with sorting, pagination, and formatting.</p><p>Here we introduce a common component that takes a query <a href="/api/common/type-aliases/identity/id"><code>Id</code></a>, a configuration array for the columns to render, and options for sorting and pagination. It&#x27;s fully self-contained in terms of managing its own state, and wraps the underlying <code>ResultSortedTableView</code> provided by the <a href="/">TinyBase</a> <a href="/api/ui-react"><code>ui-react</code></a> module.</p><p>The <code>columns</code> prop is an array of <code>[cellId, label, component?]</code> entries, that describe the <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> of the query to get the value from, the label to put in the top header, and optionally, a custom way to render the values. We&#x27;ll use this to render movie posters next to their links, for example.</p><p>Note that we have <code>defaultDescending</code> default to <code>true</code>, since in this movies app, nearly every useful initial sorting (rating, popularity, year) is downward.</p><p>Otherwise, there is nothing movie-specific about this component! So you may find it useful to take this verbatim for yourself, whenever you need to render tabular query data.</p><pre><code><span class="keyword">const</span> ResultSortableGrid <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">{</span>
  queryId<span class="punctuation">,</span>
  columns<span class="punctuation">,</span>
  defaultSortCellId<span class="punctuation">,</span>
  defaultDescending <span class="operator">=</span> <span class="boolean">true</span><span class="punctuation">,</span>
  limit <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span>
  noun <span class="operator">=</span> <span class="string">'record'</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> columnsKey <span class="operator">=</span> <span class="constant">JSON</span><span class="punctuation">.</span><span class="function">stringify</span><span class="punctuation">(</span>columns<span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> <span class="punctuation">[</span>sortCellId<span class="punctuation">,</span> setSortCellId<span class="punctuation">]</span> <span class="operator">=</span> <span class="function">useState</span><span class="punctuation">(</span>defaultSortCellId<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> <span class="punctuation">[</span>descending<span class="punctuation">,</span> setDescending<span class="punctuation">]</span> <span class="operator">=</span> <span class="function">useState</span><span class="punctuation">(</span>defaultDescending<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> <span class="punctuation">[</span>offset<span class="punctuation">,</span> setOffset<span class="punctuation">]</span> <span class="operator">=</span> <span class="function">useState</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> count <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultrowids">useResultRowIds</a></span><span class="punctuation">(</span>queryId<span class="punctuation">)</span><span class="punctuation">.</span>length<span class="punctuation">;</span>

  <span class="keyword">if</span> <span class="punctuation">(</span>offset <span class="operator">></span> count<span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="function">setOffset</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">const</span> Pagination <span class="operator">=</span> <span class="function">useCallback</span><span class="punctuation">(</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="punctuation">{</span>count<span class="punctuation">}</span><span class="plain-text"> </span><span class="punctuation">{</span>noun<span class="punctuation">}</span><span class="plain-text">
        </span><span class="punctuation">{</span>count <span class="operator">!=</span> <span class="number">1</span> <span class="operator">?</span> <span class="string">'s'</span> <span class="operator">:</span> <span class="string">''</span><span class="punctuation">}</span><span class="plain-text">
        </span><span class="punctuation">{</span>count <span class="operator">></span> limit <span class="operator">&amp;&amp;</span> <span class="punctuation">(</span>
          <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
            </span><span class="punctuation">{</span>offset <span class="operator">></span> <span class="number">0</span> <span class="operator">?</span> <span class="punctuation">(</span>
              <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>button</span>
                <span class="attr-name">className</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>prev<span class="punctuation">"</span></span>
                <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">setOffset</span><span class="punctuation">(</span>offset <span class="operator">-</span> limit<span class="punctuation">)</span><span class="punctuation">}</span></span>
              <span class="punctuation">/></span></span>
            <span class="punctuation">)</span> <span class="operator">:</span> <span class="punctuation">(</span>
              <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>button</span> <span class="attr-name">className</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>prev disabled<span class="punctuation">"</span></span> <span class="punctuation">/></span></span>
            <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
            </span><span class="punctuation">{</span>offset <span class="operator">+</span> limit <span class="operator">&lt;</span> count <span class="operator">?</span> <span class="punctuation">(</span>
              <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>button</span>
                <span class="attr-name">className</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>next<span class="punctuation">"</span></span>
                <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">setOffset</span><span class="punctuation">(</span>offset <span class="operator">+</span> limit<span class="punctuation">)</span><span class="punctuation">}</span></span>
              <span class="punctuation">/></span></span>
            <span class="punctuation">)</span> <span class="operator">:</span> <span class="punctuation">(</span>
              <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>button</span> <span class="attr-name">className</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>next disabled<span class="punctuation">"</span></span> <span class="punctuation">/></span></span>
            <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
            </span><span class="punctuation">{</span>offset <span class="operator">+</span> <span class="number">1</span><span class="punctuation">}</span><span class="plain-text"> to </span><span class="punctuation">{</span>Math<span class="punctuation">.</span><span class="function">min</span><span class="punctuation">(</span>count<span class="punctuation">,</span> offset <span class="operator">+</span> limit<span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
        <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
    <span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>count<span class="punctuation">,</span> offset<span class="punctuation">,</span> limit<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> HeadingComponent <span class="operator">=</span> <span class="function">useCallback</span><span class="punctuation">(</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>tr</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="punctuation">{</span>columns<span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter"><span class="punctuation">[</span>cellId<span class="punctuation">,</span> label<span class="punctuation">]</span><span class="punctuation">,</span> c</span><span class="punctuation">)</span> <span class="operator">=></span>
          cellId <span class="operator">==</span> sortCellId <span class="operator">?</span> <span class="punctuation">(</span>
            <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>th</span>
              <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">setDescending</span><span class="punctuation">(</span><span class="operator">!</span>descending<span class="punctuation">)</span><span class="punctuation">}</span></span>
              <span class="attr-name">className</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">col</span><span class="interpolation"><span class="interpolation-punctuation">${</span>c<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span>
            <span class="punctuation">></span></span><span class="plain-text">
              </span><span class="punctuation">{</span>descending <span class="operator">?</span> <span class="string">'\u2193'</span> <span class="operator">:</span> <span class="string">'\u2191'</span><span class="punctuation">}</span><span class="plain-text"> </span><span class="punctuation">{</span>label<span class="punctuation">}</span><span class="plain-text">
            </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>th</span><span class="punctuation">></span></span>
          <span class="punctuation">)</span> <span class="operator">:</span> <span class="punctuation">(</span>
            <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>th</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">setSortCellId</span><span class="punctuation">(</span>cellId<span class="punctuation">)</span><span class="punctuation">}</span></span> <span class="attr-name">className</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">col</span><span class="interpolation"><span class="interpolation-punctuation">${</span>c<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
              </span><span class="punctuation">{</span>label<span class="punctuation">}</span><span class="plain-text">
            </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>th</span><span class="punctuation">></span></span>
          <span class="punctuation">)</span><span class="punctuation">,</span>
        <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>tr</span><span class="punctuation">></span></span>
    <span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>sortCellId<span class="punctuation">,</span> descending<span class="punctuation">,</span> columnsKey<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> RowComponent <span class="operator">=</span> <span class="function">useCallback</span><span class="punctuation">(</span>
    <span class="punctuation">(</span><span class="parameter">props</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>tr</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="punctuation">{</span>columns<span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter"><span class="punctuation">[</span>cellId<span class="punctuation">,</span> <span class="punctuation">,</span> CellComponent<span class="punctuation">]</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
          <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>td</span><span class="punctuation">></span></span><span class="plain-text">
            </span><span class="punctuation">{</span>CellComponent <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="punctuation">(</span>
              <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>cellId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
            <span class="punctuation">)</span> <span class="operator">:</span> <span class="punctuation">(</span>
              <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">CellComponent</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
            <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>td</span><span class="punctuation">></span></span>
        <span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>tr</span><span class="punctuation">></span></span>
    <span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>columnsKey<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Pagination</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>table</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">HeadingComponent</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultsortedtableview">ResultSortedTableView</a></span></span>
          <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span>
          <span class="attr-name">cellId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>sortCellId<span class="punctuation">}</span></span>
          <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>descending<span class="punctuation">}</span></span>
          <span class="attr-name">offset</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>offset<span class="punctuation">}</span></span>
          <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>limit<span class="punctuation">}</span></span>
          <span class="attr-name">resultRowComponent</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>RowComponent<span class="punctuation">}</span></span>
        <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>table</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>This component also benefits from some light styling for the pagination buttons and the table itself:</p><pre><code><span class="selector">button</span> <span class="punctuation">{</span>
  <span class="property">border</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
  <span class="property">cursor</span><span class="punctuation">:</span> pointer<span class="punctuation">;</span>
  <span class="property">height</span><span class="punctuation">:</span> 1rem<span class="punctuation">;</span>
  <span class="property">padding</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
  <span class="property">vertical-align</span><span class="punctuation">:</span> text<span class="operator">-</span>top<span class="punctuation">;</span>
  <span class="property">width</span><span class="punctuation">:</span> 1rem<span class="punctuation">;</span>
  <span class="selector">&amp;.prev</span> <span class="punctuation">{</span>
    <span class="property">margin-left</span><span class="punctuation">:</span> 0.5rem<span class="punctuation">;</span>
    <span class="selector">&amp;::before</span> <span class="punctuation">{</span>
      <span class="property">content</span><span class="punctuation">:</span> <span class="url"><span class="function">url</span><span class="punctuation">(</span><span class="string">'data:image/svg+xml,&lt;svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 100 100" fill="black">&lt;path d="M65 20v60l-30-30z" />&lt;/svg>'</span><span class="punctuation">)</span></span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
  <span class="selector">&amp;.next</span> <span class="punctuation">{</span>
    <span class="property">margin-right</span><span class="punctuation">:</span> 0.5rem<span class="punctuation">;</span>
    <span class="selector">&amp;::before</span> <span class="punctuation">{</span>
      <span class="property">content</span><span class="punctuation">:</span> <span class="url"><span class="function">url</span><span class="punctuation">(</span><span class="string">'data:image/svg+xml,&lt;svg xmlns="http://www.w3.org/2000/svg" height="1rem" viewBox="0 0 100 100" fill="black">&lt;path d="M35 20v60l30-30z" />&lt;/svg>'</span><span class="punctuation">)</span></span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
  <span class="selector">&amp;.disabled</span> <span class="punctuation">{</span>
    <span class="property">cursor</span><span class="punctuation">:</span> default<span class="punctuation">;</span>
    <span class="property">opacity</span><span class="punctuation">:</span> 0.3<span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>

<span class="selector">table</span> <span class="punctuation">{</span>
  <span class="property">border-collapse</span><span class="punctuation">:</span> collapse<span class="punctuation">;</span>
  <span class="property">font-size</span><span class="punctuation">:</span> inherit<span class="punctuation">;</span>
  <span class="property">line-height</span><span class="punctuation">:</span> inherit<span class="punctuation">;</span>
  <span class="property">margin-top</span><span class="punctuation">:</span> 0.5rem<span class="punctuation">;</span>
  <span class="property">table-layout</span><span class="punctuation">:</span> fixed<span class="punctuation">;</span>
  <span class="property">width</span><span class="punctuation">:</span> 100%<span class="punctuation">;</span>
  <span class="selector">th,
  td</span> <span class="punctuation">{</span>
    <span class="property">overflow</span><span class="punctuation">:</span> hidden<span class="punctuation">;</span>
    <span class="property">padding</span><span class="punctuation">:</span> 0.25rem 0.5rem 0.25rem 0<span class="punctuation">;</span>
    <span class="property">white-space</span><span class="punctuation">:</span> nowrap<span class="punctuation">;</span>
  <span class="punctuation">}</span>
  <span class="selector">th</span> <span class="punctuation">{</span>
    <span class="property">border</span><span class="punctuation">:</span> solid #ddd<span class="punctuation">;</span>
    <span class="property">border-width</span><span class="punctuation">:</span> 1px 0<span class="punctuation">;</span>
    <span class="property">cursor</span><span class="punctuation">:</span> pointer<span class="punctuation">;</span>
    <span class="property">text-align</span><span class="punctuation">:</span> left<span class="punctuation">;</span>
    <span class="selector">&amp;.col0</span> <span class="punctuation">{</span>
      <span class="property">width</span><span class="punctuation">:</span> 40%<span class="punctuation">;</span>
    <span class="punctuation">}</span>
    <span class="selector">&amp;.col1,
    &amp;.col2,
    &amp;.col3</span> <span class="punctuation">{</span>
      <span class="property">width</span><span class="punctuation">:</span> 20%<span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
  <span class="selector">td</span> <span class="punctuation">{</span>
    <span class="property">border-bottom</span><span class="punctuation">:</span> 1px solid #eee<span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><h3 id="overview-components">Overview Components</h3><p>We now use that component to create the major views of the application.</p><p>First, the overview of all the rated movies in the database (which displays on the &#x27;Movies&#x27; tab when the app first loads), comprising a <code>ResultSortableGrid</code> that renders the <code>movies</code> query with four columns, sorted by rating.</p><pre><code><span class="keyword">const</span> <span class="function-variable">MoviesOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>Rated movies<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movies<span class="punctuation">"</span></span>
      <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
        <span class="punctuation">[</span><span class="string">'movieName'</span><span class="punctuation">,</span> <span class="string">'Movie'</span><span class="punctuation">,</span> MovieLink<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'year'</span><span class="punctuation">,</span> <span class="string">'Year'</span><span class="punctuation">,</span> YearLink<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'rating'</span><span class="punctuation">,</span> <span class="string">'Rating'</span><span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'genreName'</span><span class="punctuation">,</span> <span class="string">'Genre'</span><span class="punctuation">,</span> GenreLink<span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="punctuation">]</span><span class="punctuation">}</span></span>
      <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
      <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movie<span class="punctuation">"</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>Note how three of the columns are given a custom component to render the value not as raw text but as a link. We&#x27;ll describe <a href="#linking-between-views">those simple components</a> later.</p><p>The &#x27;Years&#x27; tab renders the <code>years</code> query with two columns: the year and the number of movies in that year:</p><pre><code><span class="keyword">const</span> <span class="function-variable">YearsOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>Years<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>years<span class="punctuation">"</span></span>
      <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
        <span class="punctuation">[</span><span class="string">'year'</span><span class="punctuation">,</span> <span class="string">'Year'</span><span class="punctuation">,</span> YearLink<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'movieCount'</span><span class="punctuation">,</span> <span class="string">'Rated movies'</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="punctuation">]</span><span class="punctuation">}</span></span>
      <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>year<span class="punctuation">"</span></span>
      <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>year<span class="punctuation">"</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>Similarly, the &#x27;Genres&#x27; tab renders the <code>genres</code> query with two columns: the genre and the number of movies in that genre:</p><pre><code><span class="keyword">const</span> <span class="function-variable">GenresOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>Genres<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>genres<span class="punctuation">"</span></span>
      <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
        <span class="punctuation">[</span><span class="string">'genreName'</span><span class="punctuation">,</span> <span class="string">'Genre'</span><span class="punctuation">,</span> GenreLink<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'movieCount'</span><span class="punctuation">,</span> <span class="string">'Rated movies'</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="punctuation">]</span><span class="punctuation">}</span></span>
      <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieCount<span class="punctuation">"</span></span>
      <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>genre<span class="punctuation">"</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>Finally, the &#x27;People&#x27; tab renders two tables: the <code>directors</code> query and the <code>cast</code> query with four columns each, both sorted by popularity:</p><pre><code><span class="keyword">const</span> <span class="function-variable">PeopleOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>People<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">Directors</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>directors<span class="punctuation">"</span></span>
      <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
        <span class="punctuation">[</span><span class="string">'directorName'</span><span class="punctuation">,</span> <span class="string">'Director'</span><span class="punctuation">,</span> DirectorLink<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'gender'</span><span class="punctuation">,</span> <span class="string">'Gender'</span><span class="punctuation">,</span> GenderFromQuery<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'popularity'</span><span class="punctuation">,</span> <span class="string">'Popularity'</span><span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'movieCount'</span><span class="punctuation">,</span> <span class="string">'Rated movies'</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="punctuation">]</span><span class="punctuation">}</span></span>
      <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>popularity<span class="punctuation">"</span></span>
      <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>director<span class="punctuation">"</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">Cast</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>cast<span class="punctuation">"</span></span>
      <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
        <span class="punctuation">[</span><span class="string">'castName'</span><span class="punctuation">,</span> <span class="string">'Cast'</span><span class="punctuation">,</span> CastLink<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'gender'</span><span class="punctuation">,</span> <span class="string">'Gender'</span><span class="punctuation">,</span> GenderFromQuery<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'popularity'</span><span class="punctuation">,</span> <span class="string">'Popularity'</span><span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">[</span><span class="string">'movieCount'</span><span class="punctuation">,</span> <span class="string">'Rated movies'</span><span class="punctuation">]</span><span class="punctuation">,</span>
      <span class="punctuation">]</span><span class="punctuation">}</span></span>
      <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>popularity<span class="punctuation">"</span></span>
      <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>actor<span class="punctuation">"</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>Click through each of the section headings in the app so you can see how each of these is working.</p><h3 id="detail-components">Detail Components</h3><p>We also have a detail view for each section, which drills into a specific movie, year, genre, or person. Firstly, for a single movie, we isolate a row in the de-normalized <code>movies</code> query and render its <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> values in a page format:</p><pre><code><span class="keyword">const</span> <span class="function-variable">MovieDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>movieId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> props <span class="operator">=</span> <span class="punctuation">{</span><span class="literal-property">queryId</span><span class="operator">:</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="literal-property">rowId</span><span class="operator">:</span> movieId<span class="punctuation">}</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> movieId<span class="punctuation">,</span> <span class="string">'movieName'</span><span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieImage<span class="punctuation">"</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Year: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">YearLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Genre: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenreLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Rating: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>p</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>overview<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>p</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">Credits</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">DirectorLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">, director
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">CastLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">billing</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">1</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">CastLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">billing</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">2</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">CastLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">billing</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">3</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Again, note how we are often using custom components that take the <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> values from this result <a href="/api/store/type-aliases/store/row"><code>Row</code></a> to make links to other parts of the app. We&#x27;ll describe those shortly.</p><p>Moving on, the detail for a specific year is just a sorted table of the movies from that year.</p><p>But here is a case where we need to run the query within the component (rather than globally across the app). The <code>moviesForYear</code> query is constructed whenever the <code>year</code> prop changes, and uses the <code>where</code> function to show the basic movie data for just those movies matching that year. We get to benefit from the <code>queryMovieBasics</code> function again since we just need movie <a href="/api/common/type-aliases/identity/id"><code>Id</code></a>, name, rating and genre.</p><pre><code><span class="keyword">const</span> <span class="function-variable">YearDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>year<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> queries <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/usequeries">useQueries</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">useMemo</span><span class="punctuation">(</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
      queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span>
        <span class="string">'moviesForYear'</span><span class="punctuation">,</span>
        <span class="string">'movies'</span><span class="punctuation">,</span>
        <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> where<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
          <span class="function">queryMovieBasics</span><span class="punctuation">(</span><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="function">where</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">,</span> year<span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span><span class="punctuation">,</span>
      <span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>year<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">Movies from </span><span class="interpolation"><span class="interpolation-punctuation">${</span>year<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
        <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>moviesForYear<span class="punctuation">"</span></span>
        <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
          <span class="punctuation">[</span><span class="string">'movieName'</span><span class="punctuation">,</span> <span class="string">'Movie'</span><span class="punctuation">,</span> MovieLink<span class="punctuation">]</span><span class="punctuation">,</span>
          <span class="punctuation">[</span><span class="string">'rating'</span><span class="punctuation">,</span> <span class="string">'Rating'</span><span class="punctuation">]</span><span class="punctuation">,</span>
          <span class="punctuation">[</span><span class="string">'genre'</span><span class="punctuation">,</span> <span class="string">'Genre'</span><span class="punctuation">,</span> GenreLink<span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">]</span><span class="punctuation">}</span></span>
        <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
        <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movie<span class="punctuation">"</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>The genre detail page is very similar, with a <code>where</code> clause to match the genre&#x27;s <a href="/api/common/type-aliases/identity/id"><code>Id</code></a>:</p><pre><code><span class="keyword">const</span> <span class="function-variable">GenreDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>genreId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> queries <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/usequeries">useQueries</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">useMemo</span><span class="punctuation">(</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
      queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span>
        <span class="string">'moviesForGenre'</span><span class="punctuation">,</span>
        <span class="string">'movies'</span><span class="punctuation">,</span>
        <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> where<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
          <span class="function">queryMovieBasics</span><span class="punctuation">(</span><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="function">where</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">,</span> genreId<span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span><span class="punctuation">,</span>
      <span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>genreId<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="interpolation"><span class="interpolation-punctuation">${</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usecell">useCell</a></span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> genreId<span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="interpolation-punctuation">}</span></span><span class="string"> movies</span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
        <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>moviesForGenre<span class="punctuation">"</span></span>
        <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
          <span class="punctuation">[</span><span class="string">'movieName'</span><span class="punctuation">,</span> <span class="string">'Movie'</span><span class="punctuation">,</span> MovieLink<span class="punctuation">]</span><span class="punctuation">,</span>
          <span class="punctuation">[</span><span class="string">'year'</span><span class="punctuation">,</span> <span class="string">'Year'</span><span class="punctuation">,</span> YearLink<span class="punctuation">]</span><span class="punctuation">,</span>
          <span class="punctuation">[</span><span class="string">'rating'</span><span class="punctuation">,</span> <span class="string">'Rating'</span><span class="punctuation">]</span><span class="punctuation">,</span>
        <span class="punctuation">]</span><span class="punctuation">}</span></span>
        <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
        <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movie<span class="punctuation">"</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Finally, we build the detail page for a person. We create two queries on the fly here, one for those movies for which the person is the director, and one for those in which they are cast.</p><p>The latter is slightly more complex since it needs to use the many-to-many <code>cast</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> as its root, from where it joins to the <code>movies</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> and <code>genres</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> in turn. Nevertheless, the result <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a> are named to be consistent with the other queries, so that we can use the same custom components to render each part of the HTML table.</p><p>This component is also slightly more complex that the others because it is also rendering some parts of its content directly from the <code>people</code> <a href="/api/store/type-aliases/store/table"><code>Table</code></a> (rather than via a query) - hence the use of the basic <code>useCell</code> hook and <code>CellView</code> component, for example.</p><pre><code><span class="keyword">const</span> <span class="function-variable">PersonDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>personId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> queries <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/usequeries">useQueries</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">useMemo</span><span class="punctuation">(</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
      queries
        <span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span>
          <span class="string">'moviesForDirector'</span><span class="punctuation">,</span>
          <span class="string">'movies'</span><span class="punctuation">,</span>
          <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> where<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
            <span class="function">queryMovieBasics</span><span class="punctuation">(</span><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">where</span><span class="punctuation">(</span><span class="string">'directorId'</span><span class="punctuation">,</span> personId<span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span><span class="punctuation">,</span>
        <span class="punctuation">)</span>
        <span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition">setQueryDefinition</a></span><span class="punctuation">(</span>
          <span class="string">'moviesForCast'</span><span class="punctuation">,</span>
          <span class="string">'cast'</span><span class="punctuation">,</span>
          <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> where<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
            <span class="function">select</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'rating'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">select</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'genreName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">join</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">join</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
            <span class="function">where</span><span class="punctuation">(</span><span class="string">'castId'</span><span class="punctuation">,</span> personId<span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span><span class="punctuation">,</span>
        <span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>personId<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> props <span class="operator">=</span> <span class="punctuation">{</span><span class="literal-property">tableId</span><span class="operator">:</span> <span class="string">'people'</span><span class="punctuation">,</span> <span class="literal-property">rowId</span><span class="operator">:</span> personId<span class="punctuation">}</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usecell">useCell</a></span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromTable</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>image<span class="punctuation">"</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Gender: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenderFromTable</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Born: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>born<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
          </span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usecell">useCell</a></span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">,</span> <span class="string">'died'</span><span class="punctuation">)</span> <span class="operator">&amp;&amp;</span> <span class="punctuation">(</span>
            <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
              ; died: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>died<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
            </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
          <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Popularity: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>popularity<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>p</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>biography<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>p</span><span class="punctuation">></span></span><span class="plain-text">

      </span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultrowids">useResultRowIds</a></span><span class="punctuation">(</span><span class="string">'moviesForDirector'</span><span class="punctuation">)</span><span class="punctuation">.</span>length <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
        <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">As director:</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
            <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>moviesForDirector<span class="punctuation">"</span></span>
            <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
              <span class="punctuation">[</span><span class="string">'movieName'</span><span class="punctuation">,</span> <span class="string">'Movie'</span><span class="punctuation">,</span> MovieLink<span class="punctuation">]</span><span class="punctuation">,</span>
              <span class="punctuation">[</span><span class="string">'year'</span><span class="punctuation">,</span> <span class="string">'Year'</span><span class="punctuation">,</span> YearLink<span class="punctuation">]</span><span class="punctuation">,</span>
              <span class="punctuation">[</span><span class="string">'rating'</span><span class="punctuation">,</span> <span class="string">'Rating'</span><span class="punctuation">]</span><span class="punctuation">,</span>
            <span class="punctuation">]</span><span class="punctuation">}</span></span>
            <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
            <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rated movie<span class="punctuation">"</span></span>
          <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
      <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">

      </span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultrowids">useResultRowIds</a></span><span class="punctuation">(</span><span class="string">'moviesForCast'</span><span class="punctuation">)</span><span class="punctuation">.</span>length <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
        <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">As cast:</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ResultSortableGrid</span></span>
            <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>moviesForCast<span class="punctuation">"</span></span>
            <span class="attr-name">columns</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">[</span>
              <span class="punctuation">[</span><span class="string">'movieName'</span><span class="punctuation">,</span> <span class="string">'Movie'</span><span class="punctuation">,</span> MovieLink<span class="punctuation">]</span><span class="punctuation">,</span>
              <span class="punctuation">[</span><span class="string">'year'</span><span class="punctuation">,</span> <span class="string">'Year'</span><span class="punctuation">,</span> YearLink<span class="punctuation">]</span><span class="punctuation">,</span>
              <span class="punctuation">[</span><span class="string">'rating'</span><span class="punctuation">,</span> <span class="string">'Rating'</span><span class="punctuation">]</span><span class="punctuation">,</span>
            <span class="punctuation">]</span><span class="punctuation">}</span></span>
            <span class="attr-name">defaultSortCellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
            <span class="attr-name">noun</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rated movie<span class="punctuation">"</span></span>
          <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
      <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><h3 id="linking-between-views">Linking Between Views</h3><p>When you click on a movie name (wherever you see it), we&#x27;ll want to take you to the movie detail. Clicking a year should take you to the list of movies for the year, a genre to the list of movies in a genre - and so on.</p><p>Here we create a collection of tiny custom components which, when passed a <code>queryId</code> and <code>rowId</code> can render a decorated link which, when clicked, update the application&#x27;s route. We&#x27;ve been using these in the <code>ResultSortableGrid</code> instances above.</p><p>For example, the <code>MovieLink</code> component creates a link that sets the route to be the <code>movies</code> section, with the value of the <code>movieId</code> <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> from the result <a href="/api/store/type-aliases/store/row"><code>Row</code></a> being rendered. The <code>ImageFromQuery</code> component we&#x27;ll discuss later.</p><p>This component obviously assumes that the <code>movieId</code>, <code>movieImage</code>, and <code>movieName</code> <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a> are present in the query, so we only use this for queries that meaningfully populate those.</p><pre><code><span class="keyword">const</span> <span class="function-variable">MovieLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> movieId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> movieId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieImage<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieName<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>We do the same for queries that contain a <code>year</code> <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/id"><code>Id</code></a>, for those that contain <code>genreId</code> and <code>genreName</code> <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a>, and for those that contain <code>directorId</code> and <code>directorName</code> <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids"><code>Ids</code></a>:</p><pre><code><span class="keyword">const</span> <span class="function-variable">YearLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> year <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'years'</span><span class="punctuation">,</span> year<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>year<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">GenreLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> genreId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> genreId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>genreName<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">DirectorLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> personId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>directorImage<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>directorName<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>We do the same for actors, but for the billed cast members we need to check tor existence, in case a movie does not have three actors:</p><pre><code><span class="keyword">const</span> <span class="function-variable">CastLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> billing <span class="operator">=</span> <span class="number">1</span><span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> personId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="template-string"><span class="template-punctuation">`</span><span class="string">castId</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> personId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span>
        <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span>
        <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span>
        <span class="attr-name">cellId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castImage</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview">ResultCellView</a></span></span>
        <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span>
        <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span>
        <span class="attr-name">cellId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castName</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><h3 id="final-helper-components">Final Helper Components</h3><p>We conclude with a few simple components that we&#x27;ve been using across the application.</p><p>These take the numeric TMDB gender <a href="/api/common/type-aliases/identity/id"><code>Id</code></a> (from the <a href="/api/store/type-aliases/store/row"><code>Row</code></a> of a <a href="/api/store/type-aliases/store/table"><code>Table</code></a> or the result <a href="/api/store/type-aliases/store/row"><code>Row</code></a> of query) and render it as a string:</p><pre><code><span class="keyword">const</span> <span class="function-variable">GenderFromQuery</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  <span class="function">genderString</span><span class="punctuation">(</span><span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">GenderFromTable</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  <span class="function">genderString</span><span class="punctuation">(</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usecell">useCell</a></span><span class="punctuation">(</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">genderString</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">genderId</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">switch</span> <span class="punctuation">(</span>genderId<span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">case</span> <span class="number">1</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Female'</span><span class="punctuation">;</span>
    <span class="keyword">case</span> <span class="number">2</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Male'</span><span class="punctuation">;</span>
    <span class="keyword">case</span> <span class="number">3</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Non-binary'</span><span class="punctuation">;</span>
    <span class="keyword">default</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Unknown'</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>These take a TMDB image path (again from the <a href="/api/store/type-aliases/store/row"><code>Row</code></a> of a <a href="/api/store/type-aliases/store/table"><code>Table</code></a> or the result <a href="/api/store/type-aliases/store/row"><code>Row</code></a> of query) and render it in large or small format:</p><pre><code><span class="keyword">const</span> <span class="function-variable">ImageFromQuery</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">,</span> isLarge<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Image</span></span> <span class="attr-name">imageFile</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">)</span><span class="punctuation">}</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>isLarge<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">ImageFromTable</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">,</span> isLarge<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Image</span></span> <span class="attr-name">imageFile</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usecell">useCell</a></span><span class="punctuation">(</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">)</span><span class="punctuation">}</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>isLarge<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">Image</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>imageFile<span class="punctuation">,</span> isLarge<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>img</span>
    <span class="attr-name">src</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">https://image.tmdb.org/t/p/w</span><span class="interpolation"><span class="interpolation-punctuation">${</span>isLarge <span class="operator">?</span> <span class="number">92</span> <span class="operator">:</span> <span class="number">45</span><span class="interpolation-punctuation">}</span></span><span class="interpolation"><span class="interpolation-punctuation">${</span>imageFile<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span>
    <span class="attr-name">className</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>isLarge <span class="operator">?</span> <span class="string">'large'</span> <span class="operator">:</span> <span class="string">''</span><span class="punctuation">}</span></span>
  <span class="punctuation">/></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>These images have some light styling:</p><pre><code><span class="selector">img</span> <span class="punctuation">{</span>
  <span class="property">width</span><span class="punctuation">:</span> 1rem<span class="punctuation">;</span>
  <span class="property">height</span><span class="punctuation">:</span> 1.5rem<span class="punctuation">;</span>
  <span class="property">object-fit</span><span class="punctuation">:</span> cover<span class="punctuation">;</span>
  <span class="property">vertical-align</span><span class="punctuation">:</span> top<span class="punctuation">;</span>
  <span class="property">margin</span><span class="punctuation">:</span> 0 0.25rem 0 0<span class="punctuation">;</span>
  <span class="selector">&amp;.large</span> <span class="punctuation">{</span>
    <span class="property">width</span><span class="punctuation">:</span> 4rem<span class="punctuation">;</span>
    <span class="property">height</span><span class="punctuation">:</span> 6rem<span class="punctuation">;</span>
    <span class="property">margin</span><span class="punctuation">:</span> 0 0.5rem 1rem 0<span class="punctuation">;</span>
    <span class="property">object-fit</span><span class="punctuation">:</span> contain<span class="punctuation">;</span>
    <span class="property">float</span><span class="punctuation">:</span> left<span class="punctuation">;</span>
    <span class="selector">+ ul + *</span> <span class="punctuation">{</span>
      <span class="property">clear</span><span class="punctuation">:</span> both<span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><p>And finally, this trivial component just wraps the main view of the application to apply a consistent title to the top of each page:</p><pre><code><span class="keyword">const</span> <span class="function-variable">Page</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>title<span class="punctuation">,</span> children<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h1</span><span class="punctuation">></span></span><span class="punctuation">{</span>title<span class="punctuation">}</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h1</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="punctuation">{</span>children<span class="punctuation">}</span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>That&#x27;s it for the JavaScript!</p><h3 id="default-styling">Default Styling</h3><p>Just for completeness, here is the default CSS styling and typography that the app uses:</p><pre><code><span class="atrule">@font-face</span> <span class="punctuation">{</span>
  <span class="property">font-family</span><span class="punctuation">:</span> Lato<span class="punctuation">;</span>
  <span class="property">src</span><span class="punctuation">:</span> <span class="url"><span class="function">url</span><span class="punctuation">(</span>https://tinybase.org/fonts/lato-light.woff2<span class="punctuation">)</span></span> <span class="function">format</span><span class="punctuation">(</span><span class="string">'woff2'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="property">font-weight</span><span class="punctuation">:</span> 400<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="atrule">@font-face</span> <span class="punctuation">{</span>
  <span class="property">font-family</span><span class="punctuation">:</span> Lato<span class="punctuation">;</span>
  <span class="property">src</span><span class="punctuation">:</span> <span class="url"><span class="function">url</span><span class="punctuation">(</span>https://tinybase.org/fonts/lato-regular.woff2<span class="punctuation">)</span></span> <span class="function">format</span><span class="punctuation">(</span><span class="string">'woff2'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="property">font-weight</span><span class="punctuation">:</span> 600<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">*</span> <span class="punctuation">{</span>
  <span class="property">box-sizing</span><span class="punctuation">:</span> border<span class="operator">-</span>box<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">body</span> <span class="punctuation">{</span>
  <span class="property">user-select</span><span class="punctuation">:</span> none<span class="punctuation">;</span>
  <span class="property">font-family</span><span class="punctuation">:</span> Lato<span class="punctuation">,</span> sans<span class="operator">-</span>serif<span class="punctuation">;</span>
  <span class="property">font-size</span><span class="punctuation">:</span> 0.8rem<span class="punctuation">;</span>
  <span class="property">line-height</span><span class="punctuation">:</span> 1.5rem<span class="punctuation">;</span>
  <span class="property">margin</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
  <span class="property">color</span><span class="punctuation">:</span> #333<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">h1</span> <span class="punctuation">{</span>
  <span class="property">margin</span><span class="punctuation">:</span> 0 0 1rem<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">h2</span> <span class="punctuation">{</span>
  <span class="property">margin</span><span class="punctuation">:</span> 1.5rem 0 0.5rem<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">ul</span> <span class="punctuation">{</span>
  <span class="property">padding-left</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">li</span> <span class="punctuation">{</span>
  <span class="property">display</span><span class="punctuation">:</span> block<span class="punctuation">;</span>
  <span class="property">padding-bottom</span><span class="punctuation">:</span> 0.25rem<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">a</span> <span class="punctuation">{</span>
  <span class="property">white-space</span><span class="punctuation">:</span> nowrap<span class="punctuation">;</span>
  <span class="property">text-overflow</span><span class="punctuation">:</span> ellipsis<span class="punctuation">;</span>
  <span class="property">overflow</span><span class="punctuation">:</span> hidden<span class="punctuation">;</span>
  <span class="property">cursor</span><span class="punctuation">:</span> pointer<span class="punctuation">;</span>
  <span class="property">max-width</span><span class="punctuation">:</span> 100%<span class="punctuation">;</span>
  <span class="property">display</span><span class="punctuation">:</span> inline<span class="operator">-</span>block<span class="punctuation">;</span>
  <span class="property">vertical-align</span><span class="punctuation">:</span> top<span class="punctuation">;</span>
  <span class="property">color</span><span class="punctuation">:</span> #000<span class="punctuation">;</span>
  <span class="selector">&amp;:hover</span> <span class="punctuation">{</span>
    <span class="property">text-decoration</span><span class="punctuation">:</span> underline<span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>

<span class="selector">p</span> <span class="punctuation">{</span>
  <span class="property">line-height</span><span class="punctuation">:</span> 1.2rem<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><h3 id="conclusion">Conclusion</h3><p>And that&#x27;s it! There is quite a lot going on here, but this is arguably a complete and legitimate application that pulls in a decent amount of normalized relational data and renders it in a useful and navigable fashion.</p><p>One thing that might be easy to forget (because the movie data does not change) is that every single view rendered in this application is reactive! Were any aspect of the data dynamic, it would be automatically updated in the user interface. It&#x27;s left as an exercise to the reader to explore how this might work, perhaps with movie favorite lists, or pulling dynamic data directly from TMDB.</p><p>In the meantime, as they say in the movies, that&#x27;s a wrap!</p></section>