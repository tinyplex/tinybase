<!DOCTYPE html><html lang="en"><head><link rel="dns-prefetch" href="https://www.googletagmanager.com/"><link href="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ" rel="preload" as="script"><link rel="preload" as="font" href="/fonts/inter.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/inconsolata.woff2" type="font/woff2" crossorigin="anonymous"><title>Todo App v2 (indexes) | TinyBase</title><meta name="description" content="In this demo, we build a more complex &#x27;Todo&#x27; app. In addition to what we built in Todo App v1 (the basics), we let people specify a type for each todo, such as &#x27;Home&#x27;, &#x27;Work&#x27; or &#x27;Archived&#x27;."><meta property="og:type" content="website"><meta property="og:title" content="Todo App v2 (indexes) | TinyBase"><meta property="og:description" content="In this demo, we build a more complex &#x27;Todo&#x27; app. In addition to what we built in Todo App v1 (the basics), we let people specify a type for each todo, such as &#x27;Home&#x27;, &#x27;Work&#x27; or &#x27;Archived&#x27;."><meta property="og:url" content="https://beta.tinybase.org/demos/todo-app/todo-app-v2-indexes/"><meta property="og:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Todo App v2 (indexes) | TinyBase"><meta name="twitter:description" content="In this demo, we build a more complex &#x27;Todo&#x27; app. In addition to what we built in Todo App v1 (the basics), we let people specify a type for each todo, such as &#x27;Home&#x27;, &#x27;Work&#x27; or &#x27;Archived&#x27;."><meta name="twitter:site" content="@tinybasejs"><meta name="twitter:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="/css/index.css"><link rel="canonical" href="https://beta.tinybase.org/demos/todo-app/todo-app-v2-indexes/"><script src="/js/app.js"></script></head><body><header><a href="/"><img src="/favicon.svg" alt="TinyBase logo"><span>TinyBase <em title="3.1.0-beta.0">β</em></span></a><nav><ul><li><a href="/guides/">Guides</a></li><li><a href="/demos/">Demos</a></li><li><a href="/api/">API</a></li><li><a href="https://github.com/tinyplex/tinybase">GitHub</a></li></ul></nav><span id="dark"></span></header><main><nav><ul><li id="root" class="parent open"><span></span><a href="/">TinyBase</a><ul><li id="G" class="parent"><span></span><a href="/guides/">Guides</a></li><li id="D2" class="parent open"><span></span><a href="/demos/">Demos</a><ul><li id="HW" class="parent"><span></span><a href="/demos/hello-world/">Hello World</a></li><li id="RD" class="parent"><span></span><a href="/demos/rolling-dice/">Rolling Dice</a></li><li id="C2"><span></span><a href="/demos/countries/">Countries</a></li><li id="TA" class="parent open"><span></span><a href="/demos/todo-app/">Todo App</a><ul><li id="TA2"><span></span><a href="/demos/todo-app/todo-app-v1-the-basics/">Todo App v1 (the basics)</a></li><li id="TA3" class="current"><span></span><a href="/demos/todo-app/todo-app-v2-indexes/">Todo App v2 (indexes)</a></li><li id="TA4"><span></span><a href="/demos/todo-app/todo-app-v3-persistence/">Todo App v3 (persistence)</a></li><li id="TA5"><span></span><a href="/demos/todo-app/todo-app-v4-metrics/">Todo App v4 (metrics)</a></li><li id="TA6"><span></span><a href="/demos/todo-app/todo-app-v5-checkpoints/">Todo App v5 (checkpoints)</a></li></ul></li><li id="D3"><span></span><a href="/demos/drawing/">Drawing</a></li><li id="CD"><span></span><a href="/demos/city-database/">City Database</a></li><li id="CA"><span></span><a href="/demos/car-analysis/">Car Analysis</a></li><li id="MD"><span></span><a href="/demos/movie-database/">Movie Database</a></li><li id="WF"><span></span><a href="/demos/word-frequencies/">Word Frequencies</a></li></ul></li><li id="api" class="parent"><span></span><a href="/api/">API</a></li></ul></li></ul></nav><article><nav><ul><li><a href="/">TinyBase</a></li><li><a href="/demos/">Demos</a></li><li><a href="/demos/todo-app/">Todo App</a></li><li><a href="/demos/todo-app/todo-app-v2-indexes/">Todo App v2 (indexes)</a></li></ul></nav><section class="s1" id="/demos/todo-app/todo-app-v2-indexes/" data-id="TA3"><h1>Todo App v2 (indexes)</h1><iframe srcdoc="&lt;html&gt;&lt;head&gt;&lt;script src=&quot;/umd/react.production.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/umd/react-dom.production.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/umd/tinybase.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/umd/ui-react.js&quot;&gt;&lt;/script&gt;&lt;style&gt;@font-face{font-family:Inter;src:url(https://tinybase.org/fonts/inter.woff2) format(&#x27;woff2&#x27;)}body{display:grid;grid-template-columns:35% minmax(0,1fr);grid-template-rows:auto 1fr;box-sizing:border-box;font-family:Inter,sans-serif;letter-spacing:-.04rem;grid-gap:1rem .5rem;margin:0;min-height:100vh;padding:1rem}body *{box-sizing:border-box;outline-color:#d81b60}#newTodo{border:1px solid #ccc;display:block;font:inherit;letter-spacing:inherit;padding:.5rem;width:100%}#todos{grid-column:2;margin:0;padding:0}#todos .todo{background:#fff;border:1px solid #ccc;display:flex;margin-bottom:.5rem;padding:.5rem}#todos .todo .text{cursor:pointer;flex:1;overflow:hidden;text-overflow:ellipsis;user-select:none;white-space:nowrap}#todos .todo .text::before{content:&#x27;\1F7E0&#x27;;padding:0 .5rem 0 .25rem}#todos .todo .text.done{color:#ccc}#todos .todo .text.done::before{content:&#x27;\2705&#x27;}#types{margin:0}#types .type{cursor:pointer;margin-bottom:.5rem;user-select:none}#types .type.current{color:#d81b60}#todos .todo .type{border:none;color:#777;font:inherit;font-size:.8rem;margin-top:.1rem}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script&gt;(()=&gt;{const n=React[&quot;createElement&quot;],{createIndexes:l,createStore:a}=TinyBase,{CellView:r,Provider:s,SliceView:e,useAddRowCallback:d,useCell:i,useCreateIndexes:u,useCreateStore:c,useSetCellCallback:y,useSetValueCallback:p,useValue:v}=TinyBaseUiReact,{useCallback:w,useState:C}=React,I=[&quot;Home&quot;,&quot;Work&quot;,&quot;Archived&quot;],m={todos:{0:{text:&quot;Clean the floor&quot;,type:&quot;Home&quot;},1:{text:&quot;Install TinyBase&quot;,type:&quot;Work&quot;},2:{text:&quot;Book holiday&quot;,type:&quot;Archived&quot;}}},t=()=&gt;{var e=c(()=&gt;a().setTables(m)),t=c(()=&gt;a().setValue(&quot;type&quot;,&quot;Home&quot;)),o=u(e,e=&gt;l(e).setIndexDefinition(&quot;types&quot;,&quot;todos&quot;,&quot;type&quot;));return n(s,{store:e,storesById:{viewStore:t},indexes:o},n(x,null),n(S,null),n(h,null),n(k,null))};window.addEventListener(&quot;load&quot;,()=&gt;ReactDOM.createRoot(document.body).render(n(t,null)));const x=()=&gt;&quot;Todos&quot;,S=()=&gt;{const[e,t]=C(&quot;&quot;),o=v(&quot;type&quot;,&quot;viewStore&quot;),l=w(({target:{value:e}})=&gt;t(e),[]),a=d(&quot;todos&quot;,({which:e,target:{value:t}})=&gt;13==e&amp;&amp;&quot;&quot;!=t?{text:t,type:o}:null,[o],void 0,()=&gt;t(&quot;&quot;),[t]);return n(&quot;input&quot;,{id:&quot;newTodo&quot;,onChange:l,onKeyDown:a,placeholder:&quot;New Todo&quot;,value:e})},k=()=&gt;n(&quot;ul&quot;,{id:&quot;todos&quot;},n(e,{indexId:&quot;types&quot;,sliceId:v(&quot;type&quot;,&quot;viewStore&quot;),rowComponent:o})),o=e=&gt;n(&quot;li&quot;,{className:&quot;todo&quot;},n(b,{...e}),n(R,{...e})),b=({tableId:e,rowId:t})=&gt;{const o=i(e,t,&quot;done&quot;),l=&quot;text&quot;+(o?&quot; done&quot;:&quot;&quot;),a=y(e,t,&quot;done&quot;,()=&gt;!o,[o]);return n(&quot;span&quot;,{className:l,onClick:a},n(r,{tableId:e,rowId:t,cellId:&quot;text&quot;}))},h=()=&gt;n(&quot;ul&quot;,{id:&quot;types&quot;},I.map(e=&gt;n(T,{key:e,type:e}))),T=({type:e})=&gt;{var t=v(&quot;type&quot;,&quot;viewStore&quot;),o=p(&quot;type&quot;,()=&gt;e,[e],&quot;viewStore&quot;),t=&quot;type&quot;+(e==t?&quot; current&quot;:&quot;&quot;);return n(&quot;li&quot;,{className:t,onClick:o},e)},R=({tableId:e,rowId:t})=&gt;{var o=i(e,t,&quot;type&quot;),t=y(e,t,&quot;type&quot;,({target:{value:e}})=&gt;e,[]);return n(&quot;select&quot;,{className:&quot;type&quot;,onChange:t,value:o},I.map(e=&gt;n(&quot;option&quot;,null,e)))}})()&lt;/script&gt;&lt;/html&gt;"></iframe><p>In this demo, we build a more complex &#x27;Todo&#x27; app. In addition to what we built in <a href="/demos/todo-app/todo-app-v1-the-basics/">Todo App v1 (the basics)</a>, we let people specify a type for each todo, such as &#x27;Home&#x27;, &#x27;Work&#x27; or &#x27;Archived&#x27;.</p><p>We also index those types with an <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object so that people can see their todos filtered by each type.</p><p>We&#x27;re making changes to the <a href="/demos/todo-app/todo-app-v1-the-basics/">Todo App v1 (the basics)</a> demo.</p><h3 id="additional-initialization">Additional Initialization</h3><p>We&#x27;ll be creating an <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object in this demo, so we&#x27;ll need an additional import, the <a href="/api/ui-react/functions/indexes-hooks/usecreateindexes/"><code>useCreateIndexes</code></a> hook. We&#x27;ll also use a <a href="/api/ui-react/functions/indexes-components/sliceview/"><code>SliceView</code></a> component to display the index, instead of the simple <a href="/api/ui-react/functions/store-components/tableview/"><code>TableView</code></a> component that we used before. We&#x27;ll be using a <a href="/api/store/type-aliases/store/value/"><code>Value</code></a> for the view state, so we&#x27;ll also import the <a href="/api/ui-react/functions/store-hooks/usesetvaluecallback/"><code>useSetValueCallback</code></a> hook and <a href="/api/ui-react/functions/store-hooks/usevalue/"><code>useValue</code></a> hook.</p><pre><code><span class="deleted-sign"><span class="prefix">-</span><span class="keyword">const</span> <span class="punctuation">{</span>createStore<span class="punctuation">}</span> <span class="operator">=</span> TinyBase<span class="punctuation">;</span>
</span><span class="inserted-sign"><span class="prefix">+</span><span class="keyword">const</span> <span class="punctuation">{</span>createIndexes<span class="punctuation">,</span> createStore<span class="punctuation">}</span> <span class="operator">=</span> TinyBase<span class="punctuation">;</span>
</span><span class="unchanged"><span class="prefix"> </span><span class="keyword">const</span> <span class="punctuation">{</span>
<span class="prefix"> </span>  CellView<span class="punctuation">,</span>
<span class="prefix"> </span>  Provider<span class="punctuation">,</span>
</span><span class="deleted-sign"><span class="prefix">-</span>  TableView<span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>  SliceView<span class="punctuation">,</span>
</span><span class="unchanged"><span class="prefix"> </span>  useAddRowCallback<span class="punctuation">,</span>
<span class="prefix"> </span>  useCell<span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>  useCreateIndexes<span class="punctuation">,</span>
</span><span class="unchanged"><span class="prefix"> </span>  useCreateStore<span class="punctuation">,</span>
<span class="prefix"> </span>  useSetCellCallback<span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>  useSetValueCallback<span class="punctuation">,</span>
<span class="prefix">+</span>  useValue<span class="punctuation">,</span>
</span><span class="unchanged"><span class="prefix"> </span><span class="punctuation">}</span> <span class="operator">=</span> TinyBaseUiReact<span class="punctuation">;</span>
</span></code></pre><p>We&#x27;re defining a list of the types a todo can have, and giving our default todos each a different initial type:</p><pre><code><span class="inserted-sign"><span class="prefix">+</span><span class="keyword">const</span> <span class="constant">TYPES</span> <span class="operator">=</span> <span class="punctuation">[</span><span class="string">'Home'</span><span class="punctuation">,</span> <span class="string">'Work'</span><span class="punctuation">,</span> <span class="string">'Archived'</span><span class="punctuation">]</span><span class="punctuation">;</span>
</span><span class="unchanged"><span class="prefix"> </span><span class="keyword">const</span> <span class="constant">INITIAL_TODOS</span> <span class="operator">=</span> <span class="punctuation">{</span>
<span class="prefix"> </span>  <span class="literal-property">todos</span><span class="operator">:</span> <span class="punctuation">{</span>
</span><span class="deleted-sign"><span class="prefix">-</span>    <span class="number">0</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">text</span><span class="operator">:</span> <span class="string">'Clean the floor'</span><span class="punctuation">}</span><span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>    <span class="number">0</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">text</span><span class="operator">:</span> <span class="string">'Clean the floor'</span><span class="punctuation">,</span> <span class="literal-property">type</span><span class="operator">:</span> <span class="string">'Home'</span><span class="punctuation">}</span><span class="punctuation">,</span>
</span><span class="deleted-sign"><span class="prefix">-</span>    <span class="number">1</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">text</span><span class="operator">:</span> <span class="string">'Install TinyBase'</span><span class="punctuation">}</span><span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>    <span class="number">1</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">text</span><span class="operator">:</span> <span class="string">'Install TinyBase'</span><span class="punctuation">,</span> <span class="literal-property">type</span><span class="operator">:</span> <span class="string">'Work'</span><span class="punctuation">}</span><span class="punctuation">,</span>
</span><span class="deleted-sign"><span class="prefix">-</span>    <span class="number">2</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">text</span><span class="operator">:</span> <span class="string">'Book holiday'</span><span class="punctuation">}</span><span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>    <span class="number">2</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">text</span><span class="operator">:</span> <span class="string">'Book holiday'</span><span class="punctuation">,</span> <span class="literal-property">type</span><span class="operator">:</span> <span class="string">'Archived'</span><span class="punctuation">}</span><span class="punctuation">,</span>
</span><span class="unchanged"><span class="prefix"> </span>  <span class="punctuation">}</span><span class="punctuation">,</span>
<span class="prefix"> </span><span class="punctuation">}</span><span class="punctuation">;</span>
</span></code></pre><h3 id="adding-additional-stores-and-indexes">Adding Additional Stores And <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a></h3><p>In this demo we let people select a todo type and see a filtered list. The current type being displayed will need to be known by components across the app. We could make this a part of the top level component&#x27;s state and pass it around with props.</p><p>But instead, we will create and memoize a second <a href="/api/store/interfaces/store/store/"><code>Store</code></a> object called <code>viewStore</code> to store the current type being viewed, in a <a href="/api/store/type-aliases/store/value/"><code>Value</code></a> called <code>type</code>.</p><p>We also want to index the todos by type, so we create and memoize an <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object, and define an index called <code>types</code> on the <code>todos</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a>, based on the value of the <code>type</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a>:</p><pre><code><span class="unchanged"><span class="prefix"> </span><span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
<span class="prefix"> </span>  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatestore/">useCreateStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settables/">setTables</a></span><span class="punctuation">(</span><span class="constant">INITIAL_TODOS</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
</span><span class="inserted-sign"><span class="prefix">+</span>  <span class="keyword">const</span> viewStore <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatestore/">useCreateStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
<span class="prefix">+</span>    <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setvalue/">setValue</a></span><span class="punctuation">(</span><span class="string">'type'</span><span class="punctuation">,</span> <span class="string">'Home'</span><span class="punctuation">)</span><span class="punctuation">,</span>
<span class="prefix">+</span>  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="prefix">+</span>  <span class="keyword">const</span> indexes <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/indexes-hooks/usecreateindexes/">useCreateIndexes</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span>
<span class="prefix">+</span>    <span class="function"><a href="/api/indexes/functions/creation/createindexes/">createIndexes</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/indexes/interfaces/indexes/indexes/methods/configuration/setindexdefinition/">setIndexDefinition</a></span><span class="punctuation">(</span><span class="string">'types'</span><span class="punctuation">,</span> <span class="string">'todos'</span><span class="punctuation">,</span> <span class="string">'type'</span><span class="punctuation">)</span><span class="punctuation">,</span>
<span class="prefix">+</span>  <span class="punctuation">)</span><span class="punctuation">;</span>
</span>
<span class="unchanged"><span class="prefix"> </span>  <span class="keyword">return</span> <span class="punctuation">(</span>
</span><span class="deleted-sign"><span class="prefix">-</span>    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span> <span class="attr-name">store</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>store<span class="punctuation">}</span></span><span class="punctuation">></span></span></span><span class="inserted-sign"><span class="prefix">+</span>    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span> <span class="attr-name">store</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>store<span class="punctuation">}</span></span> <span class="attr-name">storesById</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">{</span>viewStore<span class="punctuation">}</span><span class="punctuation">}</span></span> <span class="attr-name">indexes</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>indexes<span class="punctuation">}</span></span><span class="punctuation">></span></span></span><span class="unchanged"><span class="prefix"> </span>      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Title</span></span> <span class="punctuation">/></span></span>
<span class="prefix"> </span>      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">NewTodo</span></span> <span class="punctuation">/></span></span>
</span><span class="inserted-sign"><span class="prefix">+</span>      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Types</span></span> <span class="punctuation">/></span></span>
</span><span class="unchanged"><span class="prefix"> </span>      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Todos</span></span> <span class="punctuation">/></span></span>
<span class="prefix"> </span>    <span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span><span class="punctuation">></span></span>
<span class="prefix"> </span>  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="prefix"> </span><span class="punctuation">}</span><span class="punctuation">;</span>
</span></code></pre><p>Notice that we pass the new <code>viewStore</code> and <code>indexes</code> down into the app using the same Provider that we used for the <code>store</code> in <a href="/demos/todo-app/">Todo App</a> v1. We need to pass <code>viewStore</code> in the <code>storesById</code> prop so we can refer to it explicitly for the components that need it (to disambiguate it from the default <a href="/api/store/interfaces/store/store/"><code>Store</code></a> object that we provided in the <code>store</code> prop).</p><p>We also added a new component to the app called <code>Types</code>. This is a side-bar that lists the types so people can pick one and view the filtered <code>Todos</code> list for it.</p><h3 id="the-types-component">The <code>Types</code> Component</h3><p>This new component goes on the left-hand side of the demo and lists the available types. When people click a type name, the current type will be set in the <code>viewStore</code> and the list on the right will be filtered accordingly. (Additionally, a new todo will be set to have this current type when it&#x27;s added.)</p><p>The component literally just enumerates the <code>TYPES</code> array and creates a <code>Type</code> component for each one:</p><pre><code><span class="keyword">const</span> <span class="function-variable">Types</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span> <span class="attr-name">id</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>types<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="punctuation">{</span><span class="constant">TYPES</span><span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">type</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Type</span></span> <span class="attr-name">key</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>type<span class="punctuation">}</span></span> <span class="attr-name">type</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>type<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
    <span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><pre><code><span class="selector">#types</span> <span class="punctuation">{</span>
  <span class="property">margin</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><h3 id="the-type-component">The <code>Type</code> Component</h3><p>In the <code>Types</code> component, each type appears as a clickable name. The <code>viewStore</code> provides the currently selected type, and if it matches, this component will have an additional CSS class added to it.</p><p>If the component is clicked, the <code>viewStore</code>&#x27;s value will be updated with a callback provided by the <a href="/api/ui-react/functions/store-hooks/usesetvaluecallback/"><code>useSetValueCallback</code></a> hook:</p><pre><code><span class="keyword">const</span> <span class="function-variable">Type</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>type<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> currentType <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usevalue/">useValue</a></span><span class="punctuation">(</span><span class="string">'type'</span><span class="punctuation">,</span> <span class="string">'viewStore'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> handleClick <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usesetvaluecallback/">useSetValueCallback</a></span><span class="punctuation">(</span>
    <span class="string">'type'</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> type<span class="punctuation">,</span>
    <span class="punctuation">[</span>type<span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="string">'viewStore'</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> className <span class="operator">=</span> <span class="string">'type'</span> <span class="operator">+</span> <span class="punctuation">(</span>type <span class="operator">==</span> currentType <span class="operator">?</span> <span class="string">' current'</span> <span class="operator">:</span> <span class="string">''</span><span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span> <span class="attr-name">className</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>className<span class="punctuation">}</span></span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>handleClick<span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="punctuation">{</span>type<span class="punctuation">}</span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p><strong>NB</strong>: In this example, we are setting up one listener on the <code>viewStore</code> for every instance of the <code>Type</code> component in the side bar. This makes the <code>Type</code> components completely self-sufficient. An alternative approach would be to use the <a href="/api/ui-react/functions/store-hooks/usecell/"><code>useCell</code></a> hook once in the parent <code>Types</code> component and pass down the current type as a prop to each item. We would then pass a parameter to the <a href="/api/ui-react/functions/store-hooks/usesetcellcallback/"><code>useSetCellCallback</code></a> hook to set the value based on the item clicked.</p><p>Which of these two approaches is optimal in the general case will depend on the number and complexity of the children components being rendered. For example we will do something similar to this in the <a href="/demos/countries/">Countries</a> demo, which has a longer list of items in the side bar).</p><p>The <code>Type</code> component has a small amount of styling:</p><pre><code><span class="selector">#types .type</span> <span class="punctuation">{</span>
  <span class="property">cursor</span><span class="punctuation">:</span> pointer<span class="punctuation">;</span>
  <span class="property">margin-bottom</span><span class="punctuation">:</span> <span class="variable">@spacing</span><span class="punctuation">;</span>
  <span class="property">user-select</span><span class="punctuation">:</span> none<span class="punctuation">;</span>
  <span class="selector">&amp;.current</span> <span class="punctuation">{</span>
    <span class="property">color</span><span class="punctuation">:</span> <span class="variable">@accentColor</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><h3 id="upgrading-the-todos-component">Upgrading The <code>Todos</code> Component</h3><p>Previously we used a <a href="/api/ui-react/functions/store-components/tableview/"><code>TableView</code></a> component to list all the todos in the <code>todos</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> of the <code>store</code>. But now we want to show only the todos of the current type. We created an <a href="/api/indexes/interfaces/indexes/indexes/"><code>Indexes</code></a> object (called <code>indexes</code>) that has an index called <code>types</code>. Within that is one slice per type, which we can render with a <a href="/api/ui-react/functions/indexes-components/sliceview/"><code>SliceView</code></a> component.</p><p>The slices in an index are simply sets of <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a> from a <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> grouped according to the index&#x27;s definition. Often - as here - these are sets of <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a> that share a particular <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> value.</p><p>We simply need to change the <code>Todos</code> component to fetch the current type from the <code>viewStore</code>, and then pass the corresponding index slice to the <a href="/api/ui-react/functions/indexes-components/sliceview/"><code>SliceView</code></a> component. It still uses the <code>Todo</code> component to render each <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> itself:</p><pre><code><span class="unchanged"><span class="prefix"> </span><span class="keyword">const</span> <span class="function-variable">Todos</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
<span class="prefix"> </span>  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span> <span class="attr-name">id</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>todos<span class="punctuation">"</span></span><span class="punctuation">></span></span></span><span class="deleted-sign"><span class="prefix">-</span>    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/tableview/">TableView</a></span></span> <span class="attr-name">tableId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>todos<span class="punctuation">"</span></span> <span class="attr-name">rowComponent</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>Todo<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
</span><span class="inserted-sign"><span class="prefix">+</span>    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/indexes-components/sliceview/">SliceView</a></span></span>
<span class="prefix">+</span>      <span class="attr-name">indexId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>types<span class="punctuation">"</span></span>
<span class="prefix">+</span>      <span class="attr-name">sliceId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usevalue/">useValue</a></span><span class="punctuation">(</span><span class="string">'type'</span><span class="punctuation">,</span> <span class="string">'viewStore'</span><span class="punctuation">)</span><span class="punctuation">}</span></span>
<span class="prefix">+</span>      <span class="attr-name">rowComponent</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>Todo<span class="punctuation">}</span></span>
<span class="prefix">+</span>    <span class="punctuation">/></span></span>
</span><span class="unchanged"><span class="prefix"> </span>  <span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span>
<span class="prefix"> </span><span class="punctuation">)</span><span class="punctuation">;</span>
</span></code></pre><h3 id="upgrading-the-todo-component">Upgrading The <code>Todo</code> Component</h3><p>Since the todo has the new <code>type</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a>, we can display that alongside the text. In fact, we want to let people change the type for each todo too, so we implement a new component called <code>TodoType</code> that contains as a <code>select</code> dropdown. It has a callback to update the todo <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> with the value from the <code>select</code> element if it is changed:</p><pre><code><span class="unchanged"><span class="prefix"> </span><span class="keyword">const</span> <span class="function-variable">Todo</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">props</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
<span class="prefix"> </span>  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span> <span class="attr-name">className</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>todo<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
<span class="prefix"> </span>    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">TodoText</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span></span><span class="inserted-sign"><span class="prefix">+</span>    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">TodoType</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
</span><span class="unchanged"><span class="prefix"> </span>  <span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span>
<span class="prefix"> </span><span class="punctuation">)</span><span class="punctuation">;</span>
</span></code></pre><pre><code><span class="keyword">const</span> <span class="function-variable">TodoType</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> type <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecell/">useCell</a></span><span class="punctuation">(</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'type'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> handleChange <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usesetcellcallback/">useSetCellCallback</a></span><span class="punctuation">(</span>
    tableId<span class="punctuation">,</span>
    rowId<span class="punctuation">,</span>
    <span class="string">'type'</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span><span class="literal-property">target</span><span class="operator">:</span> <span class="punctuation">{</span>value<span class="punctuation">}</span><span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> value<span class="punctuation">,</span>
    <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>select</span> <span class="attr-name">className</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>type<span class="punctuation">"</span></span> <span class="attr-name">onChange</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>handleChange<span class="punctuation">}</span></span> <span class="attr-name">value</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>type<span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="punctuation">{</span><span class="constant">TYPES</span><span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">type</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
        <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>option</span><span class="punctuation">></span></span><span class="punctuation">{</span>type<span class="punctuation">}</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>option</span><span class="punctuation">></span></span>
      <span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>select</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>We can style the <code>select</code> element so that it appears on the right of the <code>Todo</code> component:</p><pre><code><span class="selector">#todos .todo .type</span> <span class="punctuation">{</span>
  <span class="property">border</span><span class="punctuation">:</span> none<span class="punctuation">;</span>
  <span class="property">color</span><span class="punctuation">:</span> #777<span class="punctuation">;</span>
  <span class="property">font</span><span class="punctuation">:</span> inherit<span class="punctuation">;</span>
  <span class="property">font-size</span><span class="punctuation">:</span> 0.8rem<span class="punctuation">;</span>
  <span class="property">margin-top</span><span class="punctuation">:</span> 0.1rem<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><h3 id="upgrading-the-newtodo-component">Upgrading the <code>NewTodo</code> Component</h3><p>Our final step is to make sure that when someone adds a new todo it defaults to the current type from the <code>viewStore</code> - if only so that the newly-created todo appears in the current <a href="/api/ui-react/functions/indexes-components/indexview/"><code>IndexView</code></a> component:</p><pre><code><span class="unchanged"><span class="prefix"> </span><span class="keyword">const</span> <span class="function-variable">NewTodo</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
<span class="prefix"> </span>  <span class="keyword">const</span> <span class="punctuation">[</span>text<span class="punctuation">,</span> setText<span class="punctuation">]</span> <span class="operator">=</span> <span class="function">useState</span><span class="punctuation">(</span><span class="string">''</span><span class="punctuation">)</span><span class="punctuation">;</span>
</span><span class="inserted-sign"><span class="prefix">+</span>  <span class="keyword">const</span> type <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usevalue/">useValue</a></span><span class="punctuation">(</span><span class="string">'type'</span><span class="punctuation">,</span> <span class="string">'viewStore'</span><span class="punctuation">)</span><span class="punctuation">;</span>
</span><span class="unchanged"><span class="prefix"> </span>  <span class="keyword">const</span> handleChange <span class="operator">=</span> <span class="function">useCallback</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span><span class="literal-property">target</span><span class="operator">:</span> <span class="punctuation">{</span>value<span class="punctuation">}</span><span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">setText</span><span class="punctuation">(</span>value<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="prefix"> </span>  <span class="keyword">const</span> handleKeyDown <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/useaddrowcallback/">useAddRowCallback</a></span><span class="punctuation">(</span>
<span class="prefix"> </span>    <span class="string">'todos'</span><span class="punctuation">,</span>
<span class="prefix"> </span>    <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>which<span class="punctuation">,</span> <span class="literal-property">target</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">value</span><span class="operator">:</span> text<span class="punctuation">}</span><span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
</span><span class="deleted-sign"><span class="prefix">-</span>      which <span class="operator">==</span> <span class="number">13</span> <span class="operator">&amp;&amp;</span> text <span class="operator">!=</span> <span class="string">''</span> <span class="operator">?</span> <span class="punctuation">{</span>text<span class="punctuation">}</span> <span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>      which <span class="operator">==</span> <span class="number">13</span> <span class="operator">&amp;&amp;</span> text <span class="operator">!=</span> <span class="string">''</span> <span class="operator">?</span> <span class="punctuation">{</span>text<span class="punctuation">,</span> type<span class="punctuation">}</span> <span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">,</span>
</span><span class="deleted-sign"><span class="prefix">-</span>    <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span>
</span><span class="inserted-sign"><span class="prefix">+</span>    <span class="punctuation">[</span>type<span class="punctuation">]</span><span class="punctuation">,</span>
</span><span class="unchanged"><span class="prefix"> </span>    <span class="keyword">undefined</span><span class="punctuation">,</span>
<span class="prefix"> </span>    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">setText</span><span class="punctuation">(</span><span class="string">''</span><span class="punctuation">)</span><span class="punctuation">,</span>
<span class="prefix"> </span>    <span class="punctuation">[</span>setText<span class="punctuation">]</span><span class="punctuation">,</span>
<span class="prefix"> </span>  <span class="punctuation">)</span><span class="punctuation">;</span>
</span></code></pre><p>Note how the current type is now listed as a dependency for the handler function so that that function is correctly memoized.</p><h3 id="summary">Summary</h3><p>And again, that&#x27;s it: a fairly small set of changes to make the app a little more useful. But there&#x27;s more!</p><p>Next, we will build a yet more complex &#x27;Todo&#x27; app, complete with persistence, a schema, and metrics. Please continue to the <a href="/demos/todo-app/todo-app-v3-persistence/">Todo App v3 (persistence)</a> demo.</p></section></article><aside></aside></main><footer><nav><a id="tw" href="https://twitter.com/tinybasejs" target="_blank">Twitter</a><a id="fb" href="https://facebook.com/tinybasejs" target="_blank">Facebook</a></nav><nav><a href="/">TinyBase 3.1.0-beta.0</a> © 2021- All Rights Reserved</nav></footer></body><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ"></script><script>window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments);}g('js',new Date());g('config','G-D1MGR8VRWJ');</script></html>