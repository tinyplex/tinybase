<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="preload" as="image" href="/favicon.svg"><link rel="preload" as="image" href="https://www.themoviedb.org/assets/2/v4/logos/v2/blue_short-8e7b30f73a4020692ccca9c88bafe5dcb6f8a62a4c6bc55cd9ba82bb2cd95f6c.svg"><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ"></script><link rel="dns-prefetch" href="https://www.googletagmanager.com/"><link href="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ" rel="preload" as="script"><link rel="preload" as="font" href="/fonts/inter.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/inconsolata.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/shantell.woff2" type="font/woff2" crossorigin="anonymous"><title>Movie Database | TinyBase</title><meta name="description" content="In this demo, we build an app that showcases the relational query capabilities of TinyBase v2.0, joining together information about movies, directors, and actors."><meta property="og:type" content="website"><meta property="og:title" content="Movie Database | TinyBase"><meta property="og:description" content="In this demo, we build an app that showcases the relational query capabilities of TinyBase v2.0, joining together information about movies, directors, and actors."><meta property="og:url" content="https://beta.tinybase.org/demos/movie-database/"><meta property="og:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Movie Database | TinyBase"><meta name="twitter:description" content="In this demo, we build an app that showcases the relational query capabilities of TinyBase v2.0, joining together information about movies, directors, and actors."><meta name="twitter:site" content="@tinybasejs"><meta name="twitter:image" content="https://beta.tinybase.org/favicon_pad.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="canonical" href="https://beta.tinybase.org/demos/movie-database/"><link rel="stylesheet" href="/css/index.css"><script src="/js/app.js"></script></head><body><header><a href="/"><img src="/favicon.svg" alt="TinyBase logo"><span>TinyBase <em>β</em></span></a><nav><ul><li><a href="/guides/">Guides</a></li><li><a href="/demos/">Demos</a></li><li><a href="/api/">API</a></li><li><a href="https://github.com/tinyplex/tinybase">GitHub</a></li></ul></nav><span id="dark"></span></header><main><nav><ul><li id="root" class="parent open"><span></span><a href="/">TinyBase</a><ul><li id="G" class="parent"><span></span><a href="/guides/">Guides</a></li><li id="D2" class="parent open"><span></span><a href="/demos/">Demos</a><ul><li id="HW" class="parent"><span></span><a href="/demos/hello-world/">Hello World</a></li><li id="RD" class="parent"><span></span><a href="/demos/rolling-dice/">Rolling Dice</a></li><li id="C2"><span></span><a href="/demos/countries/">Countries</a></li><li id="TA" class="parent"><span></span><a href="/demos/todo-app/">Todo App</a></li><li id="D3"><span></span><a href="/demos/drawing/">Drawing</a></li><li id="CD"><span></span><a href="/demos/city-database/">City Database</a></li><li id="CA"><span></span><a href="/demos/car-analysis/">Car Analysis</a></li><li id="MD" class="current"><span></span><a href="/demos/movie-database/">Movie Database</a></li><li id="WF"><span></span><a href="/demos/word-frequencies/">Word Frequencies</a></li><li id="UIC" class="parent"><span></span><a href="/demos/ui-components/">UI Components</a></li></ul></li><li id="api" class="parent"><span></span><a href="/api/">API</a></li></ul></li></ul></nav><article><nav><ul><li><a href="/">TinyBase</a></li><li><a href="/demos/">Demos</a></li><li><a href="/demos/movie-database/">Movie Database</a></li></ul></nav><section class="s1" id="/demos/movie-database/" data-id="MD"><h1>Movie Database</h1><iframe srcdoc="&lt;html&gt;&lt;head&gt;&lt;script type=&quot;importmap&quot;&gt;{
    &quot;imports&quot;: {
      &quot;tinybase&quot;: &quot;https://esm.sh/tinybase@8.0.0-beta.1&quot;,
      &quot;tinybase/ui-react&quot;: &quot;https://esm.sh/tinybase@8.0.0-beta.1/ui-react&quot;,
      &quot;tinybase/ui-react-dom&quot;: &quot;https://esm.sh/tinybase@8.0.0-beta.1/ui-react-dom&quot;,
      &quot;tinybase/ui-react-inspector&quot;: &quot;https://esm.sh/tinybase@8.0.0-beta.1/ui-react-inspector&quot;,
      &quot;react&quot;: &quot;https://esm.sh/react@^19.2.4&quot;,
      &quot;react/jsx-runtime&quot;: &quot;https://esm.sh/react@^19.2.4/jsx-runtime&quot;,
      &quot;react-dom/client&quot;: &quot;https://esm.sh/react-dom@^19.2.4/client&quot;
    }
  }&lt;/script&gt;&lt;style&gt;#loading{animation:spin 1s infinite linear;height:2rem;margin:40vh auto;width:2rem}#loading::before{content:url(&#x27;data:image/svg+xml,&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;2rem&quot; viewBox=&quot;0 0 100 100&quot;&gt;&lt;path d=&quot;M50 10A40 40 0 1 1 10 50&quot; stroke=&quot;black&quot; fill=&quot;none&quot; stroke-width=&quot;4&quot; /&gt;&lt;/svg&gt;&#x27;)}@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}nav{background:#eee;display:flex}nav a{flex:1;padding:.25rem;text-align:center}nav a.current{background:#ddd;font-weight:600}main{padding:.5rem}table{border-collapse:collapse;font-size:inherit;line-height:inherit;margin-top:.5rem;table-layout:fixed;width:100%}table caption{text-align:left}table caption button{border:0;margin-right:.25rem}table td,table th{padding:.25rem .5rem .25rem 0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}table th{border:solid #ddd;border-width:1px 0;cursor:pointer;text-align:left;width:20%}table th:nth-child(1){width:40%}table td{border-bottom:1px solid #eee}img{width:1rem;height:1.5rem;object-fit:cover;vertical-align:top;margin:0 .25rem 0 0}img.large{width:4rem;height:6rem;margin:0 .5rem 1rem 0;object-fit:contain;float:left}img.large+ul+*{clear:both}@font-face{font-family:Inter;src:url(https://tinybase.org/fonts/inter.woff2) format(&#x27;woff2&#x27;)}*{box-sizing:border-box}body{user-select:none;font-family:Inter,sans-serif;letter-spacing:-.04rem;font-size:.8rem;line-height:1.5rem;margin:0;color:#333}h1{margin:0 0 1rem}h2{margin:1.5rem 0 .5rem}ul{padding-left:0}li{display:block;padding-bottom:.25rem}a{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;cursor:pointer;max-width:100%;display:inline-block;vertical-align:top;color:#000}a:hover{text-decoration:underline}p{line-height:1.2rem}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script type=&quot;module&quot;&gt;import{Fragment as N,jsx as t,jsxs as s}from&quot;react/jsx-runtime&quot;;import{useMemo as L,useState as T}from&quot;react&quot;;import{createRoot as E}from&quot;react-dom/client&quot;;import{createQueries as V,createStore as P}from&quot;tinybase&quot;;import{CellView as y,Provider as _,ResultCellView as u,useCell as g,useCreateQueries as A,useCreateStore as S,useResultCell as m,useResultRowIds as O,useSetParamValuesCallback as w,useSetValuesCallback as B,useValues as H}from&quot;tinybase/ui-react&quot;;import{ResultSortedTableInHtmlTable as c}from&quot;tinybase/ui-react-dom&quot;;import{Inspector as J}from&quot;tinybase/ui-react-inspector&quot;;const U=()=&gt;{const e=S(P),o=S(()=&gt;P().setValues({currentSection:&quot;movies&quot;})),r=A(e,te,[]),[n,i]=T(!0);return L(async()=&gt;{await re(e),i(!1)},[]),s(_,{store:e,storesById:{viewStore:o},queries:r,children:[t(Z,{}),n?t(W,{}):t(j,{}),t(J,{})]})};addEventListener(&quot;load&quot;,()=&gt;E(document.body).render(t(U,{})));const W=()=&gt;t(&quot;div&quot;,{id:&quot;loading&quot;}),x=({detailId:e})=&gt;e==null?t(se,{}):t(Ie,{movieId:e}),z=({detailId:e})=&gt;e==null?t(ce,{}):t(Ce,{year:e}),K=({detailId:e})=&gt;e==null?t(de,{}):t(fe,{genreId:e}),X=({detailId:e})=&gt;e==null?t(pe,{}):t(Me,{personId:e}),k={movies:[&quot;Movies&quot;,x],years:[&quot;Years&quot;,z],genres:[&quot;Genres&quot;,K],people:[&quot;People&quot;,X]},R=()=&gt;H(&quot;viewStore&quot;),v=(e,o)=&gt;B(()=&gt;({currentSection:e,currentDetailId:o}),[e,o],&quot;viewStore&quot;),Z=()=&gt;{const{currentSection:e}=R();return t(&quot;nav&quot;,{children:Object.entries(k).map(([o,[r]])=&gt;t(&quot;a&quot;,{className:e==o?&quot;current&quot;:&quot;&quot;,onClick:v(o,null),children:r}))})},j=()=&gt;{const{currentSection:e,currentDetailId:o}=R();if(k[e]!=null){const[,r]=k[e];return t(&quot;main&quot;,{children:t(r,{detailId:o})})}return null},ee=/^[\d\.]+$/,oe=async(e,o)=&gt;{const r=(await(await fetch(`https://tinybase.org/assets/${o}.tsv`)).text()).split(`
`),n=r.shift().split(&quot;	&quot;);r.forEach(i=&gt;{const a=i.split(&quot;	&quot;);if(a.length==n.length){const l=a.shift();a.forEach((p,h)=&gt;{p!=&quot;&quot;&amp;&amp;(ee.test(p)&amp;&amp;(p=parseFloat(p)),e.setCell(o,l,n[h+1],p))})}})},re=async e=&gt;{e.startTransaction(),await Promise.all([&quot;movies&quot;,&quot;genres&quot;,&quot;people&quot;,&quot;cast&quot;].map(o=&gt;oe(e,o))),e.finishTransaction()},G=({select:e,join:o})=&gt;{e((r,n)=&gt;n).as(&quot;movieId&quot;),e(&quot;name&quot;).as(&quot;movieName&quot;),e(&quot;image&quot;).as(&quot;movieImage&quot;),e(&quot;year&quot;),e(&quot;rating&quot;),e(&quot;genreId&quot;),e(&quot;genres&quot;,&quot;name&quot;).as(&quot;genreName&quot;),o(&quot;genres&quot;,&quot;genreId&quot;)},te=e=&gt;{const o=V(e);return o.setQueryDefinition(&quot;movies&quot;,&quot;movies&quot;,({select:r,join:n})=&gt;{G({select:r,join:n}),r(&quot;overview&quot;),r(&quot;directorId&quot;),r(&quot;directors&quot;,&quot;name&quot;).as(&quot;directorName&quot;),r(&quot;directors&quot;,&quot;image&quot;).as(&quot;directorImage&quot;),n(&quot;people&quot;,&quot;directorId&quot;).as(&quot;directors&quot;),[1,2,3].forEach(i=&gt;{const a=`cast${i}`;n(&quot;cast&quot;,(p,h)=&gt;`${h}/${i}`).as(a),r(a,&quot;castId&quot;).as(`castId${i}`);const l=`actors${i}`;n(&quot;people&quot;,a,&quot;castId&quot;).as(l),r(l,&quot;name&quot;).as(`castName${i}`),r(l,&quot;image&quot;).as(`castImage${i}`)})}),o.setQueryDefinition(&quot;years&quot;,&quot;movies&quot;,({select:r,group:n})=&gt;{r(&quot;year&quot;),r((i,a)=&gt;a).as(&quot;movieId&quot;),n(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),o.setQueryDefinition(&quot;genres&quot;,&quot;movies&quot;,({select:r,join:n,group:i})=&gt;{r(&quot;genreId&quot;),r((a,l)=&gt;l).as(&quot;movieId&quot;),n(&quot;genres&quot;,&quot;genreId&quot;),r(&quot;genres&quot;,&quot;name&quot;).as(&quot;genreName&quot;),i(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),o.setQueryDefinition(&quot;directors&quot;,&quot;movies&quot;,({select:r,join:n,group:i})=&gt;{r(&quot;directorId&quot;),r((a,l)=&gt;l).as(&quot;movieId&quot;),r(&quot;people&quot;,&quot;name&quot;).as(&quot;directorName&quot;),r(&quot;people&quot;,&quot;image&quot;).as(&quot;directorImage&quot;),r(&quot;people&quot;,&quot;gender&quot;),r(&quot;people&quot;,&quot;popularity&quot;),n(&quot;people&quot;,&quot;directorId&quot;),i(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),o.setQueryDefinition(&quot;cast&quot;,&quot;cast&quot;,({select:r,join:n,group:i})=&gt;{r(&quot;castId&quot;),r(&quot;movieId&quot;),r(&quot;people&quot;,&quot;name&quot;).as(&quot;castName&quot;),r(&quot;people&quot;,&quot;image&quot;).as(&quot;castImage&quot;),r(&quot;people&quot;,&quot;gender&quot;),r(&quot;people&quot;,&quot;popularity&quot;),n(&quot;people&quot;,&quot;castId&quot;),i(&quot;movieId&quot;,&quot;count&quot;).as(&quot;movieCount&quot;)}),o.setQueryDefinition(&quot;yearGenreMovies&quot;,&quot;movies&quot;,({select:r,join:n,where:i,param:a})=&gt;{G({select:r,join:n}),a(&quot;year&quot;)&amp;&amp;i(&quot;year&quot;,a(&quot;year&quot;)),a(&quot;genreId&quot;)&amp;&amp;i(&quot;genreId&quot;,a(&quot;genreId&quot;))},{year:null,genreId:null}),o.setQueryDefinition(&quot;directedMovies&quot;,&quot;movies&quot;,({select:r,join:n,where:i,param:a})=&gt;{G({select:r,join:n}),i(&quot;directorId&quot;,a(&quot;personId&quot;))},{personId:null}),o.setQueryDefinition(&quot;appearedMovies&quot;,&quot;cast&quot;,({select:r,join:n,where:i,param:a})=&gt;{r(&quot;movieId&quot;),r(&quot;movies&quot;,&quot;name&quot;).as(&quot;movieName&quot;),r(&quot;movies&quot;,&quot;image&quot;).as(&quot;movieImage&quot;),r(&quot;movies&quot;,&quot;year&quot;),r(&quot;movies&quot;,&quot;rating&quot;),r(&quot;movies&quot;,&quot;genreId&quot;),r(&quot;genres&quot;,&quot;name&quot;).as(&quot;genreName&quot;),n(&quot;movies&quot;,&quot;movieId&quot;),n(&quot;genres&quot;,&quot;movies&quot;,&quot;genreId&quot;),i(&quot;castId&quot;,a(&quot;personId&quot;))},{personId:null}),o},D=({year:e,genreId:o})=&gt;w(&quot;yearGenreMovies&quot;,r=&gt;r)({year:e,genreId:o}),ne=e=&gt;{w(&quot;directedMovies&quot;,o=&gt;o)({personId:e}),w(&quot;appearedMovies&quot;,o=&gt;o)({personId:e})},f=({queryId:e,rowId:o})=&gt;{const r=m(e,o,&quot;movieId&quot;);return s(&quot;a&quot;,{onClick:v(&quot;movies&quot;,r),children:[t(M,{queryId:e,rowId:o,cellId:&quot;movieImage&quot;}),t(u,{queryId:e,rowId:o,cellId:&quot;movieName&quot;})]})},I=({queryId:e,rowId:o})=&gt;{const r=m(e,o,&quot;year&quot;);return t(&quot;a&quot;,{onClick:v(&quot;years&quot;,r),children:t(u,{queryId:e,rowId:o,cellId:&quot;year&quot;})})},C=({queryId:e,rowId:o})=&gt;{const r=m(e,o,&quot;genreId&quot;);return t(&quot;a&quot;,{onClick:v(&quot;genres&quot;,r),children:t(u,{queryId:e,rowId:o,cellId:&quot;genreName&quot;})})},F=({queryId:e,rowId:o})=&gt;{const r=m(e,o,&quot;directorId&quot;);return s(&quot;a&quot;,{onClick:v(&quot;people&quot;,r),children:[t(M,{queryId:e,rowId:o,cellId:&quot;directorImage&quot;}),t(u,{queryId:e,rowId:o,cellId:&quot;directorName&quot;})]})},b=({queryId:e,rowId:o,billing:r=&quot;&quot;})=&gt;{const n=m(e,o,`castId${r}`);return n==null?null:s(&quot;a&quot;,{onClick:v(&quot;people&quot;,n),children:[t(M,{queryId:e,rowId:o,cellId:`castImage${r}`}),t(u,{queryId:e,rowId:o,cellId:`castName${r}`})]})},$=({queryId:e,rowId:o})=&gt;q(m(e,o,&quot;gender&quot;)),ie=({tableId:e,rowId:o})=&gt;q(g(e,o,&quot;gender&quot;)),q=e=&gt;{switch(e){case 1:return&quot;Female&quot;;case 2:return&quot;Male&quot;;case 3:return&quot;Non-binary&quot;;default:return&quot;Unknown&quot;}},M=({queryId:e,rowId:o,cellId:r,isLarge:n})=&gt;t(Q,{imageFile:m(e,o,r),isLarge:n}),ae=({tableId:e,rowId:o,cellId:r,isLarge:n})=&gt;t(Q,{imageFile:g(e,o,r),isLarge:n}),Q=({imageFile:e,isLarge:o})=&gt;t(&quot;img&quot;,{src:`https://image.tmdb.org/t/p/w${o?92:45}${e}`,className:o?&quot;large&quot;:&quot;&quot;}),d=({title:e,children:o})=&gt;s(N,{children:[t(&quot;h1&quot;,{children:e}),o]}),se=()=&gt;t(d,{title:&quot;Rated movies&quot;,children:t(c,{queryId:&quot;movies&quot;,customCells:le,cellId:&quot;rating&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1})}),le={movieName:{label:&quot;Movie&quot;,component:f},year:{label:&quot;Year&quot;,component:I},rating:{label:&quot;Rating&quot;},genreName:{label:&quot;Genre&quot;,component:C}},ce=()=&gt;t(d,{title:&quot;Years&quot;,children:t(c,{queryId:&quot;years&quot;,customCells:me,cellId:&quot;year&quot;,limit:20,descending:!0,sortOnClick:!0,paginator:!0,idColumn:!1})}),me={year:{label:&quot;Year&quot;,component:I},movieCount:{label:&quot;Rated movies&quot;}},de=()=&gt;t(d,{title:&quot;Genres&quot;,children:t(c,{queryId:&quot;genres&quot;,customCells:ue,cellId:&quot;movieCount&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1})}),ue={genreName:{label:&quot;Genre&quot;,component:C},movieCount:{label:&quot;Rated movies&quot;}},pe=()=&gt;s(d,{title:&quot;People&quot;,children:[t(&quot;h2&quot;,{children:&quot;Directors&quot;}),t(c,{queryId:&quot;directors&quot;,customCells:ve,cellId:&quot;popularity&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1}),t(&quot;h2&quot;,{children:&quot;Cast&quot;}),t(c,{queryId:&quot;cast&quot;,customCells:ge,cellId:&quot;popularity&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1})]}),ve={directorName:{label:&quot;Director&quot;,component:F},gender:{label:&quot;Gender&quot;,component:$},popularity:{label:&quot;Popularity&quot;},movieCount:{label:&quot;Rated movies&quot;}},ge={castName:{label:&quot;Cast&quot;,component:b},gender:{label:&quot;Gender&quot;,component:$},popularity:{label:&quot;Popularity&quot;},movieCount:{label:&quot;Rated movies&quot;}},Ie=({movieId:e})=&gt;{const o={queryId:&quot;movies&quot;,rowId:e},r=m(&quot;movies&quot;,e,&quot;movieName&quot;);return r==null?null:s(d,{title:r,children:[t(M,{...o,cellId:&quot;movieImage&quot;,isLarge:!0}),s(&quot;ul&quot;,{children:[s(&quot;li&quot;,{children:[&quot;Year: &quot;,t(I,{...o})]}),s(&quot;li&quot;,{children:[&quot;Genre: &quot;,t(C,{...o})]}),s(&quot;li&quot;,{children:[&quot;Rating: &quot;,t(u,{...o,cellId:&quot;rating&quot;})]})]}),t(&quot;p&quot;,{children:t(u,{...o,cellId:&quot;overview&quot;})}),t(&quot;h2&quot;,{children:&quot;Credits&quot;}),s(&quot;ul&quot;,{children:[s(&quot;li&quot;,{children:[t(F,{...o}),&quot;, director&quot;]}),t(&quot;li&quot;,{children:t(b,{...o,billing:1})}),t(&quot;li&quot;,{children:t(b,{...o,billing:2})}),t(&quot;li&quot;,{children:t(b,{...o,billing:3})})]})]})},Ce=({year:e})=&gt;(D({year:e}),t(d,{title:`Movies from ${e}`,children:t(c,{queryId:&quot;yearGenreMovies&quot;,customCells:ye,cellId:&quot;rating&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1})})),ye={movieName:{label:&quot;Movie&quot;,component:f},rating:{label:&quot;Rating&quot;},genreName:{label:&quot;Genre&quot;,component:C}},fe=({genreId:e})=&gt;{D({genreId:e});const o=g(&quot;genres&quot;,e,&quot;name&quot;);return o==null?null:t(d,{title:`${o} movies`,children:t(c,{queryId:&quot;yearGenreMovies&quot;,customCells:be,cellId:&quot;rating&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1})})},be={movieName:{label:&quot;Movie&quot;,component:f},year:{label:&quot;Year&quot;,component:I},rating:{label:&quot;Rating&quot;}},Me=({personId:e})=&gt;{ne(e);const o={tableId:&quot;people&quot;,rowId:e},r=g(&quot;people&quot;,e,&quot;name&quot;),n=g(&quot;people&quot;,e,&quot;died&quot;),i=O(&quot;directedMovies&quot;),a=O(&quot;appearedMovies&quot;);return r==null?null:s(d,{title:r,children:[t(ae,{...o,cellId:&quot;image&quot;,isLarge:!0}),s(&quot;ul&quot;,{children:[s(&quot;li&quot;,{children:[&quot;Gender: &quot;,t(ie,{...o})]}),s(&quot;li&quot;,{children:[&quot;Born: &quot;,t(y,{...o,cellId:&quot;born&quot;}),n&amp;&amp;s(N,{children:[&quot;; died: &quot;,t(y,{...o,cellId:&quot;died&quot;})]})]}),s(&quot;li&quot;,{children:[&quot;Popularity: &quot;,t(y,{...o,cellId:&quot;popularity&quot;})]})]}),t(&quot;p&quot;,{children:t(y,{...o,cellId:&quot;biography&quot;})}),i.length==0?null:s(N,{children:[t(&quot;h2&quot;,{children:&quot;As director:&quot;}),t(c,{queryId:&quot;directedMovies&quot;,customCells:Y,cellId:&quot;rating&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1})]}),a.length==0?null:s(N,{children:[t(&quot;h2&quot;,{children:&quot;As cast:&quot;}),t(c,{queryId:&quot;appearedMovies&quot;,customCells:Y,cellId:&quot;rating&quot;,descending:!0,limit:20,sortOnClick:!0,paginator:!0,idColumn:!1})]})]})},Y={movieName:{label:&quot;Movie&quot;,component:f},year:{label:&quot;Year&quot;,component:I},rating:{label:&quot;Rating&quot;},genreName:{label:&quot;Genre&quot;,component:C}};&lt;/script&gt;&lt;/html&gt;"></iframe><p>In this demo, we build an app that showcases the relational query capabilities of TinyBase v2.0, joining together information about movies, directors, and actors.</p><p>We&#x27;ve also updated it to use parameterized queries to take advantage of TinyBase v7.2.</p><p><img src="https://www.themoviedb.org/assets/2/v4/logos/v2/blue_short-8e7b30f73a4020692ccca9c88bafe5dcb6f8a62a4c6bc55cd9ba82bb2cd95f6c.svg" alt="TMDB" title="Inline logo for TMDB"> - we use The Movie Database as the source of the movie information in this app. Thank you for a great data set to demonstrate TinyBase!</p><h3 id="an-overview-of-the-data">An Overview Of The Data</h3><p>Before looking at code, let&#x27;s familiarize ourselves with the data used in this application.</p><h4 id="tables"><a href="/api/store/type-aliases/store/tables/"><code>Tables</code></a></h4><p>The raw data is loaded into four normalized <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> objects: <code>movies</code> (the top 250 movies on TMDB), <code>genres</code> (the styles of those movies), <code>people</code> (actors and directors), and <code>cast</code> (how the actors are associated with the movies).</p><p>Naturally, there are relationships between these. For example, the <code>directorId</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> of the <code>movies</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> references a person in the <code>people</code> table, and the <code>genreId</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> references the <code>genre</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a>. The <code>cast</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> is a many-to-many join that contains all the <code>movieId</code>/<code>castId</code> pairs for the top three billed actors of each movie.</p><div class="table"><table><thead><tr><th><a href="/api/store/type-aliases/store/table/"><code>Table</code></a></th><th><a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a></th></tr></thead><tbody><tr><td><code>movies</code></td><td><code>id</code>, <code>name</code>, <code>genreId</code>, <code>directorId</code>, <code>year</code>, <code>rating</code>, <code>overview</code>, <code>image</code></td></tr><tr><td><code>genres</code></td><td><code>id</code>, <code>name</code></td></tr><tr><td><code>people</code></td><td><code>id</code>, <code>name</code>, <code>gender</code>, <code>born</code>, <code>died</code>, <code>popularity</code>, <code>biography</code>, <code>image</code></td></tr><tr><td><code>cast</code></td><td><code>id</code>, <code>movieId</code>, <code>castId</code></td></tr></tbody></table></div><p>Because the data is normalized (and fetched as TSV over the wire), it loads quickly. But generally this data isn&#x27;t suited to render directly into the application: the user doesn&#x27;t want to see the movie&#x27;s <code>directorId</code>. They want to see the director&#x27;s <code>name</code>!</p><h4 id="queries"><a href="/api/queries/interfaces/queries/queries/"><code>Queries</code></a></h4><p>The app therefore uses a set of queries against these underlying <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> objects. These act as de-normalized &#x27;views&#x27; of the underlying normalized data and make it easy for the application to render &#x27;virtual&#x27; rows comprised of <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> values from multiple joined <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> objects in the <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a>.</p><p>The following queries are set up for the lifetime of the application:</p><div class="table"><table><thead><tr><th>Query</th><th>From <a href="/api/store/type-aliases/store/tables/"><code>Tables</code></a></th><th><a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a></th></tr></thead><tbody><tr><td><code>movies</code></td><td><code>movies</code>, <code>genres</code>, <code>people</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code>, <code>overview</code>, <code>directorId</code>, <code>directorName</code>, <code>directorImage</code>, <code>castId1</code>, <code>castName1</code>, <code>castImage1</code>, <code>castId2</code>, <code>castName2</code>, <code>castImage2</code>, <code>castId3</code>, <code>castName3</code>, <code>castImage3</code></td></tr><tr><td><code>years</code></td><td><code>movies</code></td><td><code>year</code>, <code>movieCount</code></td></tr><tr><td><code>genres</code></td><td><code>movies</code></td><td><code>genreId</code>, <code>genreName</code>, <code>movieCount</code></td></tr><tr><td><code>directors</code></td><td><code>movies</code>, <code>people</code></td><td><code>directorId</code>, <code>directorName</code>, <code>directorImage</code>, <code>gender</code>, <code>popularity</code>, <code>movieCount</code></td></tr><tr><td><code>cast</code></td><td><code>cast</code>, <code>people</code></td><td><code>castId</code>, <code>castName</code>, <code>castImage</code>, <code>gender</code>, <code>popularity</code>, <code>movieCount</code></td></tr><tr><td><code>yearGenreMovies</code></td><td><code>movies</code>, <code>genres</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code></td></tr><tr><td><code>directedMovies</code></td><td><code>movies</code>, <code>genres</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code></td></tr><tr><td><code>appearedMovies</code></td><td><code>cast</code>, <code>movies</code>, <code>genres</code></td><td><code>movieId</code>, <code>movieName</code>, <code>movieImage</code>, <code>year</code>, <code>rating</code>, <code>genreId</code>, <code>genreName</code></td></tr></tbody></table></div><p>The final three queries are interesting since they are parameterized. <code>yearGenreMovies</code> query accepts optional <code>year</code> and <code>genreId</code> params to filter movies dynamically. Similarly, the <code>directedMovies</code> and <code>appearedMovies</code> queries accept a <code>personId</code> param. This means we can set up these queries once, but update them with different params to get different results as the user drills into different pages.</p><p>You might notice that many of these queries share the same selected <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a>. You&#x27;ll discover that TinyBase lets you compose queries programmatically, so we&#x27;ll be able to build these queries without much repetition: the common <code>queryMovieBasics</code> function is used to select the same <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a> into most of these query views.</p><p>Refer back to this section when we start <a href="#loading-the-data">loading the data</a>, <a href="#querying-the-data">querying the data</a>, and rendering them into the user interface. Otherwise, that&#x27;s enough preamble... let&#x27;s get to some code!</p><h3 id="boilerplate">Boilerplate</h3><p>First, we create the import aliases for TinyBase and React modules we&#x27;ll need:</p><pre><code><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>script</span> <span class="attr-name">type</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>importmap<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="script"><span class="language-javascript">
  <span class="punctuation">{</span>
    <span class="string-property">"imports"</span><span class="operator">:</span> <span class="punctuation">{</span>
      <span class="string-property">"tinybase"</span><span class="operator">:</span> <span class="string">"https://esm.sh/tinybase@8.0.0-beta.1"</span><span class="punctuation">,</span>
      <span class="string-property">"tinybase/ui-react"</span><span class="operator">:</span> <span class="string">"https://esm.sh/tinybase@8.0.0-beta.1/ui-react"</span><span class="punctuation">,</span>
      <span class="string-property">"tinybase/ui-react-dom"</span><span class="operator">:</span> <span class="string">"https://esm.sh/tinybase@8.0.0-beta.1/ui-react-dom"</span><span class="punctuation">,</span>
      <span class="string-property">"tinybase/ui-react-inspector"</span><span class="operator">:</span> <span class="string">"https://esm.sh/tinybase@8.0.0-beta.1/ui-react-inspector"</span><span class="punctuation">,</span>
      <span class="string-property">"react"</span><span class="operator">:</span> <span class="string">"https://esm.sh/react@^19.2.4"</span><span class="punctuation">,</span>
      <span class="string-property">"react/jsx-runtime"</span><span class="operator">:</span> <span class="string">"https://esm.sh/react@^19.2.4/jsx-runtime"</span><span class="punctuation">,</span>
      <span class="string-property">"react-dom/client"</span><span class="operator">:</span> <span class="string">"https://esm.sh/react-dom@^19.2.4/client"</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</span></span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>script</span><span class="punctuation">></span></span>
</code></pre><p>We&#x27;re using the <a href="/api/the-essentials/using-react/inspector/"><code>Inspector</code></a> component for the purposes of seeing how the data is structured.</p><p>We need the following parts of the TinyBase API, the <a href="/api/ui-react/"><code>ui-react</code></a> module, and React itself:</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>useMemo<span class="punctuation">,</span> useState<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createRoot<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'react-dom/client'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createQueries<span class="punctuation">,</span> createStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>
  CellView<span class="punctuation">,</span>
  Provider<span class="punctuation">,</span>
  ResultCellView<span class="punctuation">,</span>
  useCell<span class="punctuation">,</span>
  useCreateQueries<span class="punctuation">,</span>
  useCreateStore<span class="punctuation">,</span>
  useQueries<span class="punctuation">,</span>
  useResultCell<span class="punctuation">,</span>
  useResultRowIds<span class="punctuation">,</span>
  useSetParamValuesCallback<span class="punctuation">,</span>
  useSetValuesCallback<span class="punctuation">,</span>
  useValues<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/ui-react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>ResultSortedTableInHtmlTable<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/ui-react-dom'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>Inspector<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/ui-react-inspector'</span><span class="punctuation">;</span>
</code></pre><h3 id="initializing-the-application">Initializing The Application</h3><p>In the main part of the application, we want to initialize a default <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> (called <code>store</code>) and a named <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> called <code>viewStore</code>. The latter serves the sole purpose of remembering the &#x27;route&#x27; in the application, which describes which part of the user interface the user is looking at.</p><p>We also initialize a <a href="/api/queries/interfaces/queries/queries/"><code>Queries</code></a> object, and use the <code>createAndInitQueries</code> function (which we&#x27;ll describe later) to set up the queries for the application.</p><p>The two <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> objects and the <a href="/api/queries/interfaces/queries/queries/"><code>Queries</code></a> object are memoized by the useCreateStore method and useCreateQueries method so they are only created the first time the app is rendered.</p><pre><code><span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/the-essentials/using-react/usecreatestore/">useCreateStore</a></span><span class="punctuation">(</span>createStore<span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> viewStore <span class="operator">=</span> <span class="function"><a href="/api/the-essentials/using-react/usecreatestore/">useCreateStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
    <span class="function"><a href="/api/the-essentials/creating-stores/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setvalues/">setValues</a></span><span class="punctuation">(</span><span class="punctuation">{</span><span class="literal-property">currentSection</span><span class="operator">:</span> <span class="string">'movies'</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> queries <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/usecreatequeries/">useCreateQueries</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> createAndInitQueries<span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="comment">// ...</span>
</code></pre><p>This application depends on loading data into the main <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> the first time it is rendered. We do this by having an <code>isLoading</code> flag in the application&#x27;s state, and setting it to <code>false</code> only once the asynchronous loading sequence in the (soon-to-be described) <code>loadStore</code> function has completed. Until then, a loading spinner is shown.</p><pre><code>  <span class="comment">// ...</span>
  <span class="keyword">const</span> <span class="punctuation">[</span>isLoading<span class="punctuation">,</span> setIsLoading<span class="punctuation">]</span> <span class="operator">=</span> <span class="function">useState</span><span class="punctuation">(</span><span class="boolean">true</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">useMemo</span><span class="punctuation">(</span><span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="keyword">await</span> <span class="function">loadStore</span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">setIsLoading</span><span class="punctuation">(</span><span class="boolean">false</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/the-essentials/using-react/provider/">Provider</a></span></span> <span class="attr-name">store</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>store<span class="punctuation">}</span></span> <span class="attr-name">storesById</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="punctuation">{</span>viewStore<span class="punctuation">}</span><span class="punctuation">}</span></span> <span class="attr-name">queries</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queries<span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Header</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="punctuation">{</span>isLoading <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Loading</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Body</span></span> <span class="punctuation">/></span></span><span class="punctuation">}</span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/the-essentials/using-react/inspector/">Inspector</a></span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name"><a href="/api/the-essentials/using-react/provider/">Provider</a></span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><p>We also added the <a href="/api/the-essentials/using-react/inspector/"><code>Inspector</code></a> component at the end there so you can inspect what is going on with the data during this demo. Simply click the TinyBase logo in the corner.</p><p>With simple boilerplate code to load the component, off we go:</p><pre><code><span class="function">addEventListener</span><span class="punctuation">(</span><span class="string">'load'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">createRoot</span><span class="punctuation">(</span>document<span class="punctuation">.</span>body<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><h3 id="basic-components">Basic Components</h3><p>Before we get to the really interesting parts, let&#x27;s dispense with the basic building blocks for the application&#x27;s user interface.</p><h4 id="loading-spinner">Loading Spinner</h4><p>First the loading spinner, a plain element with some CSS.</p><pre><code><span class="keyword">const</span> <span class="function-variable">Loading</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>div</span> <span class="attr-name">id</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>loading<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>
</code></pre><p>This is styled as a 270° arc with a spinning animation:</p><pre><code><span class="selector">#loading</span> <span class="punctuation">{</span>
  <span class="property">animation</span><span class="punctuation">:</span> spin 1s infinite linear<span class="punctuation">;</span>
  <span class="property">height</span><span class="punctuation">:</span> 2rem<span class="punctuation">;</span>
  <span class="property">margin</span><span class="punctuation">:</span> 40vh auto<span class="punctuation">;</span>
  <span class="property">width</span><span class="punctuation">:</span> 2rem<span class="punctuation">;</span>
  <span class="selector">&amp;::before</span> <span class="punctuation">{</span>
    <span class="property">content</span><span class="punctuation">:</span> <span class="url"><span class="function">url</span><span class="punctuation">(</span><span class="string">'data:image/svg+xml,&lt;svg xmlns="http://www.w3.org/2000/svg" height="2rem" viewBox="0 0 100 100">&lt;path d="M50 10A40 40 0 1 1 10 50" stroke="black" fill="none" stroke-width="4" />&lt;/svg>'</span><span class="punctuation">)</span></span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>

<span class="atrule">@keyframes spin</span> <span class="punctuation">{</span>
  <span class="selector">from</span> <span class="punctuation">{</span>
    <span class="property">transform</span><span class="punctuation">:</span> <span class="function">rotate</span><span class="punctuation">(</span>0<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
  <span class="selector">to</span> <span class="punctuation">{</span>
    <span class="property">transform</span><span class="punctuation">:</span> <span class="function">rotate</span><span class="punctuation">(</span>360deg<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><h4 id="application-sections">Application Sections</h4><p>Next the structure of the application. It has four sections: &#x27;Movies&#x27;, &#x27;Years&#x27;, &#x27;Genres&#x27;, and &#x27;People&#x27;. We define their outer components and create a keyed collection of them. Each either shows an overview (for example, all movies) or the detail of one particular record (for example, a single movie):</p><pre><code><span class="keyword">const</span> <span class="function-variable">MoviesSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">MoviesOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">MovieDetail</span></span> <span class="attr-name">movieId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">YearsSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">YearsOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">YearDetail</span></span> <span class="attr-name">year</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">GenresSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenresOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenreDetail</span></span> <span class="attr-name">genreId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">PeopleSection</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  detailId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">PeopleOverview</span></span> <span class="punctuation">/></span></span> <span class="operator">:</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">PersonDetail</span></span> <span class="attr-name">personId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>detailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="constant">SECTIONS</span> <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">movies</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'Movies'</span><span class="punctuation">,</span> MoviesSection<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="literal-property">years</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'Years'</span><span class="punctuation">,</span> YearsSection<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="literal-property">genres</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'Genres'</span><span class="punctuation">,</span> GenresSection<span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="literal-property">people</span><span class="operator">:</span> <span class="punctuation">[</span><span class="string">'People'</span><span class="punctuation">,</span> PeopleSection<span class="punctuation">]</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>The <code>viewStore</code> contains the section name and optionally a string detail ID (such as the movie&#x27;s <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a>), both as <a href="/api/store/type-aliases/store/values/"><code>Values</code></a>. The <code>useRoute</code> hook gets this pair, and the <code>useSetRouteCallback</code> hook will be used to set it in response to the user clicking links in the app.</p><pre><code><span class="keyword">const</span> <span class="function-variable">useRoute</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usevalues/">useValues</a></span><span class="punctuation">(</span><span class="string">'viewStore'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> <span class="function-variable">useSetRouteCallback</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">currentSection<span class="punctuation">,</span> currentDetailId</span><span class="punctuation">)</span> <span class="operator">=></span>
  <span class="function"><a href="/api/ui-react/functions/store-hooks/usesetvaluescallback/">useSetValuesCallback</a></span><span class="punctuation">(</span>
    <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span><span class="punctuation">{</span>currentSection<span class="punctuation">,</span> currentDetailId<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>currentSection<span class="punctuation">,</span> currentDetailId<span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="string">'viewStore'</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>Note that we&#x27;re not doing anything fancy here like updating the browser&#x27;s URL address or history state as the user navigates around, but we would add that in this method if we did.</p><p>(Another easy, but interesting, exercise for the reader would be to use the <a href="/api/checkpoints/interfaces/checkpoints/checkpoints/"><code>Checkpoints</code></a> API on the <code>viewStore</code> to create an in-app history stack for the pages viewed!)</p><h4 id="application-header">Application Header</h4><p>The header component simply renders all the links for the <code>SECTIONS</code> object and highlights the one that matches the current route.</p><pre><code><span class="keyword">const</span> <span class="function-variable">Header</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> <span class="punctuation">{</span>currentSection<span class="punctuation">}</span> <span class="operator">=</span> <span class="function">useRoute</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>nav</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="punctuation">{</span>Object<span class="punctuation">.</span><span class="function">entries</span><span class="punctuation">(</span><span class="constant">SECTIONS</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter"><span class="punctuation">[</span>section<span class="punctuation">,</span> <span class="punctuation">[</span>title<span class="punctuation">]</span><span class="punctuation">]</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
        <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span>
          <span class="attr-name">className</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>currentSection <span class="operator">==</span> section <span class="operator">?</span> <span class="string">'current'</span> <span class="operator">:</span> <span class="string">''</span><span class="punctuation">}</span></span>
          <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span>section<span class="punctuation">,</span> <span class="keyword">null</span><span class="punctuation">)</span><span class="punctuation">}</span></span>
        <span class="punctuation">></span></span><span class="plain-text">
          </span><span class="punctuation">{</span>title<span class="punctuation">}</span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
      <span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>nav</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>The header also has very simple styling:</p><pre><code><span class="selector">nav</span> <span class="punctuation">{</span>
  <span class="property">background</span><span class="punctuation">:</span> #eee<span class="punctuation">;</span>
  <span class="property">display</span><span class="punctuation">:</span> flex<span class="punctuation">;</span>
  <span class="selector">a</span> <span class="punctuation">{</span>
    <span class="property">flex</span><span class="punctuation">:</span> 1<span class="punctuation">;</span>
    <span class="property">padding</span><span class="punctuation">:</span> 0.25rem<span class="punctuation">;</span>
    <span class="property">text-align</span><span class="punctuation">:</span> center<span class="punctuation">;</span>
    <span class="selector">&amp;.current</span> <span class="punctuation">{</span>
      <span class="property">background</span><span class="punctuation">:</span> #ddd<span class="punctuation">;</span>
      <span class="property">font-weight</span><span class="punctuation">:</span> 600<span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><h4 id="application-body">Application Body</h4><p>Finally, we use the current route to load the appropriate section and render it into the main part of the application:</p><pre><code><span class="keyword">const</span> <span class="function-variable">Body</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> <span class="punctuation">{</span>currentSection<span class="punctuation">,</span> currentDetailId<span class="punctuation">}</span> <span class="operator">=</span> <span class="function">useRoute</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">if</span> <span class="punctuation">(</span><span class="constant">SECTIONS</span><span class="punctuation">[</span>currentSection<span class="punctuation">]</span> <span class="operator">!=</span> <span class="keyword">null</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">const</span> <span class="punctuation">[</span><span class="punctuation">,</span> Section<span class="punctuation">]</span> <span class="operator">=</span> <span class="constant">SECTIONS</span><span class="punctuation">[</span>currentSection<span class="punctuation">]</span><span class="punctuation">;</span>
    <span class="keyword">return</span> <span class="punctuation">(</span>
      <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>main</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Section</span></span> <span class="attr-name">detailId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>currentDetailId<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>main</span><span class="punctuation">></span></span>
    <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
  <span class="keyword">return</span> <span class="keyword">null</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Again, this component has minimal styling:</p><pre><code><span class="selector">main</span> <span class="punctuation">{</span>
  <span class="property">padding</span><span class="punctuation">:</span> 0.5rem<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><h3 id="loading-the-data">Loading The Data</h3><p>We now move onto the more interesting data manipulation and rendering logic in the application.</p><p>The movie data for the application is sourced from TMDB and has been converted into a tab-separated variable format. TSV files are smaller and faster than JSON to load over the wire, but nonetheless, we load them asynchronously.</p><p>The logic here should be reasonably self-evident. We extract the column names from the top of the TSV, check each row has a matching cardinality, use the first column as the <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a>, coerce numeric <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> values, and load everything into a standard <a href="/api/store/type-aliases/store/table/"><code>Table</code></a>.</p><pre><code><span class="keyword">const</span> <span class="constant">NUMERIC</span> <span class="operator">=</span> <span class="regex"><span class="regex-delimiter">/</span><span class="regex-source">^[\d\.]+$</span><span class="regex-delimiter">/</span></span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">loadTable</span> <span class="operator">=</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">store<span class="punctuation">,</span> tableId</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> rows <span class="operator">=</span> <span class="punctuation">(</span>
    <span class="keyword">await</span> <span class="punctuation">(</span><span class="keyword">await</span> <span class="function">fetch</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">https://tinybase.org/assets/</span><span class="interpolation"><span class="interpolation-punctuation">${</span>tableId<span class="interpolation-punctuation">}</span></span><span class="string">.tsv</span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">text</span><span class="punctuation">(</span><span class="punctuation">)</span>
  <span class="punctuation">)</span><span class="punctuation">.</span><span class="function">split</span><span class="punctuation">(</span><span class="string">'\n'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> cellIds <span class="operator">=</span> rows<span class="punctuation">.</span><span class="function">shift</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">split</span><span class="punctuation">(</span><span class="string">'\t'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  rows<span class="punctuation">.</span><span class="function">forEach</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">row</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="keyword">const</span> cells <span class="operator">=</span> row<span class="punctuation">.</span><span class="function">split</span><span class="punctuation">(</span><span class="string">'\t'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span>cells<span class="punctuation">.</span>length <span class="operator">==</span> cellIds<span class="punctuation">.</span>length<span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">const</span> rowId <span class="operator">=</span> cells<span class="punctuation">.</span><span class="function">shift</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
      cells<span class="punctuation">.</span><span class="function">forEach</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">cell<span class="punctuation">,</span> c</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span>cell <span class="operator">!=</span> <span class="string">''</span><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">if</span> <span class="punctuation">(</span><span class="constant">NUMERIC</span><span class="punctuation">.</span><span class="function">test</span><span class="punctuation">(</span>cell<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
            cell <span class="operator">=</span> <span class="function">parseFloat</span><span class="punctuation">(</span>cell<span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span>
          store<span class="punctuation">.</span><span class="function"><a href="/api/the-essentials/setting-data/setcell/">setCell</a></span><span class="punctuation">(</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellIds<span class="punctuation">[</span>c <span class="operator">+</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> cell<span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>There are four raw tables used in this application, as described in our opening section. We wait for all four to load (again, asynchronously) wrapped in a single <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> transaction.</p><pre><code><span class="keyword">const</span> <span class="function-variable">loadStore</span> <span class="operator">=</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/starttransaction/">startTransaction</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">await</span> Promise<span class="punctuation">.</span><span class="function">all</span><span class="punctuation">(</span>
    <span class="punctuation">[</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'cast'</span><span class="punctuation">]</span><span class="punctuation">.</span><span class="function">map</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">tableId</span><span class="punctuation">)</span> <span class="operator">=></span>
      <span class="function">loadTable</span><span class="punctuation">(</span>store<span class="punctuation">,</span> tableId<span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/finishtransaction/">finishTransaction</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p><code>loadStore</code> was the function referenced in the <a href="#initializing-the-application">main <code>App</code> component</a>, so once this completes, the data is loaded and we&#x27;re ready to go.</p><h3 id="querying-the-data">Querying The Data</h3><p>As described <a href="#queries">at the start of this article</a>, there are a number of queries that are set up at the beginning of the app and which are used throughout its lifetime. These include the list of all movies with de-normalized genre, director, and cast names (a query called <code>movies</code>); and queries that group counts of movies by genre, year, and so on.</p><p>Since many queries throughout the app re-use the same set of fields - such as movie name, image, year, and genre - we can first create a re-usable function that specifies those <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a>. This can be used whenever the <code>movies</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> is the root of the query. When provided a <code>select</code> and <code>join</code> function, it selects those common columns:</p><pre><code><span class="keyword">const</span> <span class="function-variable">queryMovieBasics</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> movieId</span><span class="punctuation">)</span> <span class="operator">=></span> movieId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'rating'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'genreName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">join</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Notice that we use a convention in this app of suffixing <code>[</code>Id<code>](/api/common/type-aliases/identity/id/)</code>, <code>Name</code> and <code>Image</code> to resulting <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a>.</p><p>In the <code>App</code> component we described at the start of the article, we call a function called <code>createAndInitQueries</code> to initialize the queries. Here&#x27;s its implementation:</p><pre><code><span class="keyword">const</span> <span class="function-variable">createAndInitQueries</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> queries <span class="operator">=</span> <span class="function"><a href="/api/queries/functions/creation/createqueries/">createQueries</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="comment">// ...</span>
</code></pre><p>First we define the <code>movies</code> query that populates the main overview of the movies section of the app, and provides the detail about the movie&#x27;s overview, directors and cast.</p><p>The join to the <code>people</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> for the director name and image should be self-explanatory. What is slightly more interesting is the way we join to get the cast names and images. Each movie has up to three cast members captured in the <code>cast</code> many-to-many join <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> - and so we join through <em>that</em> table three times according to their billing.</p><pre><code><span class="comment">// ...</span>
queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">queryMovieBasics</span><span class="punctuation">(</span><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'overview'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span><span class="punctuation">.</span><span class="function">forEach</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">billing</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="keyword">const</span> castJoin <span class="operator">=</span> <span class="template-string"><span class="template-punctuation">`</span><span class="string">cast</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">;</span>
    <span class="function">join</span><span class="punctuation">(</span><span class="string">'cast'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> movieId</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="template-string"><span class="template-punctuation">`</span><span class="interpolation"><span class="interpolation-punctuation">${</span>movieId<span class="interpolation-punctuation">}</span></span><span class="string">/</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span>castJoin<span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span>castJoin<span class="punctuation">,</span> <span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castId</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">const</span> actorJoin <span class="operator">=</span> <span class="template-string"><span class="template-punctuation">`</span><span class="string">actors</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">;</span>
    <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> castJoin<span class="punctuation">,</span> <span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span>actorJoin<span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span>actorJoin<span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castName</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="function">select</span><span class="punctuation">(</span>actorJoin<span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castImage</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// ...</span>
</code></pre><p>For the SQL-inclined amongst you, we&#x27;ve created something more or less equivalent to the following query:</p><pre><code><span class="comment">-- movies query</span>
<span class="keyword">SELECT</span>
  movies<span class="punctuation">.</span>_rowId <span class="keyword">AS</span> movieId<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>name <span class="keyword">AS</span> movieName<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>image <span class="keyword">AS</span> movieImage<span class="punctuation">,</span>
  movies<span class="punctuation">.</span><span class="keyword">year</span> <span class="keyword">AS</span> <span class="keyword">year</span><span class="punctuation">,</span>
  movies<span class="punctuation">.</span>rating <span class="keyword">AS</span> rating<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>genreId <span class="keyword">AS</span> genreId<span class="punctuation">,</span>
  genres<span class="punctuation">.</span>name <span class="keyword">AS</span> genreName<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>overview <span class="keyword">AS</span> overview<span class="punctuation">,</span>
  movies<span class="punctuation">.</span>directorId <span class="keyword">AS</span> directorId<span class="punctuation">,</span>
  directors<span class="punctuation">.</span>name <span class="keyword">AS</span> directorName<span class="punctuation">,</span>
  directors<span class="punctuation">.</span>image <span class="keyword">AS</span> directorImage<span class="punctuation">,</span>
  cast1<span class="punctuation">.</span>castId <span class="keyword">AS</span> castId1<span class="punctuation">,</span>
  actors1<span class="punctuation">.</span>name <span class="keyword">AS</span> castName1<span class="punctuation">,</span>
  actors1<span class="punctuation">.</span>image <span class="keyword">AS</span> castImage1<span class="punctuation">,</span>
  cast2<span class="punctuation">.</span>castId <span class="keyword">AS</span> castId2<span class="punctuation">,</span>
  actors2<span class="punctuation">.</span>name <span class="keyword">AS</span> castName2<span class="punctuation">,</span>
  actors2<span class="punctuation">.</span>image <span class="keyword">AS</span> castImage2<span class="punctuation">,</span>
  cast3<span class="punctuation">.</span>castId <span class="keyword">AS</span> castId3<span class="punctuation">,</span>
  actors3<span class="punctuation">.</span>name <span class="keyword">AS</span> castName3<span class="punctuation">,</span>
  actors3<span class="punctuation">.</span>image <span class="keyword">AS</span> castImage3
<span class="keyword">FROM</span>
  movies
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> genres
      <span class="keyword">ON</span> genres<span class="punctuation">.</span>_rowId <span class="operator">=</span> movies<span class="punctuation">.</span>genreId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> directors
      <span class="keyword">ON</span> directors<span class="punctuation">.</span>_rowId <span class="operator">=</span> movies<span class="punctuation">.</span>directorId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> cast <span class="keyword">AS</span> cast1
      <span class="keyword">ON</span> cast1<span class="punctuation">.</span>_rowId <span class="operator">=</span> CONCAT<span class="punctuation">(</span>movies<span class="punctuation">.</span>movieId<span class="punctuation">,</span> <span class="string">'/1'</span><span class="punctuation">)</span>
      <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> actors1
        <span class="keyword">ON</span> actors1<span class="punctuation">.</span>_rowId <span class="operator">=</span> cast1<span class="punctuation">.</span>castId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> cast <span class="keyword">AS</span> cast2
      <span class="keyword">ON</span> cast2<span class="punctuation">.</span>_rowId <span class="operator">=</span> CONCAT<span class="punctuation">(</span>movies<span class="punctuation">.</span>movieId<span class="punctuation">,</span> <span class="string">'/2'</span><span class="punctuation">)</span>
      <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> actors2
        <span class="keyword">ON</span> actors2<span class="punctuation">.</span>_rowId <span class="operator">=</span> cast2<span class="punctuation">.</span>castId
    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> cast <span class="keyword">AS</span> cast3
      <span class="keyword">ON</span> cast3<span class="punctuation">.</span>_rowId <span class="operator">=</span> CONCAT<span class="punctuation">(</span>movies<span class="punctuation">.</span>movieId<span class="punctuation">,</span> <span class="string">'/3'</span><span class="punctuation">)</span>
      <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> people <span class="keyword">AS</span> actors3
        <span class="keyword">ON</span> actors3<span class="punctuation">.</span>_rowId <span class="operator">=</span> cast3<span class="punctuation">.</span>castId
</code></pre><p>(Except the results in our case are reactive - not something you usually get to benefit from with a SQL-based database!)</p><p>We also create query definitions for the other persistent queries. These use the <code>group</code> function to count the number of movies per year, genre, and so on, used in the overview components of each of the main sections of the app.</p><pre><code><span class="comment">// ...</span>
queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'years'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> rowId</span><span class="punctuation">)</span> <span class="operator">=></span> rowId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> rowId</span><span class="punctuation">)</span> <span class="operator">=></span> rowId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">join</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'genreName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'directors'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">_<span class="punctuation">,</span> rowId</span><span class="punctuation">)</span> <span class="operator">=></span> rowId<span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'directorImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'popularity'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span><span class="string">'cast'</span><span class="punctuation">,</span> <span class="string">'cast'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> group<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'castName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'castImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">select</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'popularity'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">join</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> <span class="string">'castId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function">group</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieCount'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// ...</span>
</code></pre><p>And finally the parameterized queries. The <code>yearGenreMovies</code> query definition is re-used across the app, so note that it takes optional params for <code>year</code> and <code>genreId</code> so that different views can show movies by year or genre if required. Similarly, the <code>directedMovies</code> and <code>appearedMovies</code> queries take a <code>personId</code> param to show movies for a specific director or actor.</p><pre><code>  <span class="comment">// ...</span>
  queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span>
    <span class="string">'yearGenreMovies'</span><span class="punctuation">,</span>
    <span class="string">'movies'</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> where<span class="punctuation">,</span> param<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
      <span class="function">queryMovieBasics</span><span class="punctuation">(</span><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><span class="function">param</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="function">where</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">,</span> <span class="function">param</span><span class="punctuation">(</span><span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><span class="function">param</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="function">where</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">,</span> <span class="function">param</span><span class="punctuation">(</span><span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span><span class="punctuation">,</span>
    <span class="punctuation">{</span><span class="literal-property">year</span><span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">,</span> <span class="literal-property">genreId</span><span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span>
    <span class="string">'directedMovies'</span><span class="punctuation">,</span>
    <span class="string">'movies'</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> where<span class="punctuation">,</span> param<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
      <span class="function">queryMovieBasics</span><span class="punctuation">(</span><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">where</span><span class="punctuation">(</span><span class="string">'directorId'</span><span class="punctuation">,</span> <span class="function">param</span><span class="punctuation">(</span><span class="string">'personId'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">,</span>
    <span class="punctuation">{</span><span class="literal-property">personId</span><span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  queries<span class="punctuation">.</span><span class="function"><a href="/api/queries/interfaces/queries/queries/methods/configuration/setquerydefinition/">setQueryDefinition</a></span><span class="punctuation">(</span>
    <span class="string">'appearedMovies'</span><span class="punctuation">,</span>
    <span class="string">'cast'</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>select<span class="punctuation">,</span> join<span class="punctuation">,</span> where<span class="punctuation">,</span> param<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
      <span class="function">select</span><span class="punctuation">(</span><span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'image'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'movieImage'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'rating'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">select</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">select</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function">as</span><span class="punctuation">(</span><span class="string">'genreName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">join</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">join</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="function">where</span><span class="punctuation">(</span><span class="string">'castId'</span><span class="punctuation">,</span> <span class="function">param</span><span class="punctuation">(</span><span class="string">'personId'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">,</span>
    <span class="punctuation">{</span><span class="literal-property">personId</span><span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> queries<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><p>That&#x27;s it for the main persistent queries that power all the different views of the app. We&#x27;ll refer to these by their query <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> when we actually bind them to components.</p><p>Finally, let&#x27;s create a convenient hook that will allow us to parameterize the <code>yearGenreMovies</code> query, and one to parameterize both the <code>directedMovies</code> and <code>appearedMovies</code> queries for a given person:</p><pre><code><span class="keyword">const</span> <span class="function-variable">useSetYearGenre</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>year<span class="punctuation">,</span> genreId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  <span class="function"><a href="/api/ui-react/functions/queries-hooks/usesetparamvaluescallback/">useSetParamValuesCallback</a></span><span class="punctuation">(</span>
    <span class="string">'yearGenreMovies'</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="parameter">yearGenre</span><span class="punctuation">)</span> <span class="operator">=></span> yearGenre<span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">(</span><span class="punctuation">{</span>year<span class="punctuation">,</span> genreId<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">useSetPersonMovies</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">personId</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function"><a href="/api/ui-react/functions/queries-hooks/usesetparamvaluescallback/">useSetParamValuesCallback</a></span><span class="punctuation">(</span><span class="string">'directedMovies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter">person</span><span class="punctuation">)</span> <span class="operator">=></span> person<span class="punctuation">)</span><span class="punctuation">(</span><span class="punctuation">{</span>personId<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function"><a href="/api/ui-react/functions/queries-hooks/usesetparamvaluescallback/">useSetParamValuesCallback</a></span><span class="punctuation">(</span><span class="string">'appearedMovies'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter">person</span><span class="punctuation">)</span> <span class="operator">=></span> person<span class="punctuation">)</span><span class="punctuation">(</span><span class="punctuation">{</span>personId<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><h3 id="the-resultsortedtableinhtmltable-component">The <a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/"><code>ResultSortedTableInHtmlTable</code></a> Component</h3><p>Most of the movies app is built from tabular data views, and it&#x27;s nice to have a re-usable <code>&lt;table&gt;</code> rendering, complete with sorting, pagination, and formatting.</p><p>Previously there was a whole table implementation in this demo, but as of TinyBase v4.1, we just use the <a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/"><code>ResultSortedTableInHtmlTable</code></a> component from the new <a href="/api/ui-react-dom/"><code>ui-react-dom</code></a> module straight out of the box! You&#x27;ll see we use it throughout the app.</p><p>This component also benefits from some light styling for the pagination buttons and the table itself:</p><pre><code><span class="selector">table</span> <span class="punctuation">{</span>
  <span class="property">border-collapse</span><span class="punctuation">:</span> collapse<span class="punctuation">;</span>
  <span class="property">font-size</span><span class="punctuation">:</span> inherit<span class="punctuation">;</span>
  <span class="property">line-height</span><span class="punctuation">:</span> inherit<span class="punctuation">;</span>
  <span class="property">margin-top</span><span class="punctuation">:</span> 0.5rem<span class="punctuation">;</span>
  <span class="property">table-layout</span><span class="punctuation">:</span> fixed<span class="punctuation">;</span>
  <span class="property">width</span><span class="punctuation">:</span> 100%<span class="punctuation">;</span>
  <span class="selector">caption</span> <span class="punctuation">{</span>
    <span class="property">text-align</span><span class="punctuation">:</span> left<span class="punctuation">;</span>
    <span class="selector">button</span> <span class="punctuation">{</span>
      <span class="property">border</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
      <span class="property">margin-right</span><span class="punctuation">:</span> 0.25rem<span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
  <span class="selector">th,
  td</span> <span class="punctuation">{</span>
    <span class="property">padding</span><span class="punctuation">:</span> 0.25rem 0.5rem 0.25rem 0<span class="punctuation">;</span>
    <span class="property">overflow</span><span class="punctuation">:</span> hidden<span class="punctuation">;</span>
    <span class="property">white-space</span><span class="punctuation">:</span> nowrap<span class="punctuation">;</span>
    <span class="property">text-overflow</span><span class="punctuation">:</span> ellipsis<span class="punctuation">;</span>
  <span class="punctuation">}</span>
  <span class="selector">th</span> <span class="punctuation">{</span>
    <span class="property">border</span><span class="punctuation">:</span> solid #ddd<span class="punctuation">;</span>
    <span class="property">border-width</span><span class="punctuation">:</span> 1px 0<span class="punctuation">;</span>
    <span class="property">cursor</span><span class="punctuation">:</span> pointer<span class="punctuation">;</span>
    <span class="property">text-align</span><span class="punctuation">:</span> left<span class="punctuation">;</span>
    <span class="property">width</span><span class="punctuation">:</span> 20%<span class="punctuation">;</span>
    <span class="selector">&amp;:nth-child(1)</span> <span class="punctuation">{</span>
      <span class="property">width</span><span class="punctuation">:</span> 40%<span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
  <span class="selector">td</span> <span class="punctuation">{</span>
    <span class="property">border-bottom</span><span class="punctuation">:</span> 1px solid #eee<span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><h3 id="linking-between-views">Linking Between Views</h3><p>Throughout the app, if you click on a movie name (wherever you see it), we&#x27;ll want to take you to the movie detail. Clicking a year should take you to the list of movies for the year, a genre to the list of movies in a genre - and so on.</p><p>For example, the <code>MovieLink</code> component creates a link that sets the route to be the <code>movies</code> section, with the value of the <code>movieId</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> from the result <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> being rendered. The <code>ImageFromQuery</code> component we&#x27;ll discuss later.</p><p>Here we create a collection of tiny custom components which, when passed a <code>queryId</code> and <code>rowId</code> can render a decorated link which, when clicked, update the application&#x27;s route. We will be using these in the customCell props of the <code>ResultSortedTableInHtmlTable</code> instances to configure them as custom cell renderers.</p><p>This component obviously assumes that the <code>movieId</code>, <code>movieImage</code>, and <code>movieName</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a> are present in the query, so we only use this for queries that meaningfully populate those.</p><pre><code><span class="keyword">const</span> <span class="function-variable">MovieLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> movieId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'movieId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> movieId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieImage<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview/">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieName<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>We do the same for queries that contain a <code>year</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a>, for those that contain <code>genreId</code> and <code>genreName</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a>, and for those that contain <code>directorId</code> and <code>directorName</code> <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> <a href="/api/common/type-aliases/identity/ids/"><code>Ids</code></a>:</p><pre><code><span class="keyword">const</span> <span class="function-variable">YearLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> year <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'year'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'years'</span><span class="punctuation">,</span> year<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview/">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>year<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">GenreLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> genreId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'genreId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> genreId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview/">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>genreName<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">DirectorLink</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> personId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'directorId'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>directorImage<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview/">ResultCellView</a></span></span> <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span> <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>directorName<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>We do the same for actors, but for the billed cast members we need to check tor existence, in case a movie does not have three actors:</p><pre><code><span class="keyword">const</span> CastLink <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> billing <span class="operator">=</span> <span class="string">''</span><span class="punctuation">}</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> personId <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="template-string"><span class="template-punctuation">`</span><span class="string">castId</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> personId <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>a</span> <span class="attr-name">onClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function">useSetRouteCallback</span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">)</span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span>
        <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span>
        <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span>
        <span class="attr-name">cellId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castImage</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview/">ResultCellView</a></span></span>
        <span class="attr-name">queryId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>queryId<span class="punctuation">}</span></span>
        <span class="attr-name">rowId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>rowId<span class="punctuation">}</span></span>
        <span class="attr-name">cellId</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">castName</span><span class="interpolation"><span class="interpolation-punctuation">${</span>billing<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>a</span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><h3 id="helper-components">Helper Components</h3><p>Throughout the app, we&#x27;ll use a few simple helper components. Let&#x27;s get them defined up front.</p><p>These take the numeric TMDB gender <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> (from the <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> of a <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> or the result <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> of query) and render it as a string:</p><pre><code><span class="keyword">const</span> <span class="function-variable">GenderFromQuery</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  <span class="function">genderString</span><span class="punctuation">(</span><span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">GenderFromTable</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span>
  <span class="function">genderString</span><span class="punctuation">(</span><span class="function"><a href="/api/the-essentials/using-react/usecell/">useCell</a></span><span class="punctuation">(</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> <span class="string">'gender'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">genderString</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">genderId</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">switch</span> <span class="punctuation">(</span>genderId<span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">case</span> <span class="number">1</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Female'</span><span class="punctuation">;</span>
    <span class="keyword">case</span> <span class="number">2</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Male'</span><span class="punctuation">;</span>
    <span class="keyword">case</span> <span class="number">3</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Non-binary'</span><span class="punctuation">;</span>
    <span class="keyword">default</span><span class="operator">:</span>
      <span class="keyword">return</span> <span class="string">'Unknown'</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>These take a TMDB image path (again from the <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> of a <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> or the result <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> of query) and render it in large or small format:</p><pre><code><span class="keyword">const</span> <span class="function-variable">ImageFromQuery</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">,</span> isLarge<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Image</span></span> <span class="attr-name">imageFile</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span>queryId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">)</span><span class="punctuation">}</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>isLarge<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">ImageFromTable</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">,</span> isLarge<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Image</span></span> <span class="attr-name">imageFile</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="function"><a href="/api/the-essentials/using-react/usecell/">useCell</a></span><span class="punctuation">(</span>tableId<span class="punctuation">,</span> rowId<span class="punctuation">,</span> cellId<span class="punctuation">)</span><span class="punctuation">}</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>isLarge<span class="punctuation">}</span></span> <span class="punctuation">/></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">Image</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>imageFile<span class="punctuation">,</span> isLarge<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>img</span>
    <span class="attr-name">src</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">https://image.tmdb.org/t/p/w</span><span class="interpolation"><span class="interpolation-punctuation">${</span>isLarge <span class="operator">?</span> <span class="number">92</span> <span class="operator">:</span> <span class="number">45</span><span class="interpolation-punctuation">}</span></span><span class="interpolation"><span class="interpolation-punctuation">${</span>imageFile<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span>
    <span class="attr-name">className</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>isLarge <span class="operator">?</span> <span class="string">'large'</span> <span class="operator">:</span> <span class="string">''</span><span class="punctuation">}</span></span>
  <span class="punctuation">/></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>These images have some light styling:</p><pre><code><span class="selector">img</span> <span class="punctuation">{</span>
  <span class="property">width</span><span class="punctuation">:</span> 1rem<span class="punctuation">;</span>
  <span class="property">height</span><span class="punctuation">:</span> 1.5rem<span class="punctuation">;</span>
  <span class="property">object-fit</span><span class="punctuation">:</span> cover<span class="punctuation">;</span>
  <span class="property">vertical-align</span><span class="punctuation">:</span> top<span class="punctuation">;</span>
  <span class="property">margin</span><span class="punctuation">:</span> 0 0.25rem 0 0<span class="punctuation">;</span>
  <span class="selector">&amp;.large</span> <span class="punctuation">{</span>
    <span class="property">width</span><span class="punctuation">:</span> 4rem<span class="punctuation">;</span>
    <span class="property">height</span><span class="punctuation">:</span> 6rem<span class="punctuation">;</span>
    <span class="property">margin</span><span class="punctuation">:</span> 0 0.5rem 1rem 0<span class="punctuation">;</span>
    <span class="property">object-fit</span><span class="punctuation">:</span> contain<span class="punctuation">;</span>
    <span class="property">float</span><span class="punctuation">:</span> left<span class="punctuation">;</span>
    <span class="selector">+ ul + *</span> <span class="punctuation">{</span>
      <span class="property">clear</span><span class="punctuation">:</span> both<span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre><p>And finally, this trivial component just wraps the main view of the application to apply a consistent title to the top of each page:</p><pre><code><span class="keyword">const</span> <span class="function-variable">Page</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>title<span class="punctuation">,</span> children<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h1</span><span class="punctuation">></span></span><span class="punctuation">{</span>title<span class="punctuation">}</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h1</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="punctuation">{</span>children<span class="punctuation">}</span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>With these helper components out of the way, let&#x27;s move on to the main parts of the app.</p><h3 id="overview-components">Overview Components</h3><p>We now use the <a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/"><code>ResultSortedTableInHtmlTable</code></a> component and these linker components to create the major views of the application.</p><p>First, the overview of all the rated movies in the database (which displays on the &#x27;Movies&#x27; tab when the app first loads), comprising a <a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/"><code>ResultSortedTableInHtmlTable</code></a> component that renders the <code>movies</code> query with four columns, sorted by rating.</p><pre><code><span class="keyword">const</span> <span class="function-variable">MoviesOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>Rated movies<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movies<span class="punctuation">"</span></span>
      <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForMoviesOverview<span class="punctuation">}</span></span>
      <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
      <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
      <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForMoviesOverview <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">movieName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Movie'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> MovieLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">year</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Year'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> YearLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">rating</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rating'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">genreName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Genre'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> GenreLink<span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Note how three of the columns are given a custom component to render the value not as raw text but as a link. We&#x27;ll describe <a href="#linking-between-views">those simple components</a> later.</p><p>The &#x27;Years&#x27; tab renders the <code>years</code> query with two columns: the year and the number of movies in that year:</p><pre><code><span class="keyword">const</span> <span class="function-variable">YearsOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>Years<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>years<span class="punctuation">"</span></span>
      <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForYearsOverview<span class="punctuation">}</span></span>
      <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>year<span class="punctuation">"</span></span>
      <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
      <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForYearsOverview <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">year</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Year'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> YearLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">movieCount</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rated movies'</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Similarly, the &#x27;Genres&#x27; tab renders the <code>genres</code> query with two columns: the genre and the number of movies in that genre:</p><pre><code><span class="keyword">const</span> <span class="function-variable">GenresOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>Genres<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>genres<span class="punctuation">"</span></span>
      <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForGenresOverview<span class="punctuation">}</span></span>
      <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieCount<span class="punctuation">"</span></span>
      <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
      <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForGenresOverview <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">genreName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Genre'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> GenreLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">movieCount</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rated movies'</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Finally, the &#x27;People&#x27; tab renders two tables: the <code>directors</code> query and the <code>cast</code> query with four columns each, both sorted by popularity:</p><pre><code><span class="keyword">const</span> <span class="function-variable">PeopleOverview</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>People<span class="punctuation">"</span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">Directors</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>directors<span class="punctuation">"</span></span>
      <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForDirectorsOverview<span class="punctuation">}</span></span>
      <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>popularity<span class="punctuation">"</span></span>
      <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
      <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">Cast</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
      <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>cast<span class="punctuation">"</span></span>
      <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForCastOverview<span class="punctuation">}</span></span>
      <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>popularity<span class="punctuation">"</span></span>
      <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
      <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
      <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
    <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForDirectorsOverview <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">directorName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Director'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> DirectorLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">gender</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Gender'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> GenderFromQuery<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">popularity</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Popularity'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">movieCount</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rated movies'</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForCastOverview <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">castName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Cast'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> CastLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">gender</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Gender'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> GenderFromQuery<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">popularity</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Popularity'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">movieCount</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rated movies'</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Click through each of the section headings in the app so you can see how each of these is working.</p><h3 id="detail-components">Detail Components</h3><p>We also have a detail view for each section, which drills into a specific movie, year, genre, or person. Firstly, for a single movie (assuming it exists!), we isolate a row in the de-normalized <code>movies</code> query and render its <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> values in a page format:</p><pre><code><span class="keyword">const</span> <span class="function-variable">MovieDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>movieId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> props <span class="operator">=</span> <span class="punctuation">{</span><span class="literal-property">queryId</span><span class="operator">:</span> <span class="string">'movies'</span><span class="punctuation">,</span> <span class="literal-property">rowId</span><span class="operator">:</span> movieId<span class="punctuation">}</span><span class="punctuation">;</span>
  <span class="keyword">const</span> name <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultcell/">useResultCell</a></span><span class="punctuation">(</span><span class="string">'movies'</span><span class="punctuation">,</span> movieId<span class="punctuation">,</span> <span class="string">'movieName'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> name <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>name<span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromQuery</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>movieImage<span class="punctuation">"</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Year: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">YearLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Genre: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenreLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Rating: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview/">ResultCellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>p</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/queries-components/resultcellview/">ResultCellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>overview<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>p</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">Credits</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">DirectorLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">, director
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">CastLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">billing</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">1</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">CastLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">billing</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">2</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">CastLink</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">billing</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">3</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Again, note how we are often using custom components that take the <a href="/api/store/type-aliases/store/cell/"><code>Cell</code></a> values from this result <a href="/api/store/type-aliases/store/row/"><code>Row</code></a> to make links to other parts of the app. We&#x27;ll describe those shortly.</p><p>Moving on, the detail for a specific year is just a sorted table of the movies from that year.</p><p>Here is a case where we can use a parameterized query, introduced in TinyBase v7.2. The <code>yearGenreMovies</code> query was set up once in the app initialization, so we use the <a href="/api/ui-react/functions/queries-hooks/usesetparamvaluescallback/"><code>useSetParamValuesCallback</code></a> hook to update its params whenever the <code>year</code> prop changes. This is more efficient and ergonomic than rebuilding the query definition every time.</p><pre><code><span class="keyword">const</span> <span class="function-variable">YearDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>year<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">useSetYearGenre</span><span class="punctuation">(</span><span class="punctuation">{</span>year<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">Movies from </span><span class="interpolation"><span class="interpolation-punctuation">${</span>year<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
        <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>yearGenreMovies<span class="punctuation">"</span></span>
        <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForMoviesInYear<span class="punctuation">}</span></span>
        <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
        <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
        <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
        <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
        <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
        <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForMoviesInYear <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">movieName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Movie'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> MovieLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">rating</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rating'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">genreName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Genre'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> GenreLink<span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>The genre detail page is very similar, using the same parameterized query but setting the <code>genreId</code> param instead:</p><pre><code><span class="keyword">const</span> <span class="function-variable">GenreDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>genreId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">useSetYearGenre</span><span class="punctuation">(</span><span class="punctuation">{</span>genreId<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> name <span class="operator">=</span> <span class="function"><a href="/api/the-essentials/using-react/usecell/">useCell</a></span><span class="punctuation">(</span><span class="string">'genres'</span><span class="punctuation">,</span> genreId<span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> name <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="template-string"><span class="template-punctuation">`</span><span class="interpolation"><span class="interpolation-punctuation">${</span>name<span class="interpolation-punctuation">}</span></span><span class="string"> movies</span><span class="template-punctuation">`</span></span><span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
        <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>yearGenreMovies<span class="punctuation">"</span></span>
        <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForMoviesInGenre<span class="punctuation">}</span></span>
        <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
        <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
        <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
        <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
        <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
        <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
      <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForMoviesInGenre <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">movieName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Movie'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> MovieLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">year</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Year'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> YearLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">rating</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rating'</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><p>Finally, we build the detail page for a person. Again, we use parameterized queries to get the movies they have directed and the movies in which they have appeared without having to re-define the whole query each time.</p><p>This component is slightly more complex than the others because it is also rendering some parts of its content directly from the <code>people</code> <a href="/api/store/type-aliases/store/table/"><code>Table</code></a> (rather than via a query) - hence the use of the basic <code>useCell</code> hook and <code>CellView</code> component, for example.</p><pre><code><span class="keyword">const</span> <span class="function-variable">PersonDetail</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>personId<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="function">useSetPersonMovies</span><span class="punctuation">(</span>personId<span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">const</span> props <span class="operator">=</span> <span class="punctuation">{</span><span class="literal-property">tableId</span><span class="operator">:</span> <span class="string">'people'</span><span class="punctuation">,</span> <span class="literal-property">rowId</span><span class="operator">:</span> personId<span class="punctuation">}</span><span class="punctuation">;</span>
  <span class="keyword">const</span> name <span class="operator">=</span> <span class="function"><a href="/api/the-essentials/using-react/usecell/">useCell</a></span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">,</span> <span class="string">'name'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> died <span class="operator">=</span> <span class="function"><a href="/api/the-essentials/using-react/usecell/">useCell</a></span><span class="punctuation">(</span><span class="string">'people'</span><span class="punctuation">,</span> personId<span class="punctuation">,</span> <span class="string">'died'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> directedMovies <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultrowids/">useResultRowIds</a></span><span class="punctuation">(</span><span class="string">'directedMovies'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> appearedMovies <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/queries-hooks/useresultrowids/">useResultRowIds</a></span><span class="punctuation">(</span><span class="string">'appearedMovies'</span><span class="punctuation">)</span><span class="punctuation">;</span>

  <span class="keyword">return</span> name <span class="operator">==</span> <span class="keyword">null</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
    <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">Page</span></span> <span class="attr-name">title</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>name<span class="punctuation">}</span></span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ImageFromTable</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>image<span class="punctuation">"</span></span> <span class="attr-name">isLarge</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Gender: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">GenderFromTable</span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Born: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview/">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>born<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
          </span><span class="punctuation">{</span>died <span class="operator">&amp;&amp;</span> <span class="punctuation">(</span>
            <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
              ; died: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview/">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>died<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
            </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
          <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>li</span><span class="punctuation">></span></span><span class="plain-text">
          Popularity: </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview/">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>popularity<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>li</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>ul</span><span class="punctuation">></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>p</span><span class="punctuation">></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/store-components/cellview/">CellView</a></span></span> <span class="spread"><span class="punctuation">{</span><span class="operator">...</span>props<span class="punctuation">}</span></span> <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>biography<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="plain-text">
      </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>p</span><span class="punctuation">></span></span><span class="plain-text">

      </span><span class="punctuation">{</span>directedMovies<span class="punctuation">.</span>length <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
        <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">As director:</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
            <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>directedMovies<span class="punctuation">"</span></span>
            <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForMoviesWithPeople<span class="punctuation">}</span></span>
            <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
            <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
            <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
            <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
            <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
            <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
          <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
      <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">

      </span><span class="punctuation">{</span>appearedMovies<span class="punctuation">.</span>length <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> <span class="keyword">null</span> <span class="operator">:</span> <span class="punctuation">(</span>
        <span class="tag"><span class="tag"><span class="punctuation">&lt;</span></span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span>h2</span><span class="punctuation">></span></span><span class="plain-text">As cast:</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>h2</span><span class="punctuation">></span></span><span class="plain-text">
          </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react-dom/functions/queries-components/resultsortedtableinhtmltable/">ResultSortedTableInHtmlTable</a></span></span>
            <span class="attr-name">queryId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>appearedMovies<span class="punctuation">"</span></span>
            <span class="attr-name">customCells</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span>customCellsForMoviesWithPeople<span class="punctuation">}</span></span>
            <span class="attr-name">cellId</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>rating<span class="punctuation">"</span></span>
            <span class="attr-name">descending</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
            <span class="attr-name">limit</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="number">20</span><span class="punctuation">}</span></span>
            <span class="attr-name">sortOnClick</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
            <span class="attr-name">paginator</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">true</span><span class="punctuation">}</span></span>
            <span class="attr-name">idColumn</span><span class="script"><span class="script-punctuation">=</span><span class="punctuation">{</span><span class="boolean">false</span><span class="punctuation">}</span></span>
          <span class="punctuation">/></span></span><span class="plain-text">
        </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span></span><span class="punctuation">></span></span>
      <span class="punctuation">)</span><span class="punctuation">}</span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name">Page</span></span><span class="punctuation">></span></span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> customCellsForMoviesWithPeople <span class="operator">=</span> <span class="punctuation">{</span>
  <span class="literal-property">movieName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Movie'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> MovieLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">year</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Year'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> YearLink<span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">rating</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Rating'</span><span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="literal-property">genreName</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">label</span><span class="operator">:</span> <span class="string">'Genre'</span><span class="punctuation">,</span> <span class="literal-property">component</span><span class="operator">:</span> GenreLink<span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre><h3 id="default-styling">Default Styling</h3><p>Just for completeness, here is the default CSS styling and typography that the app uses:</p><pre><code><span class="atrule">@font-face</span> <span class="punctuation">{</span>
  <span class="property">font-family</span><span class="punctuation">:</span> Inter<span class="punctuation">;</span>
  <span class="property">src</span><span class="punctuation">:</span> <span class="url"><span class="function">url</span><span class="punctuation">(</span>https://tinybase.org/fonts/inter.woff2<span class="punctuation">)</span></span> <span class="function">format</span><span class="punctuation">(</span><span class="string">'woff2'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">*</span> <span class="punctuation">{</span>
  <span class="property">box-sizing</span><span class="punctuation">:</span> border<span class="operator">-</span>box<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">body</span> <span class="punctuation">{</span>
  <span class="property">user-select</span><span class="punctuation">:</span> none<span class="punctuation">;</span>
  <span class="property">font-family</span><span class="punctuation">:</span> Inter<span class="punctuation">,</span> sans<span class="operator">-</span>serif<span class="punctuation">;</span>
  <span class="property">letter-spacing</span><span class="punctuation">:</span> <span class="operator">-</span>0.04rem<span class="punctuation">;</span>
  <span class="property">font-size</span><span class="punctuation">:</span> 0.8rem<span class="punctuation">;</span>
  <span class="property">line-height</span><span class="punctuation">:</span> 1.5rem<span class="punctuation">;</span>
  <span class="property">margin</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
  <span class="property">color</span><span class="punctuation">:</span> #333<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">h1</span> <span class="punctuation">{</span>
  <span class="property">margin</span><span class="punctuation">:</span> 0 0 1rem<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">h2</span> <span class="punctuation">{</span>
  <span class="property">margin</span><span class="punctuation">:</span> 1.5rem 0 0.5rem<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">ul</span> <span class="punctuation">{</span>
  <span class="property">padding-left</span><span class="punctuation">:</span> 0<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">li</span> <span class="punctuation">{</span>
  <span class="property">display</span><span class="punctuation">:</span> block<span class="punctuation">;</span>
  <span class="property">padding-bottom</span><span class="punctuation">:</span> 0.25rem<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="selector">a</span> <span class="punctuation">{</span>
  <span class="property">white-space</span><span class="punctuation">:</span> nowrap<span class="punctuation">;</span>
  <span class="property">text-overflow</span><span class="punctuation">:</span> ellipsis<span class="punctuation">;</span>
  <span class="property">overflow</span><span class="punctuation">:</span> hidden<span class="punctuation">;</span>
  <span class="property">cursor</span><span class="punctuation">:</span> pointer<span class="punctuation">;</span>
  <span class="property">max-width</span><span class="punctuation">:</span> 100%<span class="punctuation">;</span>
  <span class="property">display</span><span class="punctuation">:</span> inline<span class="operator">-</span>block<span class="punctuation">;</span>
  <span class="property">vertical-align</span><span class="punctuation">:</span> top<span class="punctuation">;</span>
  <span class="property">color</span><span class="punctuation">:</span> #000<span class="punctuation">;</span>
  <span class="selector">&amp;:hover</span> <span class="punctuation">{</span>
    <span class="property">text-decoration</span><span class="punctuation">:</span> underline<span class="punctuation">;</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>

<span class="selector">p</span> <span class="punctuation">{</span>
  <span class="property">line-height</span><span class="punctuation">:</span> 1.2rem<span class="punctuation">;</span>
<span class="punctuation">}</span>
</code></pre><h3 id="conclusion">Conclusion</h3><p>And that&#x27;s it! There is quite a lot going on here, but this is arguably a complete and legitimate application that pulls in a decent amount of normalized relational data and renders it in a useful and navigable fashion.</p><p>One thing that might be easy to forget (because the movie data does not change) is that every single view rendered in this application is reactive! Were any aspect of the data dynamic, it would be automatically updated in the user interface. It&#x27;s left as an exercise to the reader to explore how this might work, perhaps with movie favorite lists, or pulling dynamic data directly from TMDB.</p><p>In the meantime, as they say in the movies, that&#x27;s a wrap!</p></section></article><aside></aside></main><footer><nav><a id="gh" href="https://github.com/tinyplex/tinybase" target="_blank">GitHub</a><a id="bs" href="https://bsky.app/profile/tinybase.bsky.social" target="_blank">Bluesky</a><a id="tw" href="https://x.com/tinybasejs" target="_blank">X / Twitter</a><a id="dc" href="https://discord.com/invite/mGz3mevwP8" target="_blank">Discord</a></nav><nav><a href="/">TinyBase <span id="version"></span></a> © 2022-</nav></footer><script>window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments);}g('js',new Date());g('config','G-D1MGR8VRWJ');</script></body></html>