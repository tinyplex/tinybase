<html><head><link rel="preload" as="font" href="/fonts/lato-light.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/lato-regular.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-thin.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-light.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-mono-light.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-mono-regular.woff2" type="font/woff2" crossorigin="anonymous"><title>Persister | TinyBase</title><meta property="og:type" content="website"><meta property="og:title" content="Persister | TinyBase"><meta property="og:description"><meta property="og:url" content="https://tinybase.org/api/persisters/interfaces/persister/persister"><meta property="og:image" content="https://tinybase.org/favicon_pad.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Persister | TinyBase"><meta name="twitter:description"><meta name="twitter:site" content="@tinybasejs"><meta name="twitter:image" content="https://tinybase.org/favicon_pad.png"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="/css/index.css"><script src="/js/app.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ"></script><script>window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments);}g('js',new Date());g('config','G-D1MGR8VRWJ');</script></head><body><header><a href="/"><img src="/favicon.svg"><span>TinyBase <em title="2.0.0-beta.3">beta</em></span></a><nav><ul><li><a href="/guides">Guides</a></li><li><a href="/demos">Demos</a></li><li><a href="/api">API</a></li><li><a href="https://github.com/tinyplex/tinybase">GitHub</a></li></ul></nav><span id="dark"></span></header><main><nav><ul><li id="root" class="parent open"><span></span><a href="/">TinyBase</a><ul><li id="G" class="parent"><span></span><a href="/guides">Guides</a></li><li id="D2" class="parent"><span></span><a href="/demos">Demos</a></li><li id="api" class="parent open"><span></span><a href="/api">API</a><ul><li id="s" class="parent"><span></span><a href="/api/store"><code>store</code></a></li><li id="m" class="parent"><span></span><a href="/api/metrics"><code>metrics</code></a></li><li id="i" class="parent"><span></span><a href="/api/indexes"><code>indexes</code></a></li><li id="r" class="parent"><span></span><a href="/api/relationships"><code>relationships</code></a></li><li id="q" class="parent"><span></span><a href="/api/queries"><code>queries</code></a></li><li id="c" class="parent"><span></span><a href="/api/checkpoints"><code>checkpoints</code></a></li><li id="p" class="parent open"><span></span><a href="/api/persisters"><code>persisters</code></a><ul><li id="p/I17" class="parent open"><span></span><a href="/api/persisters/interfaces">Interfaces</a><ul><li id="P2" class="current parent open"><span></span><a href="/api/persisters/interfaces/persister/persister"><code>Persister</code></a><ul><li id="P2/M12/G9" class="parent"><span></span><a href="/api/persisters/interfaces/persister/persister/methods/getter">Getter methods</a></li><li id="P2/M12/L18" class="parent"><span></span><a href="/api/persisters/interfaces/persister/persister/methods/lifecycle">Lifecycle methods</a></li><li id="P2/M12/L19" class="parent"><span></span><a href="/api/persisters/interfaces/persister/persister/methods/load">Load methods</a></li><li id="P2/M12/S10" class="parent"><span></span><a href="/api/persisters/interfaces/persister/persister/methods/save">Save methods</a></li><li id="P2/M12/D17" class="parent"><span></span><a href="/api/persisters/interfaces/persister/persister/methods/development">Development methods</a></li></ul></li></ul></li><li id="p/F7" class="parent"><span></span><a href="/api/persisters/functions">Functions</a></li><li id="p/TA13" class="parent"><span></span><a href="/api/persisters/type-aliases">Type Aliases</a></li></ul></li><li id="u" class="parent"><span></span><a href="/api/ui-react"><code>ui-react</code></a></li><li id="c3" class="parent"><span></span><a href="/api/common"><code>common</code></a></li></ul></li></ul></li></ul></nav><article><nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api">API</a></li><li><a href="/api/persisters"><code>persisters</code></a></li><li><a href="/api/persisters/interfaces">Interfaces</a></li></ul></nav><section class="s1" id="/api/persisters/interfaces/persister/persister" data-id="P2"><h1><code>Persister</code></h1><p>A <code>Persister</code> object lets you save and load <a href="/api/store/interfaces/store/store"><code>Store</code></a> data to and from different locations, or underlying storage types.</p><p>This is useful for preserving <a href="/api/store/interfaces/store/store"><code>Store</code></a> data between browser sessions or reloads, saving or loading browser state to or from a server, or saving <a href="/api/store/interfaces/store/store"><code>Store</code></a> data to disk in a environment with filesystem access.</p><p>Creating a <code>Persister</code> depends on the choice of underlying storage where the data is to be stored. Options include the <a href="/api/persisters/functions/creation/createsessionpersister"><code>createSessionPersister</code></a> function, the createLocalPersister, the <a href="/api/persisters/functions/creation/createremotepersister"><code>createRemotePersister</code></a> function, and the <a href="/api/persisters/functions/creation/createfilepersister"><code>createFilePersister</code></a> function. The <a href="/api/persisters/functions/creation/createcustompersister"><code>createCustomPersister</code></a> function can also be used to easily create a fully customized way to save and load <a href="/api/store/interfaces/store/store"><code>Store</code></a> data.</p><p>A <code>Persister</code> lets you explicit save or load data, with the <a href="/api/persisters/interfaces/persister/persister/methods/save/save"><code>save</code></a> method and the <a href="/api/persisters/interfaces/persister/persister/methods/load/load"><code>load</code></a> method respectively. These methods are both asynchronous (since the underlying data storage may also be) and return promises. As a result you should use the <code>await</code> keyword to call them in a way that guarantees subsequent execution order.</p><p>When you don&#x27;t want to deal with explicit persistence operations, a <code>Persister</code> object also provides automatic saving and loading. Automatic saving listens for changes to the <a href="/api/store/interfaces/store/store"><code>Store</code></a> and persists the data immediately. Automatic loading listens (or polls) for changes to the persisted data and reflects those changes in the <a href="/api/store/interfaces/store/store"><code>Store</code></a>.</p><p>You can start automatic saving or loading with the <a href="/api/persisters/interfaces/persister/persister/methods/save/startautosave"><code>startAutoSave</code></a> method and <a href="/api/persisters/interfaces/persister/persister/methods/load/startautoload"><code>startAutoLoad</code></a> method. Both are asynchronous since they will do an immediate save and load before starting to listen for subsequent changes. You can stop the behavior with the <a href="/api/persisters/interfaces/persister/persister/methods/save/stopautosave"><code>stopAutoSave</code></a> method and <a href="/api/persisters/interfaces/persister/persister/methods/load/stopautoload"><code>stopAutoLoad</code></a> method (which are synchronous).</p><p>You may often want to have both automatic saving and loading of a <a href="/api/store/interfaces/store/store"><code>Store</code></a> so that changes are constantly synchronized (allowing basic state preservation between browser tabs, for example). The framework has some basic provisions to prevent race conditions - for example it will not attempt to save data if it is currently loading it and vice-versa.</p><p>Be aware, however, that the default implementations do not provide complex synchronization heuristics and you should comprehensively test your persistence strategy to understand the opportunity for data loss (in the case of trying to save data to a server under poor network conditions, for example).</p><section class="s2"><h2>Examples</h2><p>This example creates a <a href="/api/store/interfaces/store/store"><code>Store</code></a>, persists it to the browser&#x27;s session storage as a JSON string, changes the persisted data, updates the <a href="/api/store/interfaces/store/store"><code>Store</code></a> from it, and finally destroys the <code>Persister</code> again.</p><pre><code><span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settables">setTables</a></span><span class="punctuation">(</span><span class="punctuation">{</span><span class="literal-property">pets</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">fido</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> persister <span class="operator">=</span> <span class="function"><a href="/api/persisters/functions/creation/createsessionpersister">createSessionPersister</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> <span class="string">'pets'</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">await</span> persister<span class="punctuation">.</span><span class="function"><a href="/api/persisters/interfaces/persister/persister/methods/save/save">save</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>sessionStorage<span class="punctuation">.</span><span class="function">getItem</span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> '{"pets":{"fido":{"species":"dog"}}}'</span>

sessionStorage<span class="punctuation">.</span><span class="function">setItem</span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'{"pets":{"toto":{"species":"dog"}}}'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">await</span> persister<span class="punctuation">.</span><span class="function"><a href="/api/persisters/interfaces/persister/persister/methods/load/load">load</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/getter/gettables">getTables</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> {pets: {toto: {species: 'dog'}}}</span>

persister<span class="punctuation">.</span><span class="function">destroy</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
sessionStorage<span class="punctuation">.</span><span class="function"><a href="/api/checkpoints/interfaces/checkpoints/checkpoints/methods/lifecycle/clear">clear</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>This example creates a <a href="/api/store/interfaces/store/store"><code>Store</code></a>, and automatically saves and loads it to the browser&#x27;s session storage as a JSON string. Changes to the <a href="/api/store/interfaces/store/store"><code>Store</code></a> data, or the persisted data (implicitly firing a StorageEvent), are reflected accordingly.</p><pre><code><span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> persister <span class="operator">=</span> <span class="function"><a href="/api/persisters/functions/creation/createsessionpersister">createSessionPersister</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> <span class="string">'pets'</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">await</span> persister<span class="punctuation">.</span><span class="function"><a href="/api/persisters/interfaces/persister/persister/methods/load/startautoload">startAutoLoad</a></span><span class="punctuation">(</span><span class="punctuation">{</span><span class="literal-property">pets</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">fido</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">await</span> persister<span class="punctuation">.</span><span class="function"><a href="/api/persisters/interfaces/persister/persister/methods/save/startautosave">startAutoSave</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settables">setTables</a></span><span class="punctuation">(</span><span class="punctuation">{</span><span class="literal-property">pets</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">felix</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'cat'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// ...</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>sessionStorage<span class="punctuation">.</span><span class="function">getItem</span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> '{"pets":{"felix":{"species":"cat"}}}'</span>

<span class="comment">// In another browser tab:</span>
sessionStorage<span class="punctuation">.</span><span class="function">setItem</span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'{"pets":{"toto":{"species":"dog"}}}'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> StorageEvent('storage', {storageArea: sessionStorage, key: 'pets'})</span>

<span class="comment">// ...</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/getter/gettables">getTables</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> {pets: {toto: {species: 'dog'}}}</span>

persister<span class="punctuation">.</span><span class="function">destroy</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
sessionStorage<span class="punctuation">.</span><span class="function"><a href="/api/checkpoints/interfaces/checkpoints/checkpoints/methods/lifecycle/clear">clear</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre></section><section class="s2" id="/api/persisters/interfaces/persister/persister/methods/getter" data-id="P2/M12/G9"><h2><a href="/api/persisters/interfaces/persister/persister/methods/getter">Getter methods</a></h2><p>This is the collection of getter methods within the <a href="/api/persisters/interfaces/persister/persister"><code>Persister</code></a> interface. There is only one method, <a href="/api/persisters/interfaces/persister/persister/methods/getter/getstore"><code>getStore</code></a>.</p><ul><li><a href="/api/persisters/interfaces/persister/persister/methods/getter/getstore"><code>getStore</code></a></li></ul></section><section class="s2" id="/api/persisters/interfaces/persister/persister/methods/lifecycle" data-id="P2/M12/L18"><h2><a href="/api/persisters/interfaces/persister/persister/methods/lifecycle">Lifecycle methods</a></h2><p>This is the collection of lifecycle methods within the <a href="/api/persisters/interfaces/persister/persister"><code>Persister</code></a> interface. There is only one method, <a href="/api/persisters/interfaces/persister/persister/methods/lifecycle/destroy"><code>destroy</code></a>.</p><ul><li><a href="/api/persisters/interfaces/persister/persister/methods/lifecycle/destroy"><code>destroy</code></a></li></ul></section><section class="s2" id="/api/persisters/interfaces/persister/persister/methods/load" data-id="P2/M12/L19"><h2><a href="/api/persisters/interfaces/persister/persister/methods/load">Load methods</a></h2><p>This is the collection of load methods within the <a href="/api/persisters/interfaces/persister/persister"><code>Persister</code></a> interface. There are only three load methods, <a href="/api/persisters/interfaces/persister/persister/methods/load/load"><code>load</code></a>, <a href="/api/persisters/interfaces/persister/persister/methods/load/startautoload"><code>startAutoLoad</code></a>, and <a href="/api/persisters/interfaces/persister/persister/methods/load/stopautoload"><code>stopAutoLoad</code></a>.</p><ul><li><a href="/api/persisters/interfaces/persister/persister/methods/load/load"><code>load</code></a></li><li><a href="/api/persisters/interfaces/persister/persister/methods/load/startautoload"><code>startAutoLoad</code></a></li><li><a href="/api/persisters/interfaces/persister/persister/methods/load/stopautoload"><code>stopAutoLoad</code></a></li></ul></section><section class="s2" id="/api/persisters/interfaces/persister/persister/methods/save" data-id="P2/M12/S10"><h2><a href="/api/persisters/interfaces/persister/persister/methods/save">Save methods</a></h2><p>This is the collection of save methods within the <a href="/api/persisters/interfaces/persister/persister"><code>Persister</code></a> interface. There are only three save methods, <a href="/api/persisters/interfaces/persister/persister/methods/save/save"><code>save</code></a>, <a href="/api/persisters/interfaces/persister/persister/methods/save/startautosave"><code>startAutoSave</code></a>, and <a href="/api/persisters/interfaces/persister/persister/methods/save/stopautosave"><code>stopAutoSave</code></a>.</p><ul><li><a href="/api/persisters/interfaces/persister/persister/methods/save/save"><code>save</code></a></li><li><a href="/api/persisters/interfaces/persister/persister/methods/save/startautosave"><code>startAutoSave</code></a></li><li><a href="/api/persisters/interfaces/persister/persister/methods/save/stopautosave"><code>stopAutoSave</code></a></li></ul></section><section class="s2" id="/api/persisters/interfaces/persister/persister/methods/development" data-id="P2/M12/D17"><h2><a href="/api/persisters/interfaces/persister/persister/methods/development">Development methods</a></h2><p>This is the collection of development methods within the <a href="/api/persisters/interfaces/persister/persister"><code>Persister</code></a> interface. There is only one method, <a href="/api/persisters/interfaces/persister/persister/methods/development/getstats"><code>getStats</code></a>.</p><ul><li><a href="/api/persisters/interfaces/persister/persister/methods/development/getstats"><code>getStats</code></a></li></ul></section></section></article><aside></aside></main><footer><nav><a id="tw" href="https://twitter.com/tinybasejs" target="_blank"></a><a id="fb" href="https://facebook.com/tinybasejs" target="_blank"></a></nav><nav><a href="/">TinyBase 2.0.0-beta.3</a> © 2021- All Rights Reserved</nav></footer></body></html>