<nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api/">API</a></li><li><a href="/api/persisters/"><code>persisters</code></a></li><li><a href="/api/persisters/functions/">Functions</a></li><li><a href="/api/persisters/functions/creation/createcustompostgresqlpersister/"><code>createCustomPostgreSqlPersister</code></a></li></ul></nav><section class="s1" id="/api/persisters/functions/creation/createcustompostgresqlpersister/" data-id="cCPSP"><h1><code>createCustomPostgreSqlPersister</code></h1><p>The <code>createCustomPostgreSqlPersister</code> function creates a <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a> object that you can configure to persist the <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> to a PostgreSQL database.</p><pre><code><span class="generic-function"><span class="function"><a href="/api/persisters/functions/creation/createcustompostgresqlpersister/">createCustomPostgreSqlPersister</a></span><span class="generic"><span class="operator">&lt;</span>ListenerHandle<span class="punctuation">,</span> Persist<span class="operator">></span></span></span><span class="punctuation">(</span>
  store<span class="operator">:</span> <span class="type"><a href="/api/persisters/type-aliases/mergeable/persistedstore/">PersistedStore</a></span><span class="operator">&lt;</span>Persist<span class="operator">></span><span class="punctuation">,</span>
  configOrStoreTableName<span class="operator">:</span> <span class="keyword">undefined</span> <span class="operator">|</span> <span class="builtin">string</span> <span class="operator">|</span> <span class="type"><a href="/api/persisters/type-aliases/configuration/databasepersisterconfig/">DatabasePersisterConfig</a></span><span class="punctuation">,</span>
  executeCommand<span class="operator">:</span> <span class="type"><a href="/api/persisters/type-aliases/creation/databaseexecutecommand/">DatabaseExecuteCommand</a></span><span class="punctuation">,</span>
  <span class="function-variable">addChangeListener</span><span class="operator">:</span> <span class="punctuation">(</span>channel<span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">,</span> listener<span class="operator">:</span> <span class="type"><a href="/api/persisters/type-aliases/creation/databasechangelistener/">DatabaseChangeListener</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">Promise</span><span class="operator">&lt;</span>ListenerHandle<span class="operator">></span><span class="punctuation">,</span>
  <span class="function-variable">delChangeListener</span><span class="operator">:</span> <span class="punctuation">(</span>listenerHandle<span class="operator">:</span> ListenerHandle<span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span> <span class="operator">|</span> <span class="builtin">Promise</span><span class="operator">&lt;</span><span class="keyword">void</span><span class="operator">></span><span class="punctuation">,</span>
  onSqlCommand<span class="operator">:</span> <span class="keyword">undefined</span> <span class="operator">|</span> <span class="punctuation">(</span>sql<span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">,</span> params<span class="operator">?</span><span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span><span class="punctuation">,</span>
  onIgnoredError<span class="operator">:</span> <span class="keyword">undefined</span> <span class="operator">|</span> <span class="punctuation">(</span>error<span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span><span class="punctuation">,</span>
  <span class="function-variable">destroy</span><span class="operator">:</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span><span class="punctuation">,</span>
  persist<span class="operator">:</span> Persist<span class="punctuation">,</span>
  thing<span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">,</span>
  getThing<span class="operator">?</span><span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">,</span>
<span class="punctuation">)</span><span class="operator">:</span> <span class="type"><a href="/api/the-essentials/persisting-stores/persister/">Persister</a></span><span class="operator">&lt;</span>Persist<span class="operator">></span></code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code>store</code></th><td><code><span class="type"><a href="/api/persisters/type-aliases/mergeable/persistedstore/">PersistedStore</a></span><span class="operator">&lt;</span>Persist<span class="operator">></span></code></td><td><p>The <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> to persist.</p></td></tr><tr><th><code>configOrStoreTableName</code></th><td><code><span class="keyword">undefined</span> <span class="operator">|</span> <span class="builtin">string</span> <span class="operator">|</span> <span class="type"><a href="/api/persisters/type-aliases/configuration/databasepersisterconfig/">DatabasePersisterConfig</a></span></code></td><td><p>A <a href="/api/persisters/type-aliases/configuration/databasepersisterconfig/"><code>DatabasePersisterConfig</code></a> object, or a string that will be used as the name of the <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a>&#x27;s table in the database.</p></td></tr><tr><th><code>executeCommand</code></th><td><code><span class="type"><a href="/api/persisters/type-aliases/creation/databaseexecutecommand/">DatabaseExecuteCommand</a></span></code></td><td><p>A function that will execute a command against the database.</p></td></tr><tr><th><code>addChangeListener</code></th><td><code><span class="punctuation">(</span>channel<span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">,</span> listener<span class="operator">:</span> <span class="type"><a href="/api/persisters/type-aliases/creation/databasechangelistener/">DatabaseChangeListener</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">Promise</span><span class="operator">&lt;</span>ListenerHandle<span class="operator">></span></code></td><td><p>An asynchronous function that will register a listener for changes to the database.</p></td></tr><tr><th><code>delChangeListener</code></th><td><code><span class="punctuation">(</span>listenerHandle<span class="operator">:</span> ListenerHandle<span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span> <span class="operator">|</span> <span class="builtin">Promise</span><span class="operator">&lt;</span><span class="keyword">void</span><span class="operator">></span></code></td><td><p>An asynchronous function that will unregister the listener for changes to the database.</p></td></tr><tr><th><code>onSqlCommand</code></th><td><code><span class="keyword">undefined</span> <span class="operator">|</span> <span class="punctuation">(</span>sql<span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">,</span> params<span class="operator">?</span><span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span></code></td><td><p>A function that will be called for each SQL command executed against the database.</p></td></tr><tr><th><code>onIgnoredError</code></th><td><code><span class="keyword">undefined</span> <span class="operator">|</span> <span class="punctuation">(</span>error<span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span></code></td><td><p>An optional handler for the errors that the <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a> would otherwise ignore when trying to save or load data. This is suitable for debugging persistence issues in a development environment.</p></td></tr><tr><th><code>destroy</code></th><td><code><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span></code></td><td><p>A function that will be called to perform any extra clean up on the <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a>.</p></td></tr><tr><th><code>persist</code></th><td><code>Persist</code></td><td><p>An integer from the <a href="/api/persisters/enumerations/mergeable/persists/"><code>Persists</code></a> enum to indicate which types of <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> are supported by this <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a>: <code>1</code> indicates only a regular <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> is supported, <code>2</code> indicates only a <a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/"><code>MergeableStore</code></a> is supported, and <code>3</code> indicates that both <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a> and <a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/"><code>MergeableStore</code></a> are supported.</p></td></tr><tr><th><code>thing</code></th><td><code><span class="builtin">any</span></code></td><td><p>A reference to the database or connection that can be returned with a method, by default called <code>getDb</code>.</p></td></tr><tr><th><code>getThing<span class="operator">?</span></code></th><td><code><span class="builtin">string</span></code></td><td><p>An optional string that will be used to get the reference to the database or connection from the <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a>, defaulting to <code>getDb</code>.</p></td></tr><tr><th class="right">returns</th><td><code><span class="type"><a href="/api/the-essentials/persisting-stores/persister/">Persister</a></span><span class="operator">&lt;</span>Persist<span class="operator">></span></code></td><td><p></p><p>A reference to the new <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a> object.</p><p></p></td></tr></table></div><p>This is only used when developing custom database-oriented Persisters, and most TinyBase users will not need to be particularly aware of it.</p><p>All of the TinyBase PostgreSQL-oriented <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a> functions use this function under the covers, and so you may wish to look at those implementations for ideas on how to build your own <a href="/api/the-essentials/persisting-stores/persister/"><code>Persister</code></a> type, and as functional examples. Examine the implementation of the <a href="/api/persister-postgres/functions/creation/createpostgrespersister/"><code>createPostgresPersister</code></a> function as a good starting point, for example.</p><section class="s2"><h2>Since</h2><p>v5.2.0</p></section></section>