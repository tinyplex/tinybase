<nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api/">API</a></li><li><a href="/api/persister-automerge/"><code>persister-automerge</code></a></li><li><a href="/api/persister-automerge/interfaces/">Interfaces</a></li><li><a href="/api/persister-automerge/interfaces/persister/automergepersister/"><code>AutomergePersister</code></a></li><li><a href="/api/persister-automerge/interfaces/persister/automergepersister/methods/lifecycle/">Lifecycle methods</a></li><li><a href="/api/persister-automerge/interfaces/persister/automergepersister/methods/lifecycle/schedule/"><code>schedule</code></a></li></ul></nav><section class="s1" id="/api/persister-automerge/interfaces/persister/automergepersister/methods/lifecycle/schedule/" data-id="s4"><h1><code>schedule</code></h1><p>The <code>schedule</code> method allows you to queue up a series of asynchronous actions that must run in sequence during persistence.</p><pre><code><span class="function"><a href="/api/persister-automerge/interfaces/persister/automergepersister/methods/lifecycle/schedule/">schedule</a></span><span class="punctuation">(</span>actions<span class="operator">:</span> <span class="builtin">Promise</span><span class="operator">&lt;</span><span class="builtin">any</span><span class="operator">></span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">:</span> <span class="builtin">Promise</span><span class="operator">&lt;</span><span class="type"><a href="/api/persister-automerge/interfaces/persister/automergepersister/">AutomergePersister</a></span><span class="operator">></span></code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code>actions</code></th><td><code><span class="builtin">Promise</span><span class="operator">&lt;</span><span class="builtin">any</span><span class="operator">></span><span class="punctuation">[</span><span class="punctuation">]</span></code></td><td></td></tr><tr><th class="right">returns</th><td><code><span class="builtin">Promise</span><span class="operator">&lt;</span><span class="type"><a href="/api/persister-automerge/interfaces/persister/automergepersister/">AutomergePersister</a></span><span class="operator">></span></code></td><td><p></p><p>A reference to the <a href="/api/persisters/interfaces/persister/persister/"><code>Persister</code></a> object.</p><p></p></td></tr></table></div><p>For example, a database <a href="/api/persisters/interfaces/persister/persister/"><code>Persister</code></a> may need to ensure that multiple asynchronous tasks to check and update the database schema are completed before data is written to it. Therefore it&#x27;s most likely you will be using this method inside your <code>setPersisted</code> implementation.</p><p>Call this method to add a single asynchronous action, or a sequence of them in one call. This will also start to run the first task in the queue (which once complete will then run the next, and so on), and so this method itself is also asynchronous and returns a promise of the <a href="/api/persisters/interfaces/persister/persister/"><code>Persister</code></a>.</p><section class="s2"><h2>Example</h2><p>This example creates a custom <a href="/api/persisters/interfaces/persister/persister/"><code>Persister</code></a> object against a newly-created <a href="/api/store/interfaces/store/store/"><code>Store</code></a> and then sequences two tasks in order to update its data on a hypothetical remote system.</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>
  checkRemoteSystemIsReady<span class="punctuation">,</span>
  getDataFromRemoteSystem<span class="punctuation">,</span>
  sendDataToRemoteSystem<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'custom-remote-handlers'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createCustomPersister<span class="punctuation">,</span> createStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>

<span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> persister <span class="operator">=</span> <span class="function"><a href="/api/persisters/functions/creation/createcustompersister/">createCustomPersister</a></span><span class="punctuation">(</span>
  store<span class="punctuation">,</span>
  <span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="comment">// getPersisted</span>
    <span class="keyword">return</span> <span class="keyword">await</span> <span class="function">getDataFromRemoteSystem</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">getContent</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    <span class="comment">// setPersisted</span>
    <span class="keyword">await</span> persister<span class="punctuation">.</span><span class="function"><a href="/api/persister-automerge/interfaces/persister/automergepersister/methods/lifecycle/schedule/">schedule</a></span><span class="punctuation">(</span>
      <span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">await</span> <span class="function">checkRemoteSystemIsReady</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>
      <span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">await</span> <span class="function">sendDataToRemoteSystem</span><span class="punctuation">(</span><span class="function"><a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/methods/getter/getcontent/">getContent</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="punctuation">(</span><span class="parameter">listener</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">setInterval</span><span class="punctuation">(</span>listener<span class="punctuation">,</span> <span class="number">1000</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">(</span><span class="parameter">interval</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">clearInterval</span><span class="punctuation">(</span>interval<span class="punctuation">)</span><span class="punctuation">,</span>
<span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre></section><section class="s2"><h2>Since</h2><p>v4.0.0</p></section></section>