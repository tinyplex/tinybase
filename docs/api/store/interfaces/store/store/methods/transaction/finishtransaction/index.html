<html><head><link rel="preload" as="font" href="/fonts/lato-light.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/lato-regular.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-thin.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-light.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-mono-light.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/roboto-mono-regular.woff2" type="font/woff2" crossorigin="anonymous"><title>finishTransaction | TinyBase</title><meta property="og:type" content="website"><meta property="og:title" content="finishTransaction | TinyBase"><meta property="og:description"><meta property="og:url" content="https://beta.tinybase.org/api/store/interfaces/store/store/methods/transaction/finishtransaction"><meta property="og:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="finishTransaction | TinyBase"><meta name="twitter:description"><meta name="twitter:site" content="@tinybasejs"><meta name="twitter:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="/css/index.css"><script src="/js/app.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ"></script><script>window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments);}g('js',new Date());g('config','G-D1MGR8VRWJ');</script></head><body><header><a href="/"><img src="/favicon.svg"><span>TinyBase <em title="2.0.0-beta.5">beta</em></span></a><nav><ul><li><a href="/guides">Guides</a></li><li><a href="/demos">Demos</a></li><li><a href="/api">API</a></li><li><a href="https://github.com/tinyplex/tinybase">GitHub</a></li></ul></nav><span id="dark"></span></header><main><nav><ul><li id="root" class="parent open"><span></span><a href="/">TinyBase</a><ul><li id="G" class="parent"><span></span><a href="/guides">Guides</a></li><li id="D2" class="parent"><span></span><a href="/demos">Demos</a></li><li id="api" class="parent open"><span></span><a href="/api">API</a><ul><li id="s" class="parent open"><span></span><a href="/api/store"><code>store</code></a><ul><li id="s/I" class="parent open"><span></span><a href="/api/store/interfaces">Interfaces</a><ul><li id="S2" class="parent open"><span></span><a href="/api/store/interfaces/store/store"><code>Store</code></a><ul><li id="S2/M/G2" class="parent"><span></span><a href="/api/store/interfaces/store/store/methods/getter">Getter methods</a></li><li id="S2/M/S3" class="parent"><span></span><a href="/api/store/interfaces/store/store/methods/setter">Setter methods</a></li><li id="S2/M/L" class="parent"><span></span><a href="/api/store/interfaces/store/store/methods/listener">Listener methods</a></li><li id="S2/M/I2" class="parent"><span></span><a href="/api/store/interfaces/store/store/methods/iterator">Iterator methods</a></li><li id="S2/M/T3" class="parent open"><span></span><a href="/api/store/interfaces/store/store/methods/transaction">Transaction methods</a><ul><li id="fT" class="current"><span></span><a href="/api/store/interfaces/store/store/methods/transaction/finishtransaction"><code>finishTransaction</code></a></li><li id="sT3"><span></span><a href="/api/store/interfaces/store/store/methods/transaction/starttransaction"><code>startTransaction</code></a></li><li id="t"><span></span><a href="/api/store/interfaces/store/store/methods/transaction/transaction"><code>transaction</code></a></li></ul></li><li id="S2/M/D4" class="parent"><span></span><a href="/api/store/interfaces/store/store/methods/deleter">Deleter methods</a></li><li id="S2/M/D5" class="parent"><span></span><a href="/api/store/interfaces/store/store/methods/development">Development methods</a></li></ul></li></ul></li><li id="s/F" class="parent"><span></span><a href="/api/store/functions">Functions</a></li><li id="s/TA7" class="parent"><span></span><a href="/api/store/type-aliases">Type Aliases</a></li></ul></li><li id="m" class="parent"><span></span><a href="/api/metrics"><code>metrics</code></a></li><li id="i" class="parent"><span></span><a href="/api/indexes"><code>indexes</code></a></li><li id="r" class="parent"><span></span><a href="/api/relationships"><code>relationships</code></a></li><li id="q" class="parent"><span></span><a href="/api/queries"><code>queries</code></a></li><li id="c" class="parent"><span></span><a href="/api/checkpoints"><code>checkpoints</code></a></li><li id="p" class="parent"><span></span><a href="/api/persisters"><code>persisters</code></a></li><li id="u" class="parent"><span></span><a href="/api/ui-react"><code>ui-react</code></a></li><li id="c3" class="parent"><span></span><a href="/api/common"><code>common</code></a></li></ul></li></ul></li></ul></nav><article><nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api">API</a></li><li><a href="/api/store"><code>store</code></a></li><li><a href="/api/store/interfaces">Interfaces</a></li><li><a href="/api/store/interfaces/store/store"><code>Store</code></a></li><li><a href="/api/store/interfaces/store/store/methods/transaction">Transaction methods</a></li></ul></nav><section class="s1" id="/api/store/interfaces/store/store/methods/transaction/finishtransaction" data-id="fT"><h1><code>finishTransaction</code></h1><p>The <code>finishTransaction</code> method allows you to explicitly finish a transaction that has made multiple mutations to the <a href="/api/store/interfaces/store/store"><code>Store</code></a>, triggering all calls to the relevant listeners.</p><pre><code><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/finishtransaction">finishTransaction</a></span><span class="punctuation">(</span>doRollback<span class="operator">?</span><span class="operator">:</span> <span class="punctuation">(</span>changedCells<span class="operator">:</span> <span class="type"><a href="/api/store/type-aliases/transaction/changedcells">ChangedCells</a></span><span class="punctuation">,</span> invalidCells<span class="operator">:</span> <span class="type"><a href="/api/store/type-aliases/transaction/invalidcells">InvalidCells</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">boolean</span><span class="punctuation">)</span><span class="operator">:</span> <span class="type"><a href="/api/store/interfaces/store/store">Store</a></span></code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code>doRollback<span class="operator">?</span></code></th><td><code><span class="punctuation">(</span>changedCells<span class="operator">:</span> <span class="type"><a href="/api/store/type-aliases/transaction/changedcells">ChangedCells</a></span><span class="punctuation">,</span> invalidCells<span class="operator">:</span> <span class="type"><a href="/api/store/type-aliases/transaction/invalidcells">InvalidCells</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">boolean</span></code></td><td><p>An optional callback that should return <code>true</code> if you want to rollback the transaction at the end.</p></td></tr><tr><th class="right">returns</th><td><code><span class="type"><a href="/api/store/interfaces/store/store">Store</a></span></code></td><td><p>A reference to the Store.</p></td></tr></table></div><p><a href="/guides/the-basics/transactions">Transactions</a> are useful for making bulk changes to the data in a <a href="/api/store/interfaces/store/store"><code>Store</code></a>, and when you don&#x27;t want listeners to be called as you make each change. Changes are made silently during the transaction, and listeners relevant to the changes you have made will instead only be called when the whole transaction is complete.</p><p>Generally it is preferable to use the <a href="/api/store/interfaces/store/store/methods/transaction/transaction"><code>transaction</code></a> method to wrap a block of code as a transaction. It simply calls both the startTransaction and <code>finishTransaction</code> methods for you. See that method for several transaction examples.</p><p>Use this <code>finishTransaction</code> method when you have a more &#x27;open-ended&#x27; transaction, such as one containing mutations triggered from other events that are asynchronous or not occurring inline to your code. There must have been a corresponding <a href="/api/store/interfaces/store/store/methods/transaction/starttransaction"><code>startTransaction</code></a> method that this completes, of course, otherwise this function has no effect.</p><section class="s2"><h2>Examples</h2><p>This example makes changes to two Cells, first outside, and secondly within, a transaction that is explicitly started and finished. In the second case, the <a href="/api/store/type-aliases/store/row"><code>Row</code></a> listener is only called once.</p><pre><code><span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settables">setTables</a></span><span class="punctuation">(</span><span class="punctuation">{</span><span class="literal-property">pets</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">fido</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/listener/addrowlistener">addRowListener</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span><span class="string">'Fido changed'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>

store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'color'</span><span class="punctuation">,</span> <span class="string">'brown'</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'sold'</span><span class="punctuation">,</span> <span class="boolean">false</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 'Fido changed'</span>
<span class="comment">// -> 'Fido changed'</span>

store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/starttransaction">startTransaction</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'color'</span><span class="punctuation">,</span> <span class="string">'walnut'</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'sold'</span><span class="punctuation">,</span> <span class="boolean">true</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/finishtransaction">finishTransaction</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 'Fido changed'</span>
</code></pre><p>This example makes multiple changes to the <a href="/api/store/interfaces/store/store"><code>Store</code></a>, including some attempts to update a <a href="/api/store/type-aliases/store/cell"><code>Cell</code></a> with invalid values. The <code>doRollback</code> callback receives information about the changes and invalid attempts, and then judges that the transaction should be rolled back to its original state.</p><pre><code><span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/store/functions/creation/createstore">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/settables">setTables</a></span><span class="punctuation">(</span><span class="punctuation">{</span>
  <span class="literal-property">pets</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">fido</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">species</span><span class="operator">:</span> <span class="string">'dog'</span><span class="punctuation">,</span> <span class="literal-property">color</span><span class="operator">:</span> <span class="string">'brown'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/starttransaction">startTransaction</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'color'</span><span class="punctuation">,</span> <span class="string">'black'</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'eyes'</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="string">'left'</span><span class="punctuation">,</span> <span class="string">'right'</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'info'</span><span class="punctuation">,</span> <span class="punctuation">{</span><span class="literal-property">sold</span><span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/transaction/finishtransaction">finishTransaction</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="parameter">changedCells<span class="punctuation">,</span> invalidCells</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/getter/gettables">getTables</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="comment">// -> {pets: {fido: {species: 'dog', color: 'black'}}}</span>
  console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>changedCells<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="comment">// -> {pets: {fido: {color: ['brown', 'black']}}}</span>
  console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>invalidCells<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="comment">// -> {pets: {fido: {eyes: [['left', 'right']], info: [{sold: null}]}}}</span>
  <span class="keyword">return</span> invalidCells<span class="punctuation">[</span><span class="string">'pets'</span><span class="punctuation">]</span> <span class="operator">!=</span> <span class="keyword">null</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>

console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>store<span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/getter/gettables">getTables</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> {pets: {fido: {species: 'dog', color: 'brown'}}}</span>
</code></pre></section><section class="s2"><h2>Since</h2><p>v1.3.0</p></section></section></article><aside></aside></main><footer><nav><a id="tw" href="https://twitter.com/tinybasejs" target="_blank"></a><a id="fb" href="https://facebook.com/tinybasejs" target="_blank"></a></nav><nav><a href="/">TinyBase 2.0.0-beta.5</a> © 2021- All Rights Reserved</nav></footer></body></html>