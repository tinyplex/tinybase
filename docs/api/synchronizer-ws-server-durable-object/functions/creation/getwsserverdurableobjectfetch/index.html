<!DOCTYPE html><html lang="en"><head><link rel="dns-prefetch" href="https://www.googletagmanager.com/"><link href="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ" rel="preload" as="script"><link rel="preload" as="font" href="/fonts/inter.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/inconsolata.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/shantell.woff2" type="font/woff2" crossorigin="anonymous"><title>getWsServerDurableObjectFetch | TinyBase</title><meta name="description" content="The getWsServerDurableObjectFetch function returns a convenient handler for a Cloudflare worker to route requests to the fetch handler of a WsServerDurableObject for the given namespace."><meta property="og:type" content="website"><meta property="og:title" content="getWsServerDurableObjectFetch | TinyBase"><meta property="og:description" content="The getWsServerDurableObjectFetch function returns a convenient handler for a Cloudflare worker to route requests to the fetch handler of a WsServerDurableObject for the given namespace."><meta property="og:url" content="https://beta.tinybase.org/api/synchronizer-ws-server-durable-object/functions/creation/getwsserverdurableobjectfetch/"><meta property="og:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="getWsServerDurableObjectFetch | TinyBase"><meta name="twitter:description" content="The getWsServerDurableObjectFetch function returns a convenient handler for a Cloudflare worker to route requests to the fetch handler of a WsServerDurableObject for the given namespace."><meta name="twitter:site" content="@tinybasejs"><meta name="twitter:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="/css/index.css"><link rel="canonical" href="https://beta.tinybase.org/api/synchronizer-ws-server-durable-object/functions/creation/getwsserverdurableobjectfetch/"><script src="/js/app.js"></script></head><body><header><a href="/"><img src="/favicon.svg" alt="TinyBase logo"><span>TinyBase <em>Î²</em></span></a><nav><ul><li><a href="/guides/">Guides</a></li><li><a href="/demos/">Demos</a></li><li><a href="/api/">API</a></li><li><a href="https://github.com/tinyplex/tinybase">GitHub</a></li></ul></nav><span id="dark"></span></header><main><nav><ul><li id="root" class="parent open"><span></span><a href="/">TinyBase</a><ul><li id="G" class="parent"><span></span><a href="/guides/">Guides</a></li><li id="D2" class="parent"><span></span><a href="/demos/">Demos</a></li><li id="api" class="parent open"><span></span><a href="/api/">API</a><ul><li id="s" class="parent"><span></span><a href="/api/store/"><code>store</code></a></li><li id="m" class="parent"><span></span><a href="/api/mergeable-store/"><code>mergeable-store</code></a></li><li id="m3" class="parent"><span></span><a href="/api/metrics/"><code>metrics</code></a></li><li id="i" class="parent"><span></span><a href="/api/indexes/"><code>indexes</code></a></li><li id="r" class="parent"><span></span><a href="/api/relationships/"><code>relationships</code></a></li><li id="q" class="parent"><span></span><a href="/api/queries/"><code>queries</code></a></li><li id="c" class="parent"><span></span><a href="/api/checkpoints/"><code>checkpoints</code></a></li><li id="c3" class="parent"><span></span><a href="/api/common/"><code>common</code></a></li><li id="p" class="parent"><span></span><a href="/api/persisters/"><code>persisters</code></a></li><li id="p2" class="parent"><span></span><a href="/api/persister-automerge/"><code>persister-automerge</code></a></li><li id="p3" class="parent"><span></span><a href="/api/persister-browser/"><code>persister-browser</code></a></li><li id="p4" class="parent"><span></span><a href="/api/persister-cr-sqlite-wasm/"><code>persister-cr-sqlite-wasm</code></a></li><li id="p5" class="parent"><span></span><a href="/api/persister-durable-object-storage/"><code>persister-durable-object-storage</code></a></li><li id="p6" class="parent"><span></span><a href="/api/persister-electric-sql/"><code>persister-electric-sql</code></a></li><li id="p7" class="parent"><span></span><a href="/api/persister-expo-sqlite/"><code>persister-expo-sqlite</code></a></li><li id="p8" class="parent"><span></span><a href="/api/persister-file/"><code>persister-file</code></a></li><li id="p9" class="parent"><span></span><a href="/api/persister-indexed-db/"><code>persister-indexed-db</code></a></li><li id="p10" class="parent"><span></span><a href="/api/persister-libsql/"><code>persister-libsql</code></a></li><li id="p11" class="parent"><span></span><a href="/api/persister-partykit-client/"><code>persister-partykit-client</code></a></li><li id="p12" class="parent"><span></span><a href="/api/persister-partykit-server/"><code>persister-partykit-server</code></a></li><li id="p13" class="parent"><span></span><a href="/api/persister-pglite/"><code>persister-pglite</code></a></li><li id="p14" class="parent"><span></span><a href="/api/persister-postgres/"><code>persister-postgres</code></a></li><li id="p15" class="parent"><span></span><a href="/api/persister-powersync/"><code>persister-powersync</code></a></li><li id="p16" class="parent"><span></span><a href="/api/persister-remote/"><code>persister-remote</code></a></li><li id="p17" class="parent"><span></span><a href="/api/persister-sqlite-wasm/"><code>persister-sqlite-wasm</code></a></li><li id="p18" class="parent"><span></span><a href="/api/persister-sqlite3/"><code>persister-sqlite3</code></a></li><li id="p19" class="parent"><span></span><a href="/api/persister-yjs/"><code>persister-yjs</code></a></li><li id="s40" class="parent"><span></span><a href="/api/synchronizers/"><code>synchronizers</code></a></li><li id="s43" class="parent"><span></span><a href="/api/synchronizer-broadcast-channel/"><code>synchronizer-broadcast-channel</code></a></li><li id="s46" class="parent"><span></span><a href="/api/synchronizer-local/"><code>synchronizer-local</code></a></li><li id="s49" class="parent"><span></span><a href="/api/synchronizer-ws-client/"><code>synchronizer-ws-client</code></a></li><li id="s52" class="parent"><span></span><a href="/api/synchronizer-ws-server/"><code>synchronizer-ws-server</code></a></li><li id="s53" class="parent open"><span></span><a href="/api/synchronizer-ws-server-durable-object/"><code>synchronizer-ws-server-durable-object</code></a><ul><li id="s53/C65" class="parent"><span></span><a href="/api/synchronizer-ws-server-durable-object/classes/">Classes</a></li><li id="s53/F33" class="parent open"><span></span><a href="/api/synchronizer-ws-server-durable-object/functions/">Functions</a><ul><li id="gWSDOF" class="current"><span></span><a href="/api/synchronizer-ws-server-durable-object/functions/creation/getwsserverdurableobjectfetch/"><code>getWsServerDurableObjectFetch</code></a></li></ul></li></ul></li><li id="s54" class="parent"><span></span><a href="/api/synchronizer-ws-server-simple/"><code>synchronizer-ws-server-simple</code></a></li><li id="t3" class="parent"><span></span><a href="/api/tools/"><code>tools</code></a></li><li id="u" class="parent"><span></span><a href="/api/ui-react/"><code>ui-react</code></a></li><li id="u2" class="parent"><span></span><a href="/api/ui-react-dom/"><code>ui-react-dom</code></a></li><li id="u3" class="parent"><span></span><a href="/api/ui-react-inspector/"><code>ui-react-inspector</code></a></li></ul></li></ul></li></ul></nav><article><nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api/">API</a></li><li><a href="/api/synchronizer-ws-server-durable-object/"><code>synchronizer-ws-server-durable-object</code></a></li><li><a href="/api/synchronizer-ws-server-durable-object/functions/">Functions</a></li><li><a href="/api/synchronizer-ws-server-durable-object/functions/creation/getwsserverdurableobjectfetch/"><code>getWsServerDurableObjectFetch</code></a></li></ul></nav><section class="s1" id="/api/synchronizer-ws-server-durable-object/functions/creation/getwsserverdurableobjectfetch/" data-id="gWSDOF"><h1><code>getWsServerDurableObjectFetch</code></h1><p>The <code>getWsServerDurableObjectFetch</code> function returns a convenient handler for a Cloudflare worker to route requests to the fetch handler of a <a href="/api/synchronizer-ws-server-durable-object/classes/creation/wsserverdurableobject/"><code>WsServerDurableObject</code></a> for the given namespace.</p><pre><code><span class="generic-function"><span class="function"><a href="/api/synchronizer-ws-server-durable-object/functions/creation/getwsserverdurableobjectfetch/">getWsServerDurableObjectFetch</a></span><span class="generic"><span class="operator">&lt;</span>Namespace<span class="operator">></span></span></span><span class="punctuation">(</span>namespace<span class="operator">:</span> Namespace<span class="punctuation">)</span><span class="operator">:</span> <span class="punctuation">(</span>request<span class="operator">:</span> Request<span class="punctuation">,</span> env<span class="operator">:</span> <span class="punctuation">{</span><span class="punctuation">[</span><span class="keyword">namespace</span> <span class="keyword">in</span> Namespace<span class="punctuation">]</span><span class="operator">:</span> DurableObjectNamespace<span class="operator">&lt;</span>WsServerDurableObject<span class="operator">></span><span class="punctuation">}</span><span class="punctuation">)</span> <span class="operator">=></span> Response</code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code><span class="keyword">namespace</span></code></th><td><code>Namespace</code></td><td><p>A string for the namespace of the Durable Objects that you want this worker to route requests to.</p></td></tr><tr><th class="right">returns</th><td><code><span class="punctuation">(</span>request<span class="operator">:</span> Request<span class="punctuation">,</span> env<span class="operator">:</span> <span class="punctuation">{</span><span class="punctuation">[</span><span class="keyword">namespace</span> <span class="keyword">in</span> Namespace<span class="punctuation">]</span><span class="operator">:</span> DurableObjectNamespace<span class="operator">&lt;</span>WsServerDurableObject<span class="operator">></span><span class="punctuation">}</span><span class="punctuation">)</span> <span class="operator">=></span> Response</code></td><td><p></p><p>A fetch handler that routes WebSocket upgrade requests to a Durable Object.</p><p></p></td></tr></table></div><p>The implementation of the function that this returns requires the request to be a WebSocket &#x27;Upgrade&#x27; request, and for the client to have provided a <code>sec-websocket-key</code> header that the server can use as a unique key for the client.</p><p>It then takes the path of the HTTP request and routes the upgrade request to a Durable Object (in the given namespace) for that path. From then on, the Durable Object handles all the WebSocket communication.</p><p>Note that you&#x27;ll need to have a Wrangler configuration that connects your Durable Object class to the namespace. In other words, you&#x27;ll have something like this in your <code>wrangler.toml</code> file.</p><pre><code><span class="punctuation">[</span><span class="punctuation">[</span><span class="table">durable_objects.bindings</span><span class="punctuation">]</span><span class="punctuation">]</span>
<span class="key">name</span> <span class="punctuation">=</span> <span class="string">"MyDurableObjects"</span>
<span class="key">class_name</span> <span class="punctuation">=</span> <span class="string">"MyDurableObject"</span>
</code></pre><p>Note that it is not required to use this handler to route TinyBase client requests in your Cloudflare app. If you have your own custom routing logic, path scheme, or authentication, for example, you can easily implement that in the worker&#x27;s fetch method yourself. See the <a href="https://developers.cloudflare.com/durable-objects/best-practices/create-durable-object-stubs-and-send-requests/#invoking-the-fetch-handler">Durable Objects documentation</a> for examples.</p><p>You can also pass a newly created request to the Durable Object&#x27;s <code>fetch</code> method. For example, you can overwrite the &#x27;path&#x27; that the Durable Object thinks it is serving, perhaps to inject a unique authenticated user <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> that wasn&#x27;t actually provided by the client WebSocket.</p><section class="s2"><h2>Example</h2><p>This example sets up default routing of the WebSocket upgrade request to a Durable Object in the <code>MyDurableObjects</code> namespace. This would require the <code>wrangler.toml</code> configuration shown above.</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>
  WsServerDurableObject<span class="punctuation">,</span>
  getWsServerDurableObjectFetch<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/synchronizers/synchronizer-ws-server-durable-object'</span><span class="punctuation">;</span>

<span class="keyword">export</span> <span class="keyword">class</span> <span class="class-name">MyDurableObject</span> <span class="keyword">extends</span> <span class="class-name"><a href="/api/synchronizer-ws-server-durable-object/classes/creation/wsserverdurableobject/">WsServerDurableObject</a></span> <span class="punctuation">{</span><span class="punctuation">}</span>

<span class="keyword">export</span> <span class="keyword">default</span> <span class="punctuation">{</span><span class="literal-property">fetch</span><span class="operator">:</span> <span class="function"><a href="/api/synchronizer-ws-server-durable-object/functions/creation/getwsserverdurableobjectfetch/">getWsServerDurableObjectFetch</a></span><span class="punctuation">(</span><span class="string">'MyDurableObjects'</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="punctuation">;</span>
</code></pre></section><section class="s2"><h2>Since</h2><p>v5.4.0</p></section></section></article><aside></aside></main><footer><nav><a id="gh" href="https://github.com/tinyplex/tinybase" target="_blank">GitHub</a><a id="bs" href="https://bsky.app/profile/tinybase.bsky.social" target="_blank">Bluesky</a><a id="tw" href="https://x.com/tinybasejs" target="_blank">X / Twitter</a><a id="dc" href="https://discord.com/invite/mGz3mevwP8" target="_blank">Discord</a></nav><nav><a href="/">TinyBase <span id="version"></span></a> Â© 2022-</nav></footer></body><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ"></script><script>window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments);}g('js',new Date());g('config','G-D1MGR8VRWJ');</script></html>