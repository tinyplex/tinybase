<nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api/">API</a></li><li><a href="/api/schematizers/"><code>schematizers</code></a></li><li><a href="/api/schematizers/functions/">Functions</a></li><li><a href="/api/schematizers/functions/creation/createcustomschematizer/"><code>createCustomSchematizer</code></a></li></ul></nav><section class="s1" id="/api/schematizers/functions/creation/createcustomschematizer/" data-id="cCS2"><h1><code>createCustomSchematizer</code></h1><p>The <code>createCustomSchematizer</code> function creates a custom <a href="/api/schematizers/interfaces/schematizer/schematizer/"><code>Schematizer</code></a> that can convert schemas from any validation library into TinyBase schemas.</p><pre><code><span class="function"><a href="/api/schematizers/functions/creation/createcustomschematizer/">createCustomSchematizer</a></span><span class="punctuation">(</span>
  <span class="function-variable">unwrapSchema</span><span class="operator">:</span> <span class="punctuation">(</span>schema<span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">,</span> defaultValue<span class="operator">?</span><span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">,</span> allowNull<span class="operator">?</span><span class="operator">:</span> <span class="builtin">boolean</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">[</span><span class="builtin">any</span><span class="punctuation">,</span> <span class="builtin">any</span><span class="punctuation">,</span> <span class="builtin">boolean</span><span class="punctuation">]</span><span class="punctuation">,</span>
  <span class="function-variable">getProperties</span><span class="operator">:</span> <span class="punctuation">(</span>schema<span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">any</span><span class="punctuation">,</span>
<span class="punctuation">)</span><span class="operator">:</span> <span class="type"><a href="/api/schematizers/interfaces/schematizer/schematizer/">Schematizer</a></span></code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code>unwrapSchema</code></th><td><code><span class="punctuation">(</span>schema<span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">,</span> defaultValue<span class="operator">?</span><span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">,</span> allowNull<span class="operator">?</span><span class="operator">:</span> <span class="builtin">boolean</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">[</span><span class="builtin">any</span><span class="punctuation">,</span> <span class="builtin">any</span><span class="punctuation">,</span> <span class="builtin">boolean</span><span class="punctuation">]</span></code></td><td><p>A function that unwraps a schema to extract the base type, default value, and nullable flag. It should recursively unwrap optional/nullable wrappers and return a tuple of [schema, defaultValue, allowNull].</p></td></tr><tr><th><code>getProperties</code></th><td><code><span class="punctuation">(</span>schema<span class="operator">:</span> <span class="builtin">any</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">any</span></code></td><td><p>A function that extracts the properties/entries/shape from an object schema. Returns undefined if the schema is not an object.</p></td></tr><tr><th class="right">returns</th><td><code><span class="type"><a href="/api/schematizers/interfaces/schematizer/schematizer/">Schematizer</a></span></code></td><td><p></p><p>A new <a href="/api/schematizers/interfaces/schematizer/schematizer/"><code>Schematizer</code></a> instance.</p><p></p></td></tr></table></div><p>This function allows you to build schematizers for validation libraries not natively supported by TinyBase. You provide two functions: one to unwrap optional/nullable/default wrappers from your library&#x27;s schemas, and one to extract object properties.</p><section class="s2"><h2>Example</h2><p>This example creates a custom schematizer for a hypothetical validation library.</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>createCustomSchematizer<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/schematizers'</span><span class="punctuation">;</span>

<span class="comment">// Hypothetical library has schemas like:</span>
<span class="comment">// {type: 'string'}, {type: 'optional', inner: ...}, etc.</span>

<span class="keyword">const</span> <span class="function-variable">unwrapSchema</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">schema<span class="punctuation">,</span> defaultValue<span class="punctuation">,</span> allowNull</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">if</span> <span class="punctuation">(</span>schema<span class="punctuation">.</span>type <span class="operator">===</span> <span class="string">'optional'</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="function">unwrapSchema</span><span class="punctuation">(</span>schema<span class="punctuation">.</span>inner<span class="punctuation">,</span> defaultValue<span class="punctuation">,</span> allowNull<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
  <span class="keyword">if</span> <span class="punctuation">(</span>schema<span class="punctuation">.</span>type <span class="operator">===</span> <span class="string">'nullable'</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="function">unwrapSchema</span><span class="punctuation">(</span>schema<span class="punctuation">.</span>inner<span class="punctuation">,</span> defaultValue<span class="punctuation">,</span> <span class="boolean">true</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
  <span class="keyword">return</span> <span class="punctuation">[</span>schema<span class="punctuation">,</span> defaultValue <span class="operator">??</span> schema<span class="punctuation">.</span>default<span class="punctuation">,</span> allowNull <span class="operator">??</span> <span class="boolean">false</span><span class="punctuation">]</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">getProperties</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter">schema</span><span class="punctuation">)</span> <span class="operator">=></span> schema<span class="punctuation">.</span>fields<span class="punctuation">;</span>

<span class="keyword">const</span> schematizer <span class="operator">=</span> <span class="function"><a href="/api/schematizers/functions/creation/createcustomschematizer/">createCustomSchematizer</a></span><span class="punctuation">(</span>unwrapSchema<span class="punctuation">,</span> getProperties<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> tablesSchema <span class="operator">=</span> schematizer<span class="punctuation">.</span><span class="function"><a href="/api/schematizers/interfaces/schematizer/schematizer/methods/conversion/totablesschema/">toTablesSchema</a></span><span class="punctuation">(</span><span class="punctuation">{</span>
  <span class="literal-property">pets</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">type</span><span class="operator">:</span> <span class="string">'object'</span><span class="punctuation">,</span> <span class="literal-property">fields</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">name</span><span class="operator">:</span> <span class="punctuation">{</span><span class="literal-property">type</span><span class="operator">:</span> <span class="string">'string'</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">}</span><span class="punctuation">,</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>tablesSchema<span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> {pets: {name: {type: 'string'}}}</span>
</code></pre></section><section class="s2"><h2>Since</h2><p>v7.1.0</p></section></section>