<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="preload" as="image" href="/favicon.svg"><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ"></script><link rel="dns-prefetch" href="https://www.googletagmanager.com/"><link href="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ" rel="preload" as="script"><link rel="preload" as="font" href="/fonts/inter.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/inconsolata.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/shantell.woff2" type="font/woff2" crossorigin="anonymous"><title>useCreateSynchronizer | TinyBase</title><meta name="description" content="The useCreateSynchronizer hook is used to create a Synchronizer within a React application along with convenient memoization and callbacks."><meta property="og:type" content="website"><meta property="og:title" content="useCreateSynchronizer | TinyBase"><meta property="og:description" content="The useCreateSynchronizer hook is used to create a Synchronizer within a React application along with convenient memoization and callbacks."><meta property="og:url" content="https://beta.tinybase.org/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/"><meta property="og:image" content="https://beta.tinybase.org/favicon_pad.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="useCreateSynchronizer | TinyBase"><meta name="twitter:description" content="The useCreateSynchronizer hook is used to create a Synchronizer within a React application along with convenient memoization and callbacks."><meta name="twitter:site" content="@tinybasejs"><meta name="twitter:image" content="https://beta.tinybase.org/favicon_pad.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="canonical" href="https://beta.tinybase.org/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/"><link rel="stylesheet" href="/css/index.css"><script src="/js/app.js"></script></head><body><header><a href="/"><img src="/favicon.svg" alt="TinyBase logo"><span>TinyBase <em>β</em></span></a><nav><ul><li><a href="/guides/">Guides</a></li><li><a href="/demos/">Demos</a></li><li><a href="/api/">API</a></li><li><a href="https://github.com/tinyplex/tinybase">GitHub</a></li></ul></nav><span id="dark"></span></header><main><nav><ul><li id="root" class="parent open"><span></span><a href="/">TinyBase</a><ul><li id="G" class="parent"><span></span><a href="/guides/">Guides</a></li><li id="D2" class="parent"><span></span><a href="/demos/">Demos</a></li><li id="api" class="parent open"><span></span><a href="/api/">API</a><ul><li id="e" class="parent"><span></span><a href="/api/the-essentials/">The Essentials</a></li><li id="s" class="parent"><span></span><a href="/api/store/"><code>store</code></a></li><li id="m" class="parent"><span></span><a href="/api/mergeable-store/"><code>mergeable-store</code></a></li><li id="m3" class="parent"><span></span><a href="/api/metrics/"><code>metrics</code></a></li><li id="i" class="parent"><span></span><a href="/api/indexes/"><code>indexes</code></a></li><li id="r" class="parent"><span></span><a href="/api/relationships/"><code>relationships</code></a></li><li id="q" class="parent"><span></span><a href="/api/queries/"><code>queries</code></a></li><li id="c" class="parent"><span></span><a href="/api/checkpoints/"><code>checkpoints</code></a></li><li id="c3" class="parent"><span></span><a href="/api/common/"><code>common</code></a></li><li id="p" class="parent"><span></span><a href="/api/persisters/"><code>persisters</code></a></li><li id="p2" class="parent"><span></span><a href="/api/persister-automerge/"><code>persister-automerge</code></a></li><li id="p3" class="parent"><span></span><a href="/api/persister-browser/"><code>persister-browser</code></a></li><li id="p4" class="parent"><span></span><a href="/api/persister-cr-sqlite-wasm/"><code>persister-cr-sqlite-wasm</code></a></li><li id="p5" class="parent"><span></span><a href="/api/persister-durable-object-sql-storage/"><code>persister-durable-object-sql-storage</code></a></li><li id="p6" class="parent"><span></span><a href="/api/persister-durable-object-storage/"><code>persister-durable-object-storage</code></a></li><li id="p7" class="parent"><span></span><a href="/api/persister-electric-sql/"><code>persister-electric-sql</code></a></li><li id="p8" class="parent"><span></span><a href="/api/persister-expo-sqlite/"><code>persister-expo-sqlite</code></a></li><li id="p9" class="parent"><span></span><a href="/api/persister-file/"><code>persister-file</code></a></li><li id="p10" class="parent"><span></span><a href="/api/persister-indexed-db/"><code>persister-indexed-db</code></a></li><li id="p11" class="parent"><span></span><a href="/api/persister-libsql/"><code>persister-libsql</code></a></li><li id="p12" class="parent"><span></span><a href="/api/persister-partykit-client/"><code>persister-partykit-client</code></a></li><li id="p13" class="parent"><span></span><a href="/api/persister-partykit-server/"><code>persister-partykit-server</code></a></li><li id="p14" class="parent"><span></span><a href="/api/persister-pglite/"><code>persister-pglite</code></a></li><li id="p15" class="parent"><span></span><a href="/api/persister-postgres/"><code>persister-postgres</code></a></li><li id="p16" class="parent"><span></span><a href="/api/persister-powersync/"><code>persister-powersync</code></a></li><li id="p17" class="parent"><span></span><a href="/api/persister-react-native-mmkv/"><code>persister-react-native-mmkv</code></a></li><li id="p18" class="parent"><span></span><a href="/api/persister-react-native-sqlite/"><code>persister-react-native-sqlite</code></a></li><li id="p19" class="parent"><span></span><a href="/api/persister-remote/"><code>persister-remote</code></a></li><li id="p20" class="parent"><span></span><a href="/api/persister-sqlite-bun/"><code>persister-sqlite-bun</code></a></li><li id="p21" class="parent"><span></span><a href="/api/persister-sqlite-wasm/"><code>persister-sqlite-wasm</code></a></li><li id="p22" class="parent"><span></span><a href="/api/persister-sqlite3/"><code>persister-sqlite3</code></a></li><li id="p23" class="parent"><span></span><a href="/api/persister-yjs/"><code>persister-yjs</code></a></li><li id="s50" class="parent"><span></span><a href="/api/synchronizers/"><code>synchronizers</code></a></li><li id="s53" class="parent"><span></span><a href="/api/synchronizer-broadcast-channel/"><code>synchronizer-broadcast-channel</code></a></li><li id="s56" class="parent"><span></span><a href="/api/synchronizer-local/"><code>synchronizer-local</code></a></li><li id="s59" class="parent"><span></span><a href="/api/synchronizer-ws-client/"><code>synchronizer-ws-client</code></a></li><li id="s62" class="parent"><span></span><a href="/api/synchronizer-ws-server/"><code>synchronizer-ws-server</code></a></li><li id="s63" class="parent"><span></span><a href="/api/synchronizer-ws-server-durable-object/"><code>synchronizer-ws-server-durable-object</code></a></li><li id="s64" class="parent"><span></span><a href="/api/synchronizer-ws-server-simple/"><code>synchronizer-ws-server-simple</code></a></li><li id="s65" class="parent"><span></span><a href="/api/schematizer-zod/"><code>schematizer-zod</code></a></li><li id="s66" class="parent"><span></span><a href="/api/schematizers/"><code>schematizers</code></a></li><li id="u" class="parent open"><span></span><a href="/api/ui-react/"><code>ui-react</code></a><ul><li id="u/F40" class="parent open"><span></span><a href="/api/ui-react/functions/">Functions</a><ul><li id="u/F40/C81" class="parent"><span></span><a href="/api/ui-react/functions/checkpoints-hooks/">Checkpoints hooks</a></li><li id="u/F40/I53" class="parent"><span></span><a href="/api/ui-react/functions/indexes-hooks/">Indexes hooks</a></li><li id="u/F40/M52" class="parent"><span></span><a href="/api/ui-react/functions/metrics-hooks/">Metrics hooks</a></li><li id="u/F40/P30" class="parent"><span></span><a href="/api/ui-react/functions/persister-hooks/">Persister hooks</a></li><li id="u/F40/Q3" class="parent"><span></span><a href="/api/ui-react/functions/queries-hooks/">Queries hooks</a></li><li id="u/F40/R9" class="parent"><span></span><a href="/api/ui-react/functions/relationships-hooks/">Relationships hooks</a></li><li id="u/F40/S71" class="parent"><span></span><a href="/api/ui-react/functions/store-hooks/">Store hooks</a></li><li id="u/F40/S72" class="parent open"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/">Synchronizer hooks</a><ul><li id="uCS3" class="current"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/"><code>useCreateSynchronizer</code></a></li><li id="uPS3"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/useprovidesynchronizer/"><code>useProvideSynchronizer</code></a></li><li id="uS3"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/usesynchronizer/"><code>useSynchronizer</code></a></li><li id="uSI3"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/usesynchronizerids/"><code>useSynchronizerIds</code></a></li><li id="uSOSBI2"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/usesynchronizerorsynchronizerbyid/"><code>useSynchronizerOrSynchronizerById</code></a></li><li id="uSS"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/usesynchronizerstatus/"><code>useSynchronizerStatus</code></a></li><li id="uSSL"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/usesynchronizerstatuslistener/"><code>useSynchronizerStatusListener</code></a></li></ul></li><li id="u/F40/C82" class="parent"><span></span><a href="/api/ui-react/functions/checkpoints-components/">Checkpoints components</a></li><li id="u/F40/C83" class="parent"><span></span><a href="/api/ui-react/functions/context-components/">Context components</a></li><li id="u/F40/I54" class="parent"><span></span><a href="/api/ui-react/functions/indexes-components/">Indexes components</a></li><li id="u/F40/M53" class="parent"><span></span><a href="/api/ui-react/functions/metrics-components/">Metrics components</a></li><li id="u/F40/Q4" class="parent"><span></span><a href="/api/ui-react/functions/queries-components/">Queries components</a></li><li id="u/F40/R10" class="parent"><span></span><a href="/api/ui-react/functions/relationships-components/">Relationships components</a></li><li id="u/F40/S73" class="parent"><span></span><a href="/api/ui-react/functions/store-components/">Store components</a></li></ul></li><li id="u/TA23" class="parent"><span></span><a href="/api/ui-react/type-aliases/">Type Aliases</a></li></ul></li><li id="u2" class="parent"><span></span><a href="/api/ui-react-dom/"><code>ui-react-dom</code></a></li><li id="u3" class="parent"><span></span><a href="/api/ui-react-inspector/"><code>ui-react-inspector</code></a></li></ul></li></ul></li></ul></nav><article><nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api/">API</a></li><li><a href="/api/ui-react/"><code>ui-react</code></a></li><li><a href="/api/ui-react/functions/">Functions</a></li><li><a href="/api/ui-react/functions/synchronizer-hooks/">Synchronizer hooks</a></li><li><a href="/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/"><code>useCreateSynchronizer</code></a></li></ul></nav><section class="s1" id="/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/" data-id="uCS3"><h1><code>useCreateSynchronizer</code></h1><p>The <code>useCreateSynchronizer</code> hook is used to create a <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> within a React application along with convenient memoization and callbacks.</p><pre><code><span class="generic-function"><span class="function"><a href="/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/">useCreateSynchronizer</a></span><span class="generic"><span class="operator">&lt;</span>SynchronizerOrUndefined<span class="operator">></span></span></span><span class="punctuation">(</span>
  store<span class="operator">:</span> <span class="keyword">undefined</span> <span class="operator">|</span> <span class="type"><a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/">MergeableStore</a></span><span class="punctuation">,</span>
  <span class="function-variable">create</span><span class="operator">:</span> <span class="punctuation">(</span>store<span class="operator">:</span> <span class="type"><a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/">MergeableStore</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">Promise</span><span class="operator">&lt;</span>SynchronizerOrUndefined<span class="operator">></span><span class="punctuation">,</span>
  createDeps<span class="operator">?</span><span class="operator">:</span> DependencyList<span class="punctuation">,</span>
  destroy<span class="operator">?</span><span class="operator">:</span> <span class="punctuation">(</span>synchronizer<span class="operator">:</span> <span class="type"><a href="/api/synchronizers/interfaces/synchronizer/synchronizer/">Synchronizer</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span><span class="punctuation">,</span>
  destroyDeps<span class="operator">?</span><span class="operator">:</span> DependencyList<span class="punctuation">,</span>
<span class="punctuation">)</span><span class="operator">:</span> SynchronizerOrUndefined</code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code>store</code></th><td><code><span class="keyword">undefined</span> <span class="operator">|</span> <span class="type"><a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/">MergeableStore</a></span></code></td><td><p>A reference to the <a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/"><code>MergeableStore</code></a> for which to create a new <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> object.</p></td></tr><tr><th><code>create</code></th><td><code><span class="punctuation">(</span>store<span class="operator">:</span> <span class="type"><a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/">MergeableStore</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="builtin">Promise</span><span class="operator">&lt;</span>SynchronizerOrUndefined<span class="operator">></span></code></td><td><p>An asynchronous function for performing the creation steps of the <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> object for the <a href="/api/the-essentials/creating-stores/store/"><code>Store</code></a>.</p></td></tr><tr><th><code>createDeps<span class="operator">?</span></code></th><td><code>DependencyList</code></td><td><p>An optional array of dependencies for the <code>create</code> function, which, if any change, result in its rerun. This parameter defaults to an empty array.</p></td></tr><tr><th><code>destroy<span class="operator">?</span></code></th><td><code><span class="punctuation">(</span>synchronizer<span class="operator">:</span> <span class="type"><a href="/api/synchronizers/interfaces/synchronizer/synchronizer/">Synchronizer</a></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="keyword">void</span></code></td><td><p>An optional callback whenever the <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> is destroyed due to a change in the <code>createDeps</code> dependencies.</p></td></tr><tr><th><code>destroyDeps<span class="operator">?</span></code></th><td><code>DependencyList</code></td><td><p>An optional array of dependencies for the <code>destroy</code> callback, which, if any change, result in <code>destroy</code> and <code>then</code> being rerun. This parameter defaults to an empty array.</p></td></tr><tr><th class="right">returns</th><td><code>SynchronizerOrUndefined</code></td><td><p></p><p>A reference to the <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a>.</p><p></p></td></tr></table></div><p>It is possible to create a <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> outside of the React app with the regular createSynchronizer function and pass it in, but you may prefer to create it within the app, perhaps inside the top-level component. To prevent a new <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> being created every time the app renders or re-renders, the <code>useCreateSynchronizer</code> hook performs the creation in an effect.</p><p>If your asynchronous <code>create</code> function (the second parameter to the hook) contains dependencies, the changing of which should cause the <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> to be recreated, you can provide them in an array in the third parameter, just as you would for any React hook with dependencies. The <a href="/api/mergeable-store/interfaces/mergeable/mergeablestore/"><code>MergeableStore</code></a> passed in as the first parameter of this hook is used as a dependency by default.</p><p>The <code>create</code> function can return undefined, meaning that you can enable or disable synchronization conditionally within this hook. This is useful for applications which might turn on or off their cloud synchronization or collaboration features.</p><p>This hook ensures the <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> object is destroyed whenever a new one is created or the component is unmounted.</p><section class="s2"><h2>Examples</h2><p>This example creates a <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> at the top level of a React application. Even though the App component is rendered twice, the <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> creation only occurs once by default.</p><pre><code><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createRoot<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'react-dom/client'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createMergeableStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createLocalSynchronizer<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/synchronizers/synchronizer-local'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>
  useCreateMergeableStore<span class="punctuation">,</span>
  useCreateSynchronizer<span class="punctuation">,</span>
  useTables<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/ui-react'</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatemergeablestore/">useCreateMergeableStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function"><a href="/api/the-essentials/creating-stores/createmergeablestore/">createMergeableStore</a></span><span class="punctuation">(</span><span class="string">'s1'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function"><a href="/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/">useCreateSynchronizer</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
    console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span><span class="string">'Synchronizer created'</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">return</span> <span class="keyword">await</span> <span class="function"><a href="/api/synchronizer-local/functions/creation/createlocalsynchronizer/">createLocalSynchronizer</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> <span class="string">'pets'</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>span</span><span class="punctuation">></span></span><span class="punctuation">{</span><span class="constant">JSON</span><span class="punctuation">.</span><span class="function">stringify</span><span class="punctuation">(</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usetables/">useTables</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>span</span><span class="punctuation">></span></span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> app <span class="operator">=</span> document<span class="punctuation">.</span><span class="function">createElement</span><span class="punctuation">(</span><span class="string">'div'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> root <span class="operator">=</span> <span class="function">createRoot</span><span class="punctuation">(</span>app<span class="punctuation">)</span><span class="punctuation">;</span>
root<span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 'Synchronizer created'</span>

<span class="comment">// ...</span>
root<span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// No second Synchronizer creation</span>

root<span class="punctuation">.</span><span class="function">unmount</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>This example creates a <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> at the top level of a React application. The App component is rendered twice, each with a different top-level prop. The <code>useCreateSynchronizer</code> hook takes the <code>url</code> prop as a dependency, and so the <a href="/api/synchronizers/interfaces/synchronizer/synchronizer/"><code>Synchronizer</code></a> object is created again on the second render. The first is destroyed and the <code>destroy</code> parameter is called for it. A <code>then</code> parameter is provided to start both Synchronizers&#x27; synchronization.</p><pre><code><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>WebSocket<span class="punctuation">,</span> WebSocketServer<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'ws'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createRoot<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'react-dom/client'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createMergeableStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createWsSynchronizer<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/synchronizers/synchronizer-ws-client'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createWsServer<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/synchronizers/synchronizer-ws-server'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>
  useCreateMergeableStore<span class="punctuation">,</span>
  useCreateSynchronizer<span class="punctuation">,</span>
  useTables<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/ui-react'</span><span class="punctuation">;</span>

<span class="keyword">const</span> server1 <span class="operator">=</span> <span class="function"><a href="/api/synchronizer-ws-server/functions/creation/createwsserver/">createWsServer</a></span><span class="punctuation">(</span><span class="keyword">new</span> <span class="class-name">WebSocketServer</span><span class="punctuation">(</span><span class="punctuation">{</span><span class="literal-property">port</span><span class="operator">:</span> <span class="number">8044</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> server2 <span class="operator">=</span> <span class="function"><a href="/api/synchronizer-ws-server/functions/creation/createwsserver/">createWsServer</a></span><span class="punctuation">(</span><span class="keyword">new</span> <span class="class-name">WebSocketServer</span><span class="punctuation">(</span><span class="punctuation">{</span><span class="literal-property">port</span><span class="operator">:</span> <span class="number">8045</span><span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="parameter"><span class="punctuation">{</span>url<span class="punctuation">}</span></span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatemergeablestore/">useCreateMergeableStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function"><a href="/api/the-essentials/creating-stores/createmergeablestore/">createMergeableStore</a></span><span class="punctuation">(</span><span class="string">'s1'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function"><a href="/api/ui-react/functions/synchronizer-hooks/usecreatesynchronizer/">useCreateSynchronizer</a></span><span class="punctuation">(</span>
    store<span class="punctuation">,</span>
    <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
      <span class="keyword">const</span> webSocket <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">WebSocket</span><span class="punctuation">(</span>url<span class="punctuation">)</span><span class="punctuation">;</span>
      console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">Synchronizer created for </span><span class="interpolation"><span class="interpolation-punctuation">${</span>webSocket<span class="punctuation">.</span>url<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">return</span> <span class="keyword">await</span> <span class="function"><a href="/api/synchronizer-ws-client/functions/creation/createwssynchronizer/">createWsSynchronizer</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> webSocket<span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">,</span>
    <span class="punctuation">[</span>url<span class="punctuation">]</span><span class="punctuation">,</span>
    <span class="punctuation">(</span><span class="parameter">synchronizer</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
      <span class="keyword">const</span> webSocket <span class="operator">=</span> synchronizer<span class="punctuation">.</span><span class="function"><a href="/api/synchronizer-ws-client/interfaces/synchronizer/wssynchronizer/methods/getter/getwebsocket/">getWebSocket</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
      console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span><span class="template-string"><span class="template-punctuation">`</span><span class="string">Synchronizer destroyed for </span><span class="interpolation"><span class="interpolation-punctuation">${</span>webSocket<span class="punctuation">.</span>url<span class="interpolation-punctuation">}</span></span><span class="template-punctuation">`</span></span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>span</span><span class="punctuation">></span></span><span class="punctuation">{</span><span class="constant">JSON</span><span class="punctuation">.</span><span class="function">stringify</span><span class="punctuation">(</span><span class="function"><a href="/api/ui-react/functions/store-hooks/usetables/">useTables</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>span</span><span class="punctuation">></span></span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>

<span class="keyword">const</span> app <span class="operator">=</span> document<span class="punctuation">.</span><span class="function">createElement</span><span class="punctuation">(</span><span class="string">'div'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> root <span class="operator">=</span> <span class="function">createRoot</span><span class="punctuation">(</span>app<span class="punctuation">)</span><span class="punctuation">;</span>
root<span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="attr-name">url</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>ws://localhost:8044/<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// ...</span>
<span class="comment">// -> 'Synchronizer created for ws://localhost:8044/'</span>

root<span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="attr-name">url</span><span class="attr-value"><span class="punctuation">=</span><span class="punctuation">"</span>ws://localhost:8045/<span class="punctuation">"</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// ...</span>
<span class="comment">// -> 'Synchronizer created for ws://localhost:8045/'</span>
<span class="comment">// -> 'Synchronizer destroyed for ws://localhost:8044/'</span>

root<span class="punctuation">.</span><span class="function">unmount</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 'Synchronizer destroyed for ws://localhost:8045/'</span>

<span class="keyword">await</span> server1<span class="punctuation">.</span><span class="function"><a href="/api/synchronizers/interfaces/synchronizer/synchronizer/methods/lifecycle/destroy/">destroy</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">await</span> server2<span class="punctuation">.</span><span class="function"><a href="/api/synchronizers/interfaces/synchronizer/synchronizer/methods/lifecycle/destroy/">destroy</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre></section><section class="s2"><h2>Since</h2><p>v5.0.0</p></section></section></article><aside></aside></main><footer><nav><a id="gh" href="https://github.com/tinyplex/tinybase" target="_blank">GitHub</a><a id="bs" href="https://bsky.app/profile/tinybase.bsky.social" target="_blank">Bluesky</a><a id="tw" href="https://x.com/tinybasejs" target="_blank">X / Twitter</a><a id="dc" href="https://discord.com/invite/mGz3mevwP8" target="_blank">Discord</a></nav><nav><a href="/">TinyBase <span id="version"></span></a> © 2022-</nav></footer><script>window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments);}g('js',new Date());g('config','G-D1MGR8VRWJ');</script></body></html>