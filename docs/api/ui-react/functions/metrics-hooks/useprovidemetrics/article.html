<nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api/">API</a></li><li><a href="/api/ui-react/"><code>ui-react</code></a></li><li><a href="/api/ui-react/functions/">Functions</a></li><li><a href="/api/ui-react/functions/metrics-hooks/">Metrics hooks</a></li><li><a href="/api/ui-react/functions/metrics-hooks/useprovidemetrics/"><code>useProvideMetrics</code></a></li></ul></nav><section class="s1" id="/api/ui-react/functions/metrics-hooks/useprovidemetrics/" data-id="uPM"><h1><code>useProvideMetrics</code></h1><p>The <code>useProvideMetrics</code> hook is used to add a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object by <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> to a <a href="/api/ui-react/functions/context-components/provider/"><code>Provider</code></a> component, but imperatively from a component within it.</p><pre><code><span class="function"><a href="/api/ui-react/functions/metrics-hooks/useprovidemetrics/">useProvideMetrics</a></span><span class="punctuation">(</span>
  metricsId<span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">,</span>
  metrics<span class="operator">:</span> <span class="type"><a href="/api/metrics/interfaces/metrics/metrics/">Metrics</a></span><span class="punctuation">,</span>
<span class="punctuation">)</span><span class="operator">:</span> <span class="keyword">void</span></code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code>metricsId</code></th><td><code><span class="builtin">string</span></code></td><td><p>The <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> of the <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object to be registered with the Provider.</p></td></tr><tr><th><code>metrics</code></th><td><code><span class="type"><a href="/api/metrics/interfaces/metrics/metrics/">Metrics</a></span></code></td><td><p>The <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object to be registered.</p></td></tr><tr><th class="right">returns</th><td><code><span class="keyword">void</span></code></td><td><p>This has no return value.</p></td></tr></table></div><p>Normally you will register a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object by <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> in a context by using the <code>metricsById</code> prop of the top-level <a href="/api/ui-react/functions/context-components/provider/"><code>Provider</code></a> component. This hook, however, lets you dynamically add a new <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object to the context, from within a descendent component. This is useful for applications where the set of <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> objects is not known at the time of the first render of the root Provider.</p><p>A <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object added to the Provider context in this way will be available to other components within the context (using the <a href="/api/ui-react/functions/metrics-hooks/usemetrics/"><code>useMetrics</code></a> hook and so on). If you use the same <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> as an existing <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object registration, the new one will take priority over one provided by the <code>metricsById</code> prop.</p><p>Note that other components that consume a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object registered like this should defend against it being undefined at first. On the first render, the other component will likely not yet have completed the registration. In the example below, we use the null-safe <code>useMetrics(&#x27;petMetrics&#x27;)?</code> to do this.</p><section class="s2"><h2>Example</h2><p>This example creates a Provider context. A child component registers a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object into it which is then consumable by a peer child component.</p><pre><code><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createRoot<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'react-dom/client'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createMetrics<span class="punctuation">,</span> createStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>
  Provider<span class="punctuation">,</span>
  useCreateMetrics<span class="punctuation">,</span>
  useCreateStore<span class="punctuation">,</span>
  useMetrics<span class="punctuation">,</span>
  useProvideMetrics<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/ui-react'</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">RegisterMetrics</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ConsumeMetrics</span></span> <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> <span class="function-variable">RegisterMetrics</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatestore/">useCreateStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
    <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell/">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'color'</span><span class="punctuation">,</span> <span class="string">'brown'</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> metrics <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/metrics-hooks/usecreatemetrics/">useCreateMetrics</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span>
    <span class="function"><a href="/api/metrics/functions/creation/createmetrics/">createMetrics</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/metrics/interfaces/metrics/metrics/methods/configuration/setmetricdefinition/">setMetricDefinition</a></span><span class="punctuation">(</span><span class="string">'petCount'</span><span class="punctuation">,</span> <span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function"><a href="/api/ui-react/functions/metrics-hooks/useprovidemetrics/">useProvideMetrics</a></span><span class="punctuation">(</span><span class="string">'petMetrics'</span><span class="punctuation">,</span> metrics<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="keyword">null</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
<span class="keyword">const</span> <span class="function-variable">ConsumeMetrics</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>span</span><span class="punctuation">></span></span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/metrics-hooks/usemetrics/">useMetrics</a></span><span class="punctuation">(</span><span class="string">'petMetrics'</span><span class="punctuation">)</span><span class="operator">?.</span><span class="function"><a href="/api/metrics/interfaces/metrics/metrics/methods/getter/getmetric/">getMetric</a></span><span class="punctuation">(</span><span class="string">'petCount'</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>span</span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> app <span class="operator">=</span> document<span class="punctuation">.</span><span class="function">createElement</span><span class="punctuation">(</span><span class="string">'div'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> root <span class="operator">=</span> <span class="function">createRoot</span><span class="punctuation">(</span>app<span class="punctuation">)</span><span class="punctuation">;</span>
root<span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">;</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>app<span class="punctuation">.</span>innerHTML<span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> '&lt;span>1&lt;/span>'</span>
</code></pre></section><section class="s2"><h2>Since</h2><p>v5.3.0</p></section></section>