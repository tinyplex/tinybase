<!DOCTYPE html><html lang="en"><head><link rel="dns-prefetch" href="https://www.googletagmanager.com/"><link href="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ" rel="preload" as="script"><link rel="preload" as="font" href="/fonts/inter.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/inconsolata.woff2" type="font/woff2" crossorigin="anonymous"><link rel="preload" as="font" href="/fonts/shantell.woff2" type="font/woff2" crossorigin="anonymous"><title>useProvideMetrics | TinyBase</title><meta name="description" content="The useProvideMetrics hook is used to add a Metrics object by Id to a Provider component, but imperatively from a component within it."><meta property="og:type" content="website"><meta property="og:title" content="useProvideMetrics | TinyBase"><meta property="og:description" content="The useProvideMetrics hook is used to add a Metrics object by Id to a Provider component, but imperatively from a component within it."><meta property="og:url" content="https://tinybase.org/api/ui-react/functions/metrics-hooks/useprovidemetrics/"><meta property="og:image" content="https://tinybase.org/favicon_pad.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="useProvideMetrics | TinyBase"><meta name="twitter:description" content="The useProvideMetrics hook is used to add a Metrics object by Id to a Provider component, but imperatively from a component within it."><meta name="twitter:site" content="@tinybasejs"><meta name="twitter:image" content="https://tinybase.org/favicon_pad.png"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="/css/index.css"><link rel="canonical" href="https://tinybase.org/api/ui-react/functions/metrics-hooks/useprovidemetrics/"><script src="/js/app.js"></script></head><body><header><a href="/"><img src="/favicon.svg" alt="TinyBase logo"><span>TinyBase</span></a><nav><ul><li><a href="/guides/">Guides</a></li><li><a href="/demos/">Demos</a></li><li><a href="/api/">API</a></li><li><a href="https://github.com/tinyplex/tinybase">GitHub</a></li></ul></nav><span id="dark"></span></header><main><nav><ul><li id="root" class="parent open"><span></span><a href="/">TinyBase</a><ul><li id="G" class="parent"><span></span><a href="/guides/">Guides</a></li><li id="D2" class="parent"><span></span><a href="/demos/">Demos</a></li><li id="api" class="parent open"><span></span><a href="/api/">API</a><ul><li id="s" class="parent"><span></span><a href="/api/store/"><code>store</code></a></li><li id="m" class="parent"><span></span><a href="/api/mergeable-store/"><code>mergeable-store</code></a></li><li id="m3" class="parent"><span></span><a href="/api/metrics/"><code>metrics</code></a></li><li id="i" class="parent"><span></span><a href="/api/indexes/"><code>indexes</code></a></li><li id="r" class="parent"><span></span><a href="/api/relationships/"><code>relationships</code></a></li><li id="q" class="parent"><span></span><a href="/api/queries/"><code>queries</code></a></li><li id="c" class="parent"><span></span><a href="/api/checkpoints/"><code>checkpoints</code></a></li><li id="c3" class="parent"><span></span><a href="/api/common/"><code>common</code></a></li><li id="p" class="parent"><span></span><a href="/api/persisters/"><code>persisters</code></a></li><li id="p2" class="parent"><span></span><a href="/api/persister-automerge/"><code>persister-automerge</code></a></li><li id="p3" class="parent"><span></span><a href="/api/persister-browser/"><code>persister-browser</code></a></li><li id="p4" class="parent"><span></span><a href="/api/persister-cr-sqlite-wasm/"><code>persister-cr-sqlite-wasm</code></a></li><li id="p5" class="parent"><span></span><a href="/api/persister-electric-sql/"><code>persister-electric-sql</code></a></li><li id="p6" class="parent"><span></span><a href="/api/persister-expo-sqlite/"><code>persister-expo-sqlite</code></a></li><li id="p7" class="parent"><span></span><a href="/api/persister-file/"><code>persister-file</code></a></li><li id="p8" class="parent"><span></span><a href="/api/persister-indexed-db/"><code>persister-indexed-db</code></a></li><li id="p9" class="parent"><span></span><a href="/api/persister-libsql/"><code>persister-libsql</code></a></li><li id="p10" class="parent"><span></span><a href="/api/persister-partykit-client/"><code>persister-partykit-client</code></a></li><li id="p11" class="parent"><span></span><a href="/api/persister-partykit-server/"><code>persister-partykit-server</code></a></li><li id="p12" class="parent"><span></span><a href="/api/persister-pglite/"><code>persister-pglite</code></a></li><li id="p13" class="parent"><span></span><a href="/api/persister-postgres/"><code>persister-postgres</code></a></li><li id="p14" class="parent"><span></span><a href="/api/persister-powersync/"><code>persister-powersync</code></a></li><li id="p15" class="parent"><span></span><a href="/api/persister-remote/"><code>persister-remote</code></a></li><li id="p16" class="parent"><span></span><a href="/api/persister-sqlite-wasm/"><code>persister-sqlite-wasm</code></a></li><li id="p17" class="parent"><span></span><a href="/api/persister-sqlite3/"><code>persister-sqlite3</code></a></li><li id="p18" class="parent"><span></span><a href="/api/persister-yjs/"><code>persister-yjs</code></a></li><li id="s38" class="parent"><span></span><a href="/api/synchronizers/"><code>synchronizers</code></a></li><li id="s41" class="parent"><span></span><a href="/api/synchronizer-broadcast-channel/"><code>synchronizer-broadcast-channel</code></a></li><li id="s44" class="parent"><span></span><a href="/api/synchronizer-local/"><code>synchronizer-local</code></a></li><li id="s47" class="parent"><span></span><a href="/api/synchronizer-ws-client/"><code>synchronizer-ws-client</code></a></li><li id="s50" class="parent"><span></span><a href="/api/synchronizer-ws-server/"><code>synchronizer-ws-server</code></a></li><li id="t3" class="parent"><span></span><a href="/api/tools/"><code>tools</code></a></li><li id="u" class="parent open"><span></span><a href="/api/ui-react/"><code>ui-react</code></a><ul><li id="u/F33" class="parent open"><span></span><a href="/api/ui-react/functions/">Functions</a><ul><li id="u/F33/C65" class="parent"><span></span><a href="/api/ui-react/functions/checkpoints-hooks/">Checkpoints hooks</a></li><li id="u/F33/I47" class="parent"><span></span><a href="/api/ui-react/functions/indexes-hooks/">Indexes hooks</a></li><li id="u/F33/M44" class="parent open"><span></span><a href="/api/ui-react/functions/metrics-hooks/">Metrics hooks</a><ul><li id="uCM"><span></span><a href="/api/ui-react/functions/metrics-hooks/usecreatemetrics/"><code>useCreateMetrics</code></a></li><li id="uM"><span></span><a href="/api/ui-react/functions/metrics-hooks/usemetric/"><code>useMetric</code></a></li><li id="uMI"><span></span><a href="/api/ui-react/functions/metrics-hooks/usemetricids/"><code>useMetricIds</code></a></li><li id="uML"><span></span><a href="/api/ui-react/functions/metrics-hooks/usemetriclistener/"><code>useMetricListener</code></a></li><li id="uM2"><span></span><a href="/api/ui-react/functions/metrics-hooks/usemetrics/"><code>useMetrics</code></a></li><li id="uMI2"><span></span><a href="/api/ui-react/functions/metrics-hooks/usemetricsids/"><code>useMetricsIds</code></a></li><li id="uMOMBI"><span></span><a href="/api/ui-react/functions/metrics-hooks/usemetricsormetricsbyid/"><code>useMetricsOrMetricsById</code></a></li><li id="uPM" class="current"><span></span><a href="/api/ui-react/functions/metrics-hooks/useprovidemetrics/"><code>useProvideMetrics</code></a></li></ul></li><li id="u/F33/P25" class="parent"><span></span><a href="/api/ui-react/functions/persister-hooks/">Persister hooks</a></li><li id="u/F33/Q3" class="parent"><span></span><a href="/api/ui-react/functions/queries-hooks/">Queries hooks</a></li><li id="u/F33/R9" class="parent"><span></span><a href="/api/ui-react/functions/relationships-hooks/">Relationships hooks</a></li><li id="u/F33/S57" class="parent"><span></span><a href="/api/ui-react/functions/store-hooks/">Store hooks</a></li><li id="u/F33/S58" class="parent"><span></span><a href="/api/ui-react/functions/synchronizer-hooks/">Synchronizer hooks</a></li><li id="u/F33/C66" class="parent"><span></span><a href="/api/ui-react/functions/checkpoints-components/">Checkpoints components</a></li><li id="u/F33/C67" class="parent"><span></span><a href="/api/ui-react/functions/context-components/">Context components</a></li><li id="u/F33/I48" class="parent"><span></span><a href="/api/ui-react/functions/indexes-components/">Indexes components</a></li><li id="u/F33/M45" class="parent"><span></span><a href="/api/ui-react/functions/metrics-components/">Metrics components</a></li><li id="u/F33/Q4" class="parent"><span></span><a href="/api/ui-react/functions/queries-components/">Queries components</a></li><li id="u/F33/R10" class="parent"><span></span><a href="/api/ui-react/functions/relationships-components/">Relationships components</a></li><li id="u/F33/S59" class="parent"><span></span><a href="/api/ui-react/functions/store-components/">Store components</a></li><li id="u/F33/O" class="parent"><span></span><a href="/api/ui-react/functions/other/">Other functions</a></li></ul></li><li id="u/TA23" class="parent"><span></span><a href="/api/ui-react/type-aliases/">Type Aliases</a></li></ul></li><li id="u2" class="parent"><span></span><a href="/api/ui-react-dom/"><code>ui-react-dom</code></a></li><li id="u3" class="parent"><span></span><a href="/api/ui-react-inspector/"><code>ui-react-inspector</code></a></li></ul></li></ul></li></ul></nav><article><nav><ul><li><a href="/">TinyBase</a></li><li><a href="/api/">API</a></li><li><a href="/api/ui-react/"><code>ui-react</code></a></li><li><a href="/api/ui-react/functions/">Functions</a></li><li><a href="/api/ui-react/functions/metrics-hooks/">Metrics hooks</a></li><li><a href="/api/ui-react/functions/metrics-hooks/useprovidemetrics/"><code>useProvideMetrics</code></a></li></ul></nav><section class="s1" id="/api/ui-react/functions/metrics-hooks/useprovidemetrics/" data-id="uPM"><h1><code>useProvideMetrics</code></h1><p>The <code>useProvideMetrics</code> hook is used to add a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object by <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> to a <a href="/api/ui-react/functions/context-components/provider/"><code>Provider</code></a> component, but imperatively from a component within it.</p><pre><code><span class="function"><a href="/api/ui-react/functions/metrics-hooks/useprovidemetrics/">useProvideMetrics</a></span><span class="punctuation">(</span>
  metricsId<span class="operator">:</span> <span class="builtin">string</span><span class="punctuation">,</span>
  metrics<span class="operator">:</span> <span class="type"><a href="/api/metrics/interfaces/metrics/metrics/">Metrics</a></span><span class="punctuation">,</span>
<span class="punctuation">)</span><span class="operator">:</span> <span class="keyword">void</span></code></pre><div class="table"><table><tr><th></th><th>Type</th><th>Description</th></tr><tr><th><code>metricsId</code></th><td><code><span class="builtin">string</span></code></td><td><p>The <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> of the <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object to be registered with the Provider.</p></td></tr><tr><th><code>metrics</code></th><td><code><span class="type"><a href="/api/metrics/interfaces/metrics/metrics/">Metrics</a></span></code></td><td><p>The <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object to be registered.</p></td></tr><tr><th class="right">returns</th><td><code><span class="keyword">void</span></code></td><td><p>This has no return value.</p></td></tr></table></div><p>Normally you will register a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object by <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> in a context by using the <code>metricsById</code> prop of the top-level <a href="/api/ui-react/functions/context-components/provider/"><code>Provider</code></a> component. This hook, however, lets you dynamically add a new <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object to the context, from within a descendent component. This is useful for applications where the set of <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> objects is not known at the time of the first render of the root Provider.</p><p>A <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object added to the Provider context in this way will be available to other components within the context (using the <a href="/api/ui-react/functions/metrics-hooks/usemetrics/"><code>useMetrics</code></a> hook and so on). If you use the same <a href="/api/common/type-aliases/identity/id/"><code>Id</code></a> as an existing <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object registration, the new one will take priority over one provided by the <code>metricsById</code> prop.</p><p>Note that other components that consume a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object registered like this should defend against it being undefined at first. On the first render, the other component will likely not yet have completed the registration. In the example below, we use the null-safe <code>useMetrics(&#x27;petMetrics&#x27;)?</code> to do this.</p><section class="s2"><h2>Example</h2><p>This example creates a Provider context. A child component registers a <a href="/api/metrics/interfaces/metrics/metrics/"><code>Metrics</code></a> object into it which is then consumable by a peer child component.</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>
  Provider<span class="punctuation">,</span>
  useCreateMetrics<span class="punctuation">,</span>
  useCreateStore<span class="punctuation">,</span>
  useMetrics<span class="punctuation">,</span>
  useProvideMetrics<span class="punctuation">,</span>
<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase/ui-react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createMetrics<span class="punctuation">,</span> createStore<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinybase'</span><span class="punctuation">;</span>
<span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span>createRoot<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'react-dom/client'</span><span class="punctuation">;</span>

<span class="keyword">const</span> <span class="function-variable">App</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span><span class="punctuation">></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">RegisterMetrics</span></span> <span class="punctuation">/></span></span><span class="plain-text">
    </span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">ConsumeMetrics</span></span> <span class="punctuation">/></span></span><span class="plain-text">
  </span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span><span class="class-name"><a href="/api/ui-react/functions/context-components/provider/">Provider</a></span></span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> <span class="function-variable">RegisterMetrics</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">{</span>
  <span class="keyword">const</span> store <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/store-hooks/usecreatestore/">useCreateStore</a></span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span>
    <span class="function"><a href="/api/store/functions/creation/createstore/">createStore</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/store/interfaces/store/store/methods/setter/setcell/">setCell</a></span><span class="punctuation">(</span><span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'fido'</span><span class="punctuation">,</span> <span class="string">'color'</span><span class="punctuation">,</span> <span class="string">'brown'</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">const</span> metrics <span class="operator">=</span> <span class="function"><a href="/api/ui-react/functions/metrics-hooks/usecreatemetrics/">useCreateMetrics</a></span><span class="punctuation">(</span>store<span class="punctuation">,</span> <span class="punctuation">(</span><span class="parameter">store</span><span class="punctuation">)</span> <span class="operator">=></span>
    <span class="function"><a href="/api/metrics/functions/creation/createmetrics/">createMetrics</a></span><span class="punctuation">(</span>store<span class="punctuation">)</span><span class="punctuation">.</span><span class="function"><a href="/api/metrics/interfaces/metrics/metrics/methods/configuration/setmetricdefinition/">setMetricDefinition</a></span><span class="punctuation">(</span><span class="string">'petCount'</span><span class="punctuation">,</span> <span class="string">'pets'</span><span class="punctuation">,</span> <span class="string">'count'</span><span class="punctuation">)</span><span class="punctuation">,</span>
  <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="function"><a href="/api/ui-react/functions/metrics-hooks/useprovidemetrics/">useProvideMetrics</a></span><span class="punctuation">(</span><span class="string">'petMetrics'</span><span class="punctuation">,</span> metrics<span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="keyword">return</span> <span class="keyword">null</span><span class="punctuation">;</span>
<span class="punctuation">}</span><span class="punctuation">;</span>
<span class="keyword">const</span> <span class="function-variable">ConsumeMetrics</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="punctuation">(</span>
  <span class="tag"><span class="tag"><span class="punctuation">&lt;</span>span</span><span class="punctuation">></span></span><span class="punctuation">{</span><span class="function"><a href="/api/ui-react/functions/metrics-hooks/usemetrics/">useMetrics</a></span><span class="punctuation">(</span><span class="string">'petMetrics'</span><span class="punctuation">)</span><span class="operator">?.</span><span class="function"><a href="/api/metrics/interfaces/metrics/metrics/methods/getter/getmetric/">getMetric</a></span><span class="punctuation">(</span><span class="string">'petCount'</span><span class="punctuation">)</span><span class="punctuation">}</span><span class="tag"><span class="tag"><span class="punctuation">&lt;/</span>span</span><span class="punctuation">></span></span>
<span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">const</span> app <span class="operator">=</span> document<span class="punctuation">.</span><span class="function">createElement</span><span class="punctuation">(</span><span class="string">'div'</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="keyword">const</span> root <span class="operator">=</span> <span class="function">createRoot</span><span class="punctuation">(</span>app<span class="punctuation">)</span><span class="punctuation">;</span>
root<span class="punctuation">.</span><span class="function">render</span><span class="punctuation">(</span><span class="tag"><span class="tag"><span class="punctuation">&lt;</span><span class="class-name">App</span></span> <span class="punctuation">/></span></span><span class="punctuation">)</span><span class="punctuation">;</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>app<span class="punctuation">.</span>innerHTML<span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> '&lt;span>1&lt;/span>'</span>
</code></pre></section><section class="s2"><h2>Since</h2><p>v5.3.0</p></section></section></article><aside></aside></main><footer><nav><a id="tw" href="https://x.com/tinybasejs" target="_blank">X / Twitter</a><a id="dc" href="https://discord.com/invite/mGz3mevwP8" target="_blank">Discord</a></nav><nav><a href="/">TinyBase <span id="version"></span></a> © 2021- All Rights Reserved</nav></footer></body><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D1MGR8VRWJ"></script><script>window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments);}g('js',new Date());g('config','G-D1MGR8VRWJ');</script></html>